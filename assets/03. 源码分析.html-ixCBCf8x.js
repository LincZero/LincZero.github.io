import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{r as o,o as p,c as r,b as e,d as s,e as n,a}from"./app-BLOlimVU.js";const c={},u=a(`<h1 id="vuepress-hope主题-源码分析" tabindex="-1"><a class="header-anchor" href="#vuepress-hope主题-源码分析"><span>Vuepress Hope主题 源码分析</span></a></h1><h2 id="贡献指南" tabindex="-1"><a class="header-anchor" href="#贡献指南"><span>贡献指南</span></a></h2><p>https://theme-hope.vuejs.press/zh/contribution.html，这个位置有点迷，研究走了点弯路后，我才看到有这么一页，居然要点 &quot;常见问题&quot; 才能在这个完整版的侧边栏底部看到</p><h3 id="项目文件结构" tabindex="-1"><a class="header-anchor" href="#项目文件结构"><span>项目文件结构</span></a></h3><p>本项目是一个 monorepo，使用 pnpm 管理。</p><ul><li>docs: 放置各插件与主题的文档，每个子文件夹为一个项目</li><li>demo: 主题演示项目</li><li>packages: 放置各<strong>插件与主题</strong>的代码，每个子文件夹为一个项目</li></ul><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">.</span>
├── <span class="token punctuation">.</span>github → GitHub 配置
├── <span class="token punctuation">.</span>husky → husky 配置
│
├── demo → 演示项目
│
├── docs → 文档目录
│ ├── auto<span class="token operator">-</span>catalog → auto<span class="token operator">-</span>catalog 插件文档
│ ├── blog → blog2 插件文档
│ ├── comment → comment2 插件文档
│ ├── components → components 插件文档
│ ├── copy<span class="token operator">-</span>code → copy<span class="token operator">-</span>code2 插件文档
│ ├── feed → feed2 插件文档
│ ├── lightgallery → lightgallery 插件文档
│ ├── md<span class="token operator">-</span>enhance → md<span class="token operator">-</span>enhance 插件文档
│ ├── photo<span class="token operator">-</span>swipe → photo<span class="token operator">-</span>swipe 文档
│ ├── pwa → pwa2 插件文档
│ ├── reading<span class="token operator">-</span>time → reading<span class="token operator">-</span>time2 插件文档
│ ├── remove<span class="token operator">-</span>pwa → remove<span class="token operator">-</span>pwa 插件文档
│ ├── rtl → rtl 插件文档
│ ├── sass<span class="token operator">-</span>palette → sass<span class="token operator">-</span>palette 插件文档
│ ├── shared → vuepress<span class="token operator">-</span>shared 文档
│ ├── search<span class="token operator">-</span>pro → search<span class="token operator">-</span>pro 插件文档
│ ├── seo → seo2 插件文档
│ └── theme → 主题文档
│
├── docs<span class="token operator">-</span>shared → 文档的通用文件
<span class="token operator">|</span>
├── packages → 项目源代码
│ ├── auto<span class="token operator">-</span>catalog → auto<span class="token operator">-</span>catalog 插件
│ ├── blog2 → blog2 插件
│ ├── comment2 → comment2 插件
│ ├── components → components 插件
│ ├── copy<span class="token operator">-</span>code2 → copy<span class="token operator">-</span>code2 插件
│ ├── create → create<span class="token operator">-</span>vuepress<span class="token operator">-</span>theme<span class="token operator">-</span>hope 助手
│ ├── feed2 → feed2 插件
│ ├── lightgallery → lightgallery 插件
│ ├── md<span class="token operator">-</span>enhance → md<span class="token operator">-</span>enhance 插件
│ ├── photo<span class="token operator">-</span>swipe → photo<span class="token operator">-</span>swipe 插件
│ ├── pwa2 → pwa2 插件
│ ├── reading<span class="token operator">-</span>time2 → reading<span class="token operator">-</span>time2 插件
│ ├── remove<span class="token operator">-</span>pwa → remove<span class="token operator">-</span>pwa 插件
│ ├── rtl → rtl 插件
│ ├── sass<span class="token operator">-</span>palette → sass<span class="token operator">-</span>palette 插件
│ ├── search<span class="token operator">-</span>pro → search<span class="token operator">-</span>pro 插件
│ ├── seo2 → seo2 插件
│ ├── shared → 共享文件
│ ├── sitemap2 → sitemap2 插件
│ └── theme → vuepress<span class="token operator">-</span>theme<span class="token operator">-</span>hope 主题
│
├── scripts → 命令脚本
│
├── <span class="token operator">...</span> → 一些配置文件
│
├── <span class="token constant">LICENSE</span> → 协议
├── <span class="token keyword">package</span><span class="token punctuation">.</span>json → 项目根 <span class="token keyword">package</span><span class="token punctuation">.</span>json
├── <span class="token constant">README</span><span class="token punctuation">.</span>md → 项目介绍
├── <span class="token constant">SECURITY</span><span class="token punctuation">.</span>md → 安全政策文件
│
└── tsconfig<span class="token punctuation">.</span><span class="token operator">*</span> → TypeScript 配置文件
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="文档修改" tabindex="-1"><a class="header-anchor" href="#文档修改"><span>文档修改</span></a></h3><p>你可以直接在 docs 文件夹内找到对应项目，并修改对应的 Markdown。</p><p>确保 <code>pnpm lint</code> 与 <code>pnpm lint:md</code> 命令没有错误后，即可提交到 GitHub 发起 PR。</p><blockquote><p>预览文档</p><p>由于文档使用的是本地主题和插件，因此你需要先通过 <code>pnpm build</code> 构建本地项目。</p><p>之后在 <code>docs</code> 目录下的正确文档项目文件夹打开终端，运行 <code>pnpm docs:vite-dev</code> (使用 vite) 或 <code>pnpm docs:webpack-dev</code> (使用 webpack)。</p></blockquote><h3 id="项目修改" tabindex="-1"><a class="header-anchor" href="#项目修改"><span>项目修改</span></a></h3><p>每个项目的结构都大致如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">.</span>
├── lib → 编译后的输出文件
│    ├── client → 客户端侧代码
│    └── node → Node<span class="token punctuation">.</span>js 侧代码
└── src → 源文件
     ├── client → 客户端侧代码
     ├── node → Node<span class="token punctuation">.</span>js 侧代码
     └── shared → 客户端和 Node<span class="token punctuation">.</span>js 的共享文件
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>VuePress 同时运行在客户端和 Node 端。 Node 侧有像 <code>fs</code> 这样的 node 模块，而客户端运行在有<code>document\`\`windows\`\`navigator</code>等全局变量的浏览器中，你应该清楚一段代码运行在哪里。</p><ul><li><code>client</code> 目录存储在浏览器中运行的代码</li><li><code>node</code> 目录存储在 Node.js 中运行的代码</li><li><code>shared</code> 目录存储在客户端和 Node 中使用的文件，因此代码不应引用任何浏览器全局变量或 node 模块。</li></ul><p>为了更好的性能，所有插件在发布时都会使用 rollup 进行打包并压缩。</p><h3 id="提交" tabindex="-1"><a class="header-anchor" href="#提交"><span>提交</span></a></h3><p>项目使用 <code>husky</code> 添加了额外的 Git Hooks 进行验证：</p><ul><li><p>在 <code>precommit</code> 阶段我们使用 <code>lint-staged</code> 配合对应 Linter 对改动的代码进行检验</p><p>这意味着你需要保证你的代码按照项目要求进行格式化，可以通过 Linter。</p></li><li><p>在 <code>commit-msg</code> 阶段我们使用 <code>commitlint</code> 对提交备注进行校验。</p><p>这意味着你需要保证你的提交注释符合语义化提交 (Semantic)</p></li></ul><blockquote><p>提示</p><p>如果你不能通过上述 Git Hooks，你将无法完成 <code>git commit</code>。</p><p>如果你已经进行贡献了一些内容，但无法完成提交且不会修复，你可以在提交时添加 <code>--no-verify</code> Flag 绕过 Git Hooks。</p></blockquote><blockquote><p>husky 个人补充</p><p>对应的是项目中的 <code>/.husky</code> 文件夹，尚不知道是 github 专用还是通用的，不知道是前端专用的还是通用的</p></blockquote><h2 id="main-repo-父项目" tabindex="-1"><a class="header-anchor" href="#main-repo-父项目"><span>main-repo 父项目</span></a></h2><p>简化：看起来多，但如果将 &quot;可选&quot; 插件的末枝去掉，主干是theme文件夹</p><h3 id="目录结构" tabindex="-1"><a class="header-anchor" href="#目录结构"><span>目录结构</span></a></h3><h4 id="项目根目录" tabindex="-1"><a class="header-anchor" href="#项目根目录"><span>项目根目录</span></a></h4><p>https://github.com/vuepress-theme-hope/vuepress-theme-hope</p><ul><li><p>/， <strong>main-repo</strong></p><ul><li><p>(主要目录)</p><ul><li><p>/demo/， 插件使用示例，演示项目</p><ul><li>一些插件/</li></ul></li><li><p>/docs/， 插件使用文档</p><ul><li>一些插件/</li></ul></li><li><p>/packages/， 插件源码</p><ul><li>一些插件/</li></ul></li></ul></li><li><p>（其他非主要目录）</p><ul><li><p>/.github/</p></li><li><p>/.husky/</p></li><li><p>/.vscode/</p><ul><li>extensions.json</li><li>launch.json</li><li>setting.json</li></ul></li><li><p>/docs-shared/， 文档的通用文件（但内容是代码啊）</p></li><li><p>/scripts/， 命令脚本</p></li><li><p><s>/node_modules/</s></p></li><li><p>/LICENSE, 协议</p></li><li><p>/package.json, 项目根 package.json</p></li><li><p>README.md, 项目介绍</p></li><li><p>/SECURITY.md, 安全政策文件</p></li><li><p>/tsconfig.*, TypeScript 配置文件</p></li><li><p>/...</p></li></ul></li></ul></li></ul><h4 id="插件目录-都是一些monorepo组织的子项目" tabindex="-1"><a class="header-anchor" href="#插件目录-都是一些monorepo组织的子项目"><span>插件目录（都是一些monorepo组织的子项目）</span></a></h4><p>一些插件，对应的介绍页：https://vuepress-theme-hope.github.io/v2/zh/config/plugins/intro.html#%E6%8F%92%E4%BB%B6%E9%80%89%E9%A1%B9</p><p>注意：/demo或docs或packages/xxx/，这一层都是 <strong>sub-repo</strong></p>`,31),d=e("p",null,"/demo或docs或packages/",-1),m=a("<li><p>(Mr.Hope 提供的插件部分)</p><ul><li><p>auto-catalog/， 自动目录页</p></li><li><p>blog2/， 博客插件</p></li><li><p>comment2/， 评论与浏览量</p></li><li><p>components/， 一些开箱即用的插件</p></li><li><p>copy-code2/， 一键复制代码块</p></li><li><p>copyright2/， 在用户复制时追加版权信息，或禁用站点的复制与选择</p></li><li><p>feed2/， Feed 支持 插件</p></li><li><p>md-enhance/， 更多 Markdown 语法</p></li><li><p>photo-swipe/， 基于 Photo Swipe 的图片浏览插件</p></li><li><p>pwa2/， 增强 PWA 支持</p></li><li><p>reading-time2/， 阅读时间与字数统计</p></li><li><p>remove-pwa/， 面向全部插件和主题的 Sass 配置插件</p></li><li><p>seo2/， SEO 增强插件</p></li><li><p>sitemap2/， Sitemap 插件？(docs不包含)</p></li></ul></li>",1),v=e("p",null,"(一些没被主题捆绑的插件)",-1),h=e("li",null,[e("p",null,"create/， (docs不包含)")],-1),b=e("li",null,[e("p",null,"lightgallery/， 基于 lightgallery 图片浏览插件")],-1),k=e("li",null,[e("p",null,"redirect/， 重定向插件")],-1),g={href:"https://vuepress-theme-hope.github.io/v2/remove-pwa/zh/",target:"_blank",rel:"noopener noreferrer"},_=e("li",null,[e("p",null,"search-pro/， 客户端搜索插件")],-1),q=e("li",null,[e("p",null,"(其他没介绍的)"),e("ul",null,[e("li",null,[e("p",null,"rtl/, 未知插件")]),e("li",null,[e("p",null,"sass-palette/")]),e("li",null,[e("p",null,"shared/, docs是vuepress-shared 文档，packages是共享文件")]),e("li",null,[e("p",null,"theme/， 一些主题配置")])])],-1),f=e("p",null,"有一些插件不在在个路径，例如官方插件：",-1),y={href:"https://vuejs.press/zh/reference/plugin/active-header-links.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://vuejs.press/zh/reference/plugin/container.html",target:"_blank",rel:"noopener noreferrer"},j={href:"https://vuejs.press/zh/reference/plugin/external-link-icon.html",target:"_blank",rel:"noopener noreferrer"},x={href:"https://vuejs.press/zh/reference/plugin/git.html",target:"_blank",rel:"noopener noreferrer"},A={href:"https://vuejs.press/zh/reference/plugin/nprogress.html",target:"_blank",rel:"noopener noreferrer"},S={href:"https://vuejs.press/zh/reference/plugin/prismjs.html",target:"_blank",rel:"noopener noreferrer"},w={href:"https://vuejs.press/zh/reference/plugin/theme-data.html",target:"_blank",rel:"noopener noreferrer"},B=a(`<h3 id="根-package-json-脚本" tabindex="-1"><a class="header-anchor" href="#根-package-json-脚本"><span>根 package.json 脚本</span></a></h3><ol><li>构建项目: <code>pnpm build</code><ul><li>使用 rollup 打包并压缩代码，并输出到 <code>lib</code> 文件夹</li><li>使用 <code>rollup-plugin-copy</code> 复制其他文件到 <code>lib</code> 文件夹</li></ul></li><li>开发项目: <code>pnpm dev</code><ul><li>使用 <code>tsc</code> 编译 TypeScript 文件到 <code>lib</code> 文件夹</li><li>Use <code>cpx</code> 复制其他文件到 <code>lib</code> 文件夹</li></ul></li></ol><div class="language-json line-numbers-mode" data-ext="json" data-title="json"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token comment">// 注意：请不要混用构建和开发命令，因为它们的构建方式完全不同</span>
    <span class="token comment">// 否则你可能需要执行 \`pnpm clean\` 命令来清除上一次的命令结果</span>
    
    <span class="token comment">// 其他自带通用命令：i、un、publish</span>
    
    <span class="token comment">// 构建 (packages子项目会各自生成lib文件夹)</span>
    <span class="token property">&quot;build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_ENV=production pnpm run --stream -r build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;build:no-bundle&quot;</span><span class="token operator">:</span> <span class="token string">&quot;concurrently \\&quot;tsc -b tsconfig.build.json\\&quot; \\&quot;pnpm run copy\\&quot;&quot;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 开发</span>
    <span class="token property">&quot;dev&quot;</span><span class="token operator">:</span> <span class="token string">&quot;concurrently \\&quot;tsc -b tsconfig.build.json --watch\\&quot; \\&quot;pnpm run dev:copy\\&quot;&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;dev:copy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run --parallel -r dev:copy&quot;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 通用</span>
    <span class="token property">&quot;clean&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run --stream -r clean&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;commit&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm git-cz&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;copy&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run --parallel -r copy&quot;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 文档类 (docs子项目会各自生成dist文件夹)</span>
    <span class="token property">&quot;docs:vite-build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -r docs:vite-build&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;docs:webpack-build&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm run -r docs:vite-build&quot;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// lint类，格式化项目</span>
    <span class="token property">&quot;lint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm lint:prettier --write &amp;&amp; pnpm lint:eslint --fix &amp;&amp; pnpm lint:stylelint --fix&quot;</span><span class="token punctuation">,</span> <span class="token comment">// prettier、eslint 和 stylelint 格式化</span>
    <span class="token property">&quot;lint:check&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm lint:prettier &amp;&amp; pnpm lint:eslint &amp;&amp; pnpm lint:stylelint&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:eslint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;eslint . --ext .js,.ts,.vue&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:md&quot;</span><span class="token operator">:</span> <span class="token string">&quot;markdownlint **/*.md&quot;</span><span class="token punctuation">,</span> <span class="token comment">// 如果你修改了 Markdown，则需要运行</span>
    <span class="token property">&quot;lint:prettier&quot;</span><span class="token operator">:</span> <span class="token string">&quot;prettier --check .&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;lint:stylelint&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stylelint packages/*/src/**/*.{css,scss}&quot;</span><span class="token punctuation">,</span>
    
    <span class="token comment">// 其他类</span>
    <span class="token property">&quot;packages:bootstrap&quot;</span><span class="token operator">:</span> <span class="token string">&quot;tsx scripts/bootstrap.ts&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;packages:check-update&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm dlx npm-check-updates -u --deep --timeout 600000&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;packages:update&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm up -r&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;prepare&quot;</span><span class="token operator">:</span> <span class="token string">&quot;husky install&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;release&quot;</span><span class="token operator">:</span> <span class="token string">&quot;pnpm clean &amp;&amp; pnpm build &amp;&amp; pnpm release:bump &amp;&amp; pnpm release:publish &amp;&amp; pnpm release:sync&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;release:bump&quot;</span><span class="token operator">:</span> <span class="token string">&quot;bumpp -r --execute=\\&quot;pnpm commit-and-tag-version &amp;&amp; git add CHANGELOG.md\\&quot; --commit \\&quot;chore(release): publish v%s\\&quot; --all --tag --push&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;release:publish&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_OPTIONS=\\&quot;--experimental-json-modules\\&quot; tsx scripts/release.ts&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;release:sync&quot;</span><span class="token operator">:</span> <span class="token string">&quot;cross-env NODE_OPTIONS=\\&quot;--experimental-json-modules\\&quot; tsx scripts/sync.ts&quot;</span><span class="token punctuation">,</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;vitest --coverage&quot;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sub-repo-通用子项目" tabindex="-1"><a class="header-anchor" href="#sub-repo-通用子项目"><span>sub-repo 通用子项目</span></a></h2><p>每个项目的结构都大致如下：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">.</span>
├── lib → 编译后的输出文件
│    ├── client → 客户端侧代码
│    └── node → Node<span class="token punctuation">.</span>js 侧代码
└── src → 源文件
     ├── client → 客户端侧代码
     ├── node → Node<span class="token punctuation">.</span>js 侧代码
     └── shared → 客户端和 Node<span class="token punctuation">.</span>js 的共享文件
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>VuePress 同时运行在客户端和 Node 端。 Node 侧有像 <code>fs</code> 这样的 node 模块，而客户端运行在有<code>document\`\`windows\`\`navigator</code>等全局变量的浏览器中，你应该清楚一段代码运行在哪里。</p><ul><li><code>client</code> 目录存储在浏览器中运行的代码</li><li><code>node</code> 目录存储在 Node.js 中运行的代码</li><li><code>shared</code> 目录存储在客户端和 Node 中使用的文件，因此代码不应引用任何浏览器全局变量或 node 模块。</li></ul><p>为了更好的性能，所有插件在发布时都会使用 rollup 进行打包并压缩。</p><h2 id="sub-repo-主题子项目-theme" tabindex="-1"><a class="header-anchor" href="#sub-repo-主题子项目-theme"><span>sub-repo 主题子项目 (theme)</span></a></h2><h3 id="主题专题" tabindex="-1"><a class="header-anchor" href="#主题专题"><span>主题专题</span></a></h3><p>侧边栏专题：</p>`,12),N=e("p",null,"client/： 客户端侧代码",-1),I=e("li",null,"components/",-1),P=e("li",null,"composables/",-1),L=e("li",null,"layouts/",-1),C=e("li",null,"styles/",-1),M=e("li",null,"utils/",-1),V=e("li",null,"blog/： 博客",-1),D=e("li",null,"encrypt/",-1),H=e("li",null,"info/",-1),z=e("li",null,"navbar/： 导航栏",-1),F=e("li",null,"outlook/",-1),G={href:"https://github.com/vuepress-theme-hope/vuepress-theme-hope/tree/main/packages/theme/src/client/modules/sidebar/",target:"_blank",rel:"noopener noreferrer"},T=e("li",null,"export.ts",-1),O=e("li",null,"index.ts",-1),R=e("li",null,[e("p",null,"node/： Node.js 侧代码")],-1),Z=e("li",null,[e("p",null,"presets/： 预设数据和设置")],-1),Y=e("li",null,[e("p",null,"shared/： 客户端和Node.js的共享文件")],-1),J=e("li",null,[e("p",null,"… .ts")],-1),Q=e("li",null,[s("lib/： 项目编译后的文件目录？ "),e("ul",null,[e("li",null,"client| node| presets| shared")])],-1),W=e("li",null,[e("code",null,"__test__/"),s("： 测试代码")],-1),U=e("li",null,"templates/： 一些通用的svg、css、scss",-1),X=e("li",null,"node_modules/",-1),K=e("li",null,"package.json",-1),$=e("li",null,"README.md",-1),ee=e("li",null,"...",-1),se=a('<h3 id="文件结构专题" tabindex="-1"><a class="header-anchor" href="#文件结构专题"><span>文件结构专题</span></a></h3><h3 id="侧边栏专题-旧" tabindex="-1"><a class="header-anchor" href="#侧边栏专题-旧"><span>侧边栏专题 (旧)</span></a></h3><ul><li><p>/packages/theme/src/client/utils/，一些通用的东西</p><ul><li>resolveLinkInfo.ts： 解析链接信息，有能生成目录结构的函数 <ul><li>被调用：PageNav.ts、autoLink.ts、navbarConfig.ts、resolveConfig.ts</li></ul></li></ul></li><li><p><a href="(https://github.com/vuepress-theme-hope/vuepress-theme-hope/tree/main/packages/theme/src/client/modules/sidebar/)">/packages/theme/src/client/modules/sidebar/</a>： 侧边栏</p><ul><li><p>components/： 侧边栏组件的源代码</p><ul><li>Sidebar.ts： 侧边栏主体</li><li>SidebarChild.ts： 文件</li><li>SidebarGroup.ts： 文件夹</li><li>SidebarLinks.ts： 链接</li></ul></li><li><p>composables/： 包含一些可复用的Vue 3 Composition API 函数</p><ul><li>index.ts</li><li>render.ts</li><li>resolveConfig.ts： 配置解析器，调用了 resolveLinkInfo</li><li>setup.ts</li><li>utils.ts</li></ul></li><li><p>styles/</p></li><li><p>utils/</p></li></ul></li></ul><p>依赖</p>',4),ne=a('<h3 id="侧边栏专题" tabindex="-1"><a class="header-anchor" href="#侧边栏专题"><span>侧边栏专题</span></a></h3><ul><li><p><s>文件结构数据的传递链：</s></p><ul><li>client/utils::resolveLinkInfo (导航栏侧边栏通用结构, 但会被再次大改) -&gt; ???getSidebarData -&gt; setup.ts -&gt; @vueuse/core::computedWithControl &amp; resolveConfig::resolveSidebarItems (加工为侧边栏专用结构) -&gt; setupSidebarItems (每次访问网站只计算一次并存起来) -&gt; setup.ts::useSidebarItems (而保存的值会取多遍) -&gt; index.ts -&gt; Sidebar::sidebarItems -&gt; SidebarLinks::props.config -&gt; SiderbarGroup与SidebarChild</li></ul></li><li><p><s>文件调用链：</s></p><ul><li>index.ts -&gt; setup.ts -&gt; …… -&gt; Sidebar -&gt; SidebarLinks -&gt; SiderbarGroup</li><li>Sidebar -&gt; sidebar::index -&gt; sidebar::setup -&gt; sidebar::resolveConfig -&gt; utils::resolveLinkInfo</li></ul></li><li><p>函数调用栈方式表达（写法说明：函数调用自外向内，数据传递自内向外）</p><ul><li>首次访问 <ul><li>sidebar/setup::setupSidebarItems，存于 sidebarItems <ul><li>sidebar/resolveConfig::resolveSidebarItems <ul><li><strong>(KEY) @temp/theme-hope/sidebar::sidebarData</strong> (由node端，node/prepare/sidebar/sidebar.ts 计算并存于 @temp/theme-hope/sidebar.js 中)</li><li>(若文件类型) utils/linkInfo::resolveLinkInfo x md文件个数 <ul><li>utils/linkInfo::utils/resolvePrefix x md文件个数</li></ul></li></ul></li><li>utils/linkInfo::resolveLinkInfo x N</li></ul></li></ul></li><li>取 <ul><li>sidebar/setup::useSidebarItems</li></ul></li></ul></li></ul><p>侧边栏的可替换组建</p><ul><li>组件: <ul><li><code>@theme-hope/modules/sidebar/components/Sidebar</code> 侧边栏</li><li><code>@theme-hope/modules/sidebar/components/SidebarChild</code> 侧边栏链接子项</li><li><code>@theme-hope/modules/sidebar/components/SidebarGroup</code> 侧边栏分组链接</li><li><code>@theme-hope/modules/sidebar/components/SidebarLinks</code> 侧边栏链接</li></ul></li><li>杂项: <ul><li><code>@theme-hope/modules/sidebar/composables/index</code> 侧边栏可组合 API</li><li><code>@theme-hope/modules/sidebar/utils/index</code> 侧边栏通用函数</li></ul></li></ul>',4);function le(ae,oe){const l=o("ExternalLinkIcon"),t=o("Mermaid");return p(),r("div",null,[u,e("ul",null,[e("li",null,[d,e("ul",null,[m,e("li",null,[v,e("ul",null,[h,b,k,e("li",null,[e("p",null,[e("a",g,[s("vuepress-plugin-remove-pwa"),n(l)]),s(": 移除 PWA 插件")])]),_])]),q])])]),f,e("ul",null,[e("li",null,[e("a",y,[s("@vuepress/plugin-active-header-links"),n(l)]),s(": 自动更新路由 Hash")]),e("li",null,[e("a",E,[s("@vuepress/plugin-container"),n(l)]),s(": 自定义容器")]),e("li",null,[e("a",j,[s("@vuepress/external-link-icon"),n(l)]),s(": 为 Markdown 的外部链接添加外部链接图标。")]),e("li",null,[e("a",x,[s("@vuepress/plugin-git"),n(l)]),s(": 基于 Git 的信息插件")]),e("li",null,[e("a",A,[s("@vuepress/plugin-nprogress"),n(l)]),s(": 进度条")]),e("li",null,[e("a",S,[s("@vuepress/plugin-prismjs"),n(l)]),s(": 基于 prism.js 的代码高亮插件")]),e("li",null,[e("a",w,[s("@vuepress/plugin-theme-data"),n(l)]),s(": 主题配置的 Composition API 插件")])]),B,e("ul",null,[e("li",null,[s("/packages/theme/： 主题 sub-repo，主题子项目 "),e("ul",null,[e("li",null,[s("src/ "),e("ul",null,[e("li",null,[N,e("ul",null,[I,P,L,C,M,e("li",null,[s("modules/ "),e("ul",null,[V,D,H,z,F,e("li",null,[e("a",G,[s("sidebar/"),n(l)]),s("： 侧边栏")])])]),T,O])]),R,Z,Y,J])]),Q,W,U,X,K,$,ee])])]),se,n(t,{id:"mermaid-813",code:"eJx9UEEOgjAQPNNX9AP4BA9yMCbe9EYIASnQWFvSgvHoIzz5An9m/IVlW3RFQg/tdnZ2d3YqnTU13a+I6XIXH9SpUZLJ1pBgxwuWZ5qG4ZL6eMvl0RBqDwYwI6q5KGYZa626BjMAoOFiPIbJYiTMZLlgVhmXBbuQQDOjxJlFSpa88ihMMqztO9pohmJDjZGu5WI0FKA0hichgftCRQx3MkVP49f1/rw9hiovod9pI0sFJQS7BdPdSthyh/wsgFf69PvzGckckt7i6eRXBE6+AXxKuyE="}),ne])}const pe=i(c,[["render",le],["__file","03. 源码分析.html.vue"]]),re=JSON.parse('{"path":"/MdNote_Public/01.%20%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/VuePress2%20(Vue3)/03.%20%E4%B8%BB%E9%A2%98%E6%89%A9%E5%B1%95/Hope%E4%B8%BB%E9%A2%98/09.%20%E6%BA%90%E7%A0%81/03.%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html","title":"Vuepress Hope主题 源码分析","lang":"zh-CN","frontmatter":{"description":"Vuepress Hope主题 源码分析 贡献指南 https://theme-hope.vuejs.press/zh/contribution.html，这个位置有点迷，研究走了点弯路后，我才看到有这么一页，居然要点 \\"常见问题\\" 才能在这个完整版的侧边栏底部看到 项目文件结构 本项目是一个 monorepo，使用 pnpm 管理。 docs: 放置...","head":[["meta",{"property":"og:url","content":"http://192.168.0.101:8080/MdNote_Public/01.%20%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/VuePress2%20(Vue3)/03.%20%E4%B8%BB%E9%A2%98%E6%89%A9%E5%B1%95/Hope%E4%B8%BB%E9%A2%98/09.%20%E6%BA%90%E7%A0%81/03.%20%E6%BA%90%E7%A0%81%E5%88%86%E6%9E%90.html"}],["meta",{"property":"og:site_name","content":"Linc 的小站"}],["meta",{"property":"og:title","content":"Vuepress Hope主题 源码分析"}],["meta",{"property":"og:description","content":"Vuepress Hope主题 源码分析 贡献指南 https://theme-hope.vuejs.press/zh/contribution.html，这个位置有点迷，研究走了点弯路后，我才看到有这么一页，居然要点 \\"常见问题\\" 才能在这个完整版的侧边栏底部看到 项目文件结构 本项目是一个 monorepo，使用 pnpm 管理。 docs: 放置..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"LincZero"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Vuepress Hope主题 源码分析\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincZero\\",\\"url\\":\\"https://github.com/LincZero/\\"}]}"]]},"headers":[{"level":1,"title":"Vuepress Hope主题 源码分析","slug":"vuepress-hope主题-源码分析","link":"#vuepress-hope主题-源码分析","children":[{"level":2,"title":"贡献指南","slug":"贡献指南","link":"#贡献指南","children":[{"level":3,"title":"项目文件结构","slug":"项目文件结构","link":"#项目文件结构","children":[]},{"level":3,"title":"文档修改","slug":"文档修改","link":"#文档修改","children":[]},{"level":3,"title":"项目修改","slug":"项目修改","link":"#项目修改","children":[]},{"level":3,"title":"提交","slug":"提交","link":"#提交","children":[]}]},{"level":2,"title":"main-repo 父项目","slug":"main-repo-父项目","link":"#main-repo-父项目","children":[{"level":3,"title":"目录结构","slug":"目录结构","link":"#目录结构","children":[{"level":4,"title":"项目根目录","slug":"项目根目录","link":"#项目根目录","children":[]},{"level":4,"title":"插件目录（都是一些monorepo组织的子项目）","slug":"插件目录-都是一些monorepo组织的子项目","link":"#插件目录-都是一些monorepo组织的子项目","children":[]}]},{"level":3,"title":"根 package.json 脚本","slug":"根-package-json-脚本","link":"#根-package-json-脚本","children":[]}]},{"level":2,"title":"sub-repo 通用子项目","slug":"sub-repo-通用子项目","link":"#sub-repo-通用子项目","children":[]},{"level":2,"title":"sub-repo 主题子项目 (theme)","slug":"sub-repo-主题子项目-theme","link":"#sub-repo-主题子项目-theme","children":[{"level":3,"title":"主题专题","slug":"主题专题","link":"#主题专题","children":[]},{"level":3,"title":"文件结构专题","slug":"文件结构专题","link":"#文件结构专题","children":[]},{"level":3,"title":"侧边栏专题 (旧)","slug":"侧边栏专题-旧","link":"#侧边栏专题-旧","children":[]},{"level":3,"title":"侧边栏专题","slug":"侧边栏专题","link":"#侧边栏专题","children":[]}]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":9.09,"words":2728},"filePathRelative":"MdNote_Public/01. 设计开发与数据生产/Develop/04. Project/Type/Doc/MarkdwonAbout/01. Soft And Frame/VuePress2 (Vue3)/03. 主题扩展/Hope主题/09. 源码/03. 源码分析.md","autoDesc":true}');export{pe as comp,re as data};
