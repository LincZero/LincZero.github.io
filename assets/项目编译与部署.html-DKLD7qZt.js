import{_ as o,c as r,a as n,d as a,b as s,w as c,e as d,r as t,o as p}from"./app-CeShosDK.js";const u={},m={href:"https://github.com/LincDocs/Workflow",target:"_blank",rel:"noopener noreferrer"},b={href:"https://github.com/ebullient/markdown-it-obsidian-callouts",target:"_blank",rel:"noopener noreferrer"};function v(h,e){const i=t("ExternalLinkIcon"),l=t("RouteLink");return p(),r("div",null,[e[16]||(e[16]=n("h1",{id:"项目编译与部署",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#项目编译与部署"},[n("span",null,"项目编译与部署")])],-1)),n("p",null,[e[2]||(e[2]=n("strong",null,"注意",-1)),e[3]||(e[3]=a("：该文档仅用于编译与部署该项目（我自己的文档库），或仅供开发人员参考。 如果您想自己仿照该项目部署一个自己的在线笔记文档，请我提供的另一项目：")),n("a",m,[e[0]||(e[0]=a("LincDocs/Workflow")),s(i)]),e[4]||(e[4]=a("，以及")),s(l,{to:"/MdNote_Public/ProductDoc/Web/LincZero_Document_Library/%E7%BD%91%E7%AB%99%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D.html"},{default:c(()=>e[1]||(e[1]=[a("./网站框架介绍")])),_:1})]),e[17]||(e[17]=d(`<h2 id="编译相关" tabindex="-1"><a class="header-anchor" href="#编译相关"><span>编译相关</span></a></h2><h3 id="js内存满的错误" tabindex="-1"><a class="header-anchor" href="#js内存满的错误"><span>js内存满的错误</span></a></h3><p>注意，扩展比较多，容易爆内存，出现报错：FATAL ERROR: Ineffective mark-compacts near heap limit Allocation failed - JavaScript heap out of memory</p><p>参考：</p><ul><li>https://theme-hope.vuejs.press/zh/faq/common-error.html#fatal-error-xxx-javascript-heap-out-of-memory</li><li>https://stackoverflow.com/questions/53230823/fatal-error-ineffective-mark-compacts-near-heap-limit-allocation-failed-javas</li></ul><p>CICD需要：构建文档时设置env</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>- name: 构建文档
  env:
    NODE_OPTIONS: <span class="token parameter variable">--max_old_space_size</span><span class="token operator">=</span><span class="token number">12288</span>
  run: <span class="token operator">|</span>-
    <span class="token function">node</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;console.log(v8.getHeapStatistics())&#39;</span>
    <span class="token function">pnpm</span> run docs:build
    <span class="token operator">&gt;</span> src/.vuepress/dist/.nojekyll
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Windows/Linux 需要：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># if Linux</span>
<span class="token builtin class-name">export</span> <span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=8192&quot;</span>
<span class="token comment"># if Windows</span>
Set <span class="token assign-left variable">NODE_OPTIONS</span><span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=8192&quot;</span>
<span class="token comment"># if Windows PowerShell</span>
<span class="token variable">$env</span>:NODE_OPTIONS<span class="token operator">=</span><span class="token string">&quot;--max-old-space-size=8192&quot;</span>
<span class="token comment"># if this is the instruction in the compilation</span>
<span class="token function">node</span> --max-old-space-size<span class="token operator">=</span><span class="token number">8192</span> xxxxxxx_original_instruction

<span class="token comment"># 验证内存 (我在VSCode用\`$env\`那条才成功了，其他不行)</span>
<span class="token function">node</span> <span class="token parameter variable">-e</span> <span class="token string">&#39;console.log(v8.getHeapStatistics().heap_size_limit/(1024*1024))&#39;</span>
<span class="token comment"># 验证更多</span>
<span class="token function">node</span>
<span class="token operator">&gt;</span> v8.getHeapStatistics<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>检查：https://github.com/watson/memory-usage</p><h3 id="版本更新" tabindex="-1"><a class="header-anchor" href="#版本更新"><span>版本更新</span></a></h3><p><code>pnpm dlx vp-update</code></p><p>不要单独更新，否则可能存在版本匹配问题</p><h2 id="部署相关" tabindex="-1"><a class="header-anchor" href="#部署相关"><span>部署相关</span></a></h2><h3 id="github-page" tabindex="-1"><a class="header-anchor" href="#github-page"><span>Github Page</span></a></h3><p>注意，这里使用了 git submodule 引入多个笔记库，其中部分笔记是在私有仓库的，通过 Github Action 使用 Secrets Tokens 引入。 因此，异地部署时：需要可能修改子模块的链接，取消 private 仓库部分的笔记。或者手动指定 private 仓库的 token。</p><p>笔记库手动更新：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> submodule status
<span class="token function">git</span> submodule update <span class="token parameter variable">--recursive</span> <span class="token parameter variable">--remote</span>

<span class="token comment"># 或</span>
<span class="token function">git</span> submodule foreach <span class="token function">git</span> pull origin main
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果你不想使用我的子模块：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 1. 删除.gitmodules文件里的对应条目</span>
<span class="token comment"># 2. 移除子模块配置，这里 path/to/submodule 是你需要卸载的子模块的相对路径</span>
<span class="token function">git</span> <span class="token function">rm</span> <span class="token parameter variable">--cached</span> path/to/submodule
<span class="token comment"># 3. 提交</span>
<span class="token function">git</span> commit <span class="token parameter variable">-m</span> <span class="token string">&quot;Removed submodule &lt;submodule name&gt;&quot;</span>
<span class="token comment"># 4. 删除子模块目录</span>
<span class="token function">rm</span> <span class="token parameter variable">-rf</span> path/to/submodule
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2024-11-02:</p><p>删除了子模块系统，依赖仅依赖脚本进行。</p><p>优点：</p><ul><li>简化、解耦、方便项目的迁移与复用</li><li>不太容易存在某个文档库需要强制依赖某个版本以上的编译系统的情况（即两者之间不存在的版本依赖），子模块优点在这不起效</li></ul><h3 id="gitee-page" tabindex="-1"><a class="header-anchor" href="#gitee-page"><span>Gitee Page</span></a></h3><p>本来打算用 Gitee 镜像网站兼顾 Github 访问不稳的情况，不过 Gitee 官方现在已经停用了。</p><p>不过还是使用了 Gitee 来自动镜像 Github，进行备份。</p><h3 id="cloudflare-pages" tabindex="-1"><a class="header-anchor" href="#cloudflare-pages"><span>Cloudflare Pages</span></a></h3><p>为照顾 GitHub Page 无法稳定访问情况，备份了一个页面：https://linczero-github-io.pages.dev/</p><h2 id="笔记部分" tabindex="-1"><a class="header-anchor" href="#笔记部分"><span>笔记部分</span></a></h2><p>笔记是子项目。现在这里说一下子项目会遇到的问题：</p><ul><li>问题 <ul><li>笔记在ty和ob中折返，经常会出现：No content changes found</li></ul></li><li>原因 <ul><li><p>https://ggame.gledos.science/mkdocs/No_content_Changes_found.html</p><p>Obsidian 编辑、预览过的文件，会自动把 CRLF 替换成 LF，也就是说 Obsidian 不尊重原始文件的换行字符</p></li></ul></li><li>解决方法1 <ul><li>无用，并不是这个原因<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 在git上禁用检查文件模式</span>
<span class="token function">git</span> config core.filemode <span class="token boolean">false</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></li></ul></li><li>解决方法2 <ul><li>删掉这些修改<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> <span class="token function">rm</span> <span class="token parameter variable">-r</span> <span class="token parameter variable">--cached</span> <span class="token builtin class-name">.</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ul></li><li>解决方法3 <ul><li>不管了，把全部文件都转换成 LF 的，然后 VS Code 使用 LF 来编写</li></ul></li></ul><h2 id="相关技术" tabindex="-1"><a class="header-anchor" href="#相关技术"><span>相关技术</span></a></h2>`,33)),n("ul",null,[e[14]||(e[14]=n("li",null,"主要框架：VuePress-Hope-Theme",-1)),e[15]||(e[15]=n("li",null,"在此基础上，使用VuePress的Alias别名系统替换了多个组件，也自己写了一些相关的插件",-1)),n("li",null,[e[13]||(e[13]=a("实现本地编辑与博客预览体验的一致性： ")),n("ul",null,[n("li",null,[e[9]||(e[9]=a("Obsidian插件迁移到VuePress，以在VuePress上使用 ")),n("ul",null,[e[8]||(e[8]=n("li",null,"如 AnyBlock，重写为Markdown-it插件的版本",-1)),n("li",null,[e[6]||(e[6]=a("如 ")),n("a",b,[e[5]||(e[5]=a("Markdown-it-obisidian-callout")),s(i)]),e[7]||(e[7]=a(" 的修改，替换掉自带的 alert 插件，使其更适应ob语法"))])])]),e[10]||(e[10]=n("li",null,[a("VuePress插件迁移到Obsidian，以在Obsidian上使用 "),n("ul",null,[n("li",null,"如 Markdown-it-container 语法，重写为Obsidian插件的版本")])],-1)),e[11]||(e[11]=n("li",null,[a("其他插件和组建 "),n("ul",null,[n("li",null,"仿文件资源管理的侧边栏组件"),n("li",null,"一个钩子组的VuePress插件，用来和 AnyBlock 插件配合")])],-1)),e[12]||(e[12]=n("li",null,"修改了部分样式和逻辑等",-1))])])])])}const k=o(u,[["render",v],["__file","项目编译与部署.html.vue"]]),f=JSON.parse('{"path":"/MdNote_Public/ProductDoc/Web/LincZero_Document_Library/%E9%A1%B9%E7%9B%AE%E7%BC%96%E8%AF%91%E4%B8%8E%E9%83%A8%E7%BD%B2.html","title":"项目编译与部署","lang":"zh-CN","frontmatter":{"description":"项目编译与部署 注意：该文档仅用于编译与部署该项目（我自己的文档库），或仅供开发人员参考。 如果您想自己仿照该项目部署一个自己的在线笔记文档，请我提供的另一项目：LincDocs/Workflow，以及 编译相关 js内存满的错误 注意，扩展比较多，容易爆内存，出现报错：FATAL ERROR: Ineffective mark-compacts ne...","head":[["meta",{"property":"og:url","content":"https://LincZero.github.io/MdNote_Public/ProductDoc/Web/LincZero_Document_Library/%E9%A1%B9%E7%9B%AE%E7%BC%96%E8%AF%91%E4%B8%8E%E9%83%A8%E7%BD%B2.html"}],["meta",{"property":"og:site_name","content":"Linc 的小站"}],["meta",{"property":"og:title","content":"项目编译与部署"}],["meta",{"property":"og:description","content":"项目编译与部署 注意：该文档仅用于编译与部署该项目（我自己的文档库），或仅供开发人员参考。 如果您想自己仿照该项目部署一个自己的在线笔记文档，请我提供的另一项目：LincDocs/Workflow，以及 编译相关 js内存满的错误 注意，扩展比较多，容易爆内存，出现报错：FATAL ERROR: Ineffective mark-compacts ne..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"LincZero"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"项目编译与部署\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincZero\\",\\"url\\":\\"https://github.com/LincZero/\\"}]}"]]},"headers":[{"level":1,"title":"项目编译与部署","slug":"项目编译与部署","link":"#项目编译与部署","children":[{"level":2,"title":"编译相关","slug":"编译相关","link":"#编译相关","children":[{"level":3,"title":"js内存满的错误","slug":"js内存满的错误","link":"#js内存满的错误","children":[]},{"level":3,"title":"版本更新","slug":"版本更新","link":"#版本更新","children":[]}]},{"level":2,"title":"部署相关","slug":"部署相关","link":"#部署相关","children":[{"level":3,"title":"Github Page","slug":"github-page","link":"#github-page","children":[]},{"level":3,"title":"Gitee Page","slug":"gitee-page","link":"#gitee-page","children":[]},{"level":3,"title":"Cloudflare Pages","slug":"cloudflare-pages","link":"#cloudflare-pages","children":[]}]},{"level":2,"title":"笔记部分","slug":"笔记部分","link":"#笔记部分","children":[]},{"level":2,"title":"相关技术","slug":"相关技术","link":"#相关技术","children":[]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":3.36,"words":1007},"filePathRelative":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/项目编译与部署.md","excerpt":"\\n<p><strong>注意</strong>：该文档仅用于编译与部署该项目（我自己的文档库），或仅供开发人员参考。\\n如果您想自己仿照该项目部署一个自己的在线笔记文档，请我提供的另一项目：<a href=\\"https://github.com/LincDocs/Workflow\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">LincDocs/Workflow</a>，以及<a href=\\"/MdNote_Public/ProductDoc/Web/LincZero_Document_Library/%E7%BD%91%E7%AB%99%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D.html\\" target=\\"_blank\\">./网站框架介绍</a></p>","autoDesc":true,"bioChainData":{"outlink":[{"title":"网站框架介绍","link":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/网站框架介绍.html"}],"backlink":[{"title":"Web/","link":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/README.html"}],"localMap":{"nodes":[{"id":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/项目编译与部署.md","value":{"title":"项目编译与部署","path":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/项目编译与部署.md","outlink":["MdNote_Public/ProductDoc/Web/LincZero_Document_Library/网站框架介绍.md"],"backlink":["MdNote_Public/ProductDoc/Web/LincZero_Document_Library/README.md"]}},{"id":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/网站框架介绍.md","value":{"title":"网站框架介绍","path":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/网站框架介绍.md","outlink":[],"backlink":[]}},{"id":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/README.md","value":{"title":"Web/","path":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/README.md","outlink":[],"backlink":[]}}],"links":[{"source":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/项目编译与部署.md","target":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/网站框架介绍.md"},{"source":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/README.md","target":"MdNote_Public/ProductDoc/Web/LincZero_Document_Library/项目编译与部署.md"}]}}}');export{k as comp,f as data};
