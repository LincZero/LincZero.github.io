import{H as Dt,g as It,d as $t,e as Bt,w as J,f as G,n as tt}from"./index-0QvGefo4.js";import{h as Xn,l as Cn}from"./index-0QvGefo4.js";import{s as L,b as At,d as Ot,i as ht,T as et,a as nt,t as it}from"./transform-CqGPC-JM.js";import{o as bt}from"./ordinal-Cboi1Yqb.js";import{c as Ht}from"./colors-Cc3OSVma.js";import{s as Nt}from"./array-DEnAxiAM.js";import{w as Yt,c as mt}from"./path-CbwjOpE9.js";import{x as Lt,y as Pt}from"./point-DWREGWZc.js";import{m as ft,a as gt}from"./min-tv6RD-6E.js";import"./init-Gi6I4Gst.js";function Vt(t,e){let n,i=-1,r=-1;if(e===void 0)for(const a of t)++r,a!=null&&(n>a||n===void 0&&a>=a)&&(n=a,i=r);else for(let a of t)(a=e(a,++r,t))!=null&&(n>a||n===void 0&&a>=a)&&(n=a,i=r);return i}function Ft(t){let e;for(;e=t.sourceEvent;)t=e;return t}function P(t,e){if(t=Ft(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var i=n.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(e.getScreenCTM().inverse()),[i.x,i.y]}if(e.getBoundingClientRect){var r=e.getBoundingClientRect();return[t.clientX-r.left-e.clientLeft,t.clientY-r.top-e.clientTop]}}return[t.pageX,t.pageY]}const lt={capture:!0,passive:!1};function ct(t){t.preventDefault(),t.stopImmediatePropagation()}function Wt(t){var e=t.document.documentElement,n=L(t).on("dragstart.drag",ct,lt);"onselectstart"in e?n.on("selectstart.drag",ct,lt):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Gt(t,e){var n=t.document.documentElement,i=L(t).on("dragstart.drag",null);e&&(i.on("click.drag",ct,lt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in n?i.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var qt=1e-12;function yt(t){return((t=Math.exp(t))+1/t)/2}function Kt(t){return((t=Math.exp(t))-1/t)/2}function Ut(t){return((t=Math.exp(2*t))-1)/(t+1)}const Zt=function t(e,n,i){function r(a,l){var u=a[0],h=a[1],d=a[2],p=l[0],y=l[1],k=l[2],E=p-u,z=y-h,M=E*E+z*z,b,f;if(M<qt)f=Math.log(k/d)/e,b=function(O){return[u+O*E,h+O*z,d*Math.exp(e*O*f)]};else{var X=Math.sqrt(M),_=(k*k-d*d+i*M)/(2*d*n*X),$=(k*k-d*d-i*M)/(2*k*n*X),D=Math.log(Math.sqrt(_*_+1)-_),j=Math.log(Math.sqrt($*$+1)-$);f=(j-D)/e,b=function(O){var V=O*f,F=yt(D),W=d/(n*X)*(F*Ut(e*V+D)-Kt(D));return[u+W*E,h+W*z,d*F/yt(e*V+D)]}}return b.duration=f*1e3*e/Math.SQRT2,b}return r.rho=function(a){var l=Math.max(.001,+a),u=l*l,h=u*u;return t(l,u,h)},r}(Math.SQRT2,2,4),Qt=Ht("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf");function Jt(t){return t.source}function te(t){return t.target}function ee(t){let e=Jt,n=te,i=Lt,r=Pt,a=null,l=null,u=Yt(h);function h(){let d;const p=Nt.call(arguments),y=e.apply(this,p),k=n.apply(this,p);if(a==null&&(l=t(d=u())),l.lineStart(),p[0]=y,l.point(+i.apply(this,p),+r.apply(this,p)),p[0]=k,l.point(+i.apply(this,p),+r.apply(this,p)),l.lineEnd(),d)return l=null,d+""||null}return h.source=function(d){return arguments.length?(e=d,h):e},h.target=function(d){return arguments.length?(n=d,h):n},h.x=function(d){return arguments.length?(i=typeof d=="function"?d:mt(+d),h):i},h.y=function(d){return arguments.length?(r=typeof d=="function"?d:mt(+d),h):r},h.context=function(d){return arguments.length?(d==null?a=l=null:l=t(a=d),h):a},h}function ne(){return ee(At)}const K=t=>()=>t;function ie(t,{sourceEvent:e,target:n,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function rt(t){t.stopImmediatePropagation()}function q(t){t.preventDefault(),t.stopImmediatePropagation()}function re(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function oe(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function xt(){return this.__zoom||ht}function ae(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function se(){return navigator.maxTouchPoints||"ontouchstart"in this}function le(t,e,n){var i=t.invertX(e[0][0])-n[0][0],r=t.invertX(e[1][0])-n[1][0],a=t.invertY(e[0][1])-n[0][1],l=t.invertY(e[1][1])-n[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),l>a?(a+l)/2:Math.min(0,a)||Math.max(0,l))}function ce(){var t=re,e=oe,n=le,i=ae,r=se,a=[0,1/0],l=[[-1/0,-1/0],[1/0,1/0]],u=250,h=Zt,d=Ot("start","zoom","end"),p,y,k,E=500,z=150,M=0,b=10;function f(o){o.property("__zoom",xt).on("wheel.zoom",V,{passive:!1}).on("mousedown.zoom",F).on("dblclick.zoom",W).filter(r).on("touchstart.zoom",s).on("touchmove.zoom",x).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}f.transform=function(o,m,c,g){var v=o.selection?o.selection():o;v.property("__zoom",xt),o!==v?D(o,m,c,g):v.interrupt().each(function(){j(this,arguments).event(g).start().zoom(null,typeof m=="function"?m.apply(this,arguments):m).end()})},f.scaleBy=function(o,m,c,g){f.scaleTo(o,function(){var v=this.__zoom.k,w=typeof m=="function"?m.apply(this,arguments):m;return v*w},c,g)},f.scaleTo=function(o,m,c,g){f.transform(o,function(){var v=e.apply(this,arguments),w=this.__zoom,S=c==null?$(v):typeof c=="function"?c.apply(this,arguments):c,C=w.invert(S),T=typeof m=="function"?m.apply(this,arguments):m;return n(_(X(w,T),S,C),v,l)},c,g)},f.translateBy=function(o,m,c,g){f.transform(o,function(){return n(this.__zoom.translate(typeof m=="function"?m.apply(this,arguments):m,typeof c=="function"?c.apply(this,arguments):c),e.apply(this,arguments),l)},null,g)},f.translateTo=function(o,m,c,g,v){f.transform(o,function(){var w=e.apply(this,arguments),S=this.__zoom,C=g==null?$(w):typeof g=="function"?g.apply(this,arguments):g;return n(ht.translate(C[0],C[1]).scale(S.k).translate(typeof m=="function"?-m.apply(this,arguments):-m,typeof c=="function"?-c.apply(this,arguments):-c),w,l)},g,v)};function X(o,m){return m=Math.max(a[0],Math.min(a[1],m)),m===o.k?o:new et(m,o.x,o.y)}function _(o,m,c){var g=m[0]-c[0]*o.k,v=m[1]-c[1]*o.k;return g===o.x&&v===o.y?o:new et(o.k,g,v)}function $(o){return[(+o[0][0]+ +o[1][0])/2,(+o[0][1]+ +o[1][1])/2]}function D(o,m,c,g){o.on("start.zoom",function(){j(this,arguments).event(g).start()}).on("interrupt.zoom end.zoom",function(){j(this,arguments).event(g).end()}).tween("zoom",function(){var v=this,w=arguments,S=j(v,w).event(g),C=e.apply(v,w),T=c==null?$(C):typeof c=="function"?c.apply(v,w):c,H=Math.max(C[1][0]-C[0][0],C[1][1]-C[0][1]),R=v.__zoom,B=typeof m=="function"?m.apply(v,w):m,N=h(R.invert(T).concat(H/R.k),B.invert(T).concat(H/B.k));return function(A){if(A===1)A=B;else{var Y=N(A),Q=H/Y[2];A=new et(Q,T[0]-Y[0]*Q,T[1]-Y[1]*Q)}S.zoom(null,A)}})}function j(o,m,c){return!c&&o.__zooming||new O(o,m)}function O(o,m){this.that=o,this.args=m,this.active=0,this.sourceEvent=null,this.extent=e.apply(o,m),this.taps=0}O.prototype={event:function(o){return o&&(this.sourceEvent=o),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(o,m){return this.mouse&&o!=="mouse"&&(this.mouse[1]=m.invert(this.mouse[0])),this.touch0&&o!=="touch"&&(this.touch0[1]=m.invert(this.touch0[0])),this.touch1&&o!=="touch"&&(this.touch1[1]=m.invert(this.touch1[0])),this.that.__zoom=m,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(o){var m=L(this.that).datum();d.call(o,this.that,new ie(o,{sourceEvent:this.sourceEvent,target:f,type:o,transform:this.that.__zoom,dispatch:d}),m)}};function V(o,...m){if(!t.apply(this,arguments))return;var c=j(this,m).event(o),g=this.__zoom,v=Math.max(a[0],Math.min(a[1],g.k*Math.pow(2,i.apply(this,arguments)))),w=P(o);if(c.wheel)(c.mouse[0][0]!==w[0]||c.mouse[0][1]!==w[1])&&(c.mouse[1]=g.invert(c.mouse[0]=w)),clearTimeout(c.wheel);else{if(g.k===v)return;c.mouse=[w,g.invert(w)],nt(this),c.start()}q(o),c.wheel=setTimeout(S,z),c.zoom("mouse",n(_(X(g,v),c.mouse[0],c.mouse[1]),c.extent,l));function S(){c.wheel=null,c.end()}}function F(o,...m){if(k||!t.apply(this,arguments))return;var c=o.currentTarget,g=j(this,m,!0).event(o),v=L(o.view).on("mousemove.zoom",T,!0).on("mouseup.zoom",H,!0),w=P(o,c),S=o.clientX,C=o.clientY;Wt(o.view),rt(o),g.mouse=[w,this.__zoom.invert(w)],nt(this),g.start();function T(R){if(q(R),!g.moved){var B=R.clientX-S,N=R.clientY-C;g.moved=B*B+N*N>M}g.event(R).zoom("mouse",n(_(g.that.__zoom,g.mouse[0]=P(R,c),g.mouse[1]),g.extent,l))}function H(R){v.on("mousemove.zoom mouseup.zoom",null),Gt(R.view,g.moved),q(R),g.event(R).end()}}function W(o,...m){if(t.apply(this,arguments)){var c=this.__zoom,g=P(o.changedTouches?o.changedTouches[0]:o,this),v=c.invert(g),w=c.k*(o.shiftKey?.5:2),S=n(_(X(c,w),g,v),e.apply(this,m),l);q(o),u>0?L(this).transition().duration(u).call(D,S,g,o):L(this).call(f.transform,S,g,o)}}function s(o,...m){if(t.apply(this,arguments)){var c=o.touches,g=c.length,v=j(this,m,o.changedTouches.length===g).event(o),w,S,C,T;for(rt(o),S=0;S<g;++S)C=c[S],T=P(C,this),T=[T,this.__zoom.invert(T),C.identifier],v.touch0?!v.touch1&&v.touch0[2]!==T[2]&&(v.touch1=T,v.taps=0):(v.touch0=T,w=!0,v.taps=1+!!p);p&&(p=clearTimeout(p)),w&&(v.taps<2&&(y=T[0],p=setTimeout(function(){p=null},E)),nt(this),v.start())}}function x(o,...m){if(this.__zooming){var c=j(this,m).event(o),g=o.changedTouches,v=g.length,w,S,C,T;for(q(o),w=0;w<v;++w)S=g[w],C=P(S,this),c.touch0&&c.touch0[2]===S.identifier?c.touch0[0]=C:c.touch1&&c.touch1[2]===S.identifier&&(c.touch1[0]=C);if(S=c.that.__zoom,c.touch1){var H=c.touch0[0],R=c.touch0[1],B=c.touch1[0],N=c.touch1[1],A=(A=B[0]-H[0])*A+(A=B[1]-H[1])*A,Y=(Y=N[0]-R[0])*Y+(Y=N[1]-R[1])*Y;S=X(S,Math.sqrt(A/Y)),C=[(H[0]+B[0])/2,(H[1]+B[1])/2],T=[(R[0]+N[0])/2,(R[1]+N[1])/2]}else if(c.touch0)C=c.touch0[0],T=c.touch0[1];else return;c.zoom("touch",n(_(S,C,T),c.extent,l))}}function I(o,...m){if(this.__zooming){var c=j(this,m).event(o),g=o.changedTouches,v=g.length,w,S;for(rt(o),k&&clearTimeout(k),k=setTimeout(function(){k=null},E),w=0;w<v;++w)S=g[w],c.touch0&&c.touch0[2]===S.identifier?delete c.touch0:c.touch1&&c.touch1[2]===S.identifier&&delete c.touch1;if(c.touch1&&!c.touch0&&(c.touch0=c.touch1,delete c.touch1),c.touch0)c.touch0[1]=this.__zoom.invert(c.touch0[0]);else if(c.end(),c.taps===2&&(S=P(S,this),Math.hypot(y[0]-S[0],y[1]-S[1])<b)){var C=L(this).on("dblclick.zoom");C&&C.apply(this,arguments)}}}return f.wheelDelta=function(o){return arguments.length?(i=typeof o=="function"?o:K(+o),f):i},f.filter=function(o){return arguments.length?(t=typeof o=="function"?o:K(!!o),f):t},f.touchable=function(o){return arguments.length?(r=typeof o=="function"?o:K(!!o),f):r},f.extent=function(o){return arguments.length?(e=typeof o=="function"?o:K([[+o[0][0],+o[0][1]],[+o[1][0],+o[1][1]]]),f):e},f.scaleExtent=function(o){return arguments.length?(a[0]=+o[0],a[1]=+o[1],f):[a[0],a[1]]},f.translateExtent=function(o){return arguments.length?(l[0][0]=+o[0][0],l[1][0]=+o[1][0],l[0][1]=+o[0][1],l[1][1]=+o[1][1],f):[[l[0][0],l[0][1]],[l[1][0],l[1][1]]]},f.constrain=function(o){return arguments.length?(n=o,f):n},f.duration=function(o){return arguments.length?(u=+o,f):u},f.interpolate=function(o){return arguments.length?(h=o,f):h},f.on=function(){var o=d.on.apply(d,arguments);return o===d?f:o},f.clickDistance=function(o){return arguments.length?(M=(o=+o)*o,f):Math.sqrt(M)},f.tapDistance=function(o){return arguments.length?(b=+o,f):b},f}const wt=typeof navigator<"u"&&navigator.userAgent.includes("Macintosh"),ue=bt(Qt),St={autoFit:!1,color:t=>{var e;return ue(`${((e=t.state)==null?void 0:e.path)||""}`)},duration:500,embedGlobalCSS:!0,fitRatio:.95,maxInitialScale:2,maxWidth:0,nodeMinHeight:16,paddingX:8,scrollForPan:wt,spacingHorizontal:80,spacingVertical:5,initialExpandLevel:-1,zoom:!0,pan:!0,toggleRecursively:!1};function wn(t){const e={},n={...t},{color:i,colorFreezeLevel:r}=n;if((i==null?void 0:i.length)===1){const a=i[0];e.color=()=>a}else if(i!=null&&i.length){const a=bt(i);e.color=l=>a(`${l.state.path}`)}if(r){const a=e.color||St.color;e.color=l=>(l={...l,state:{...l.state,path:l.state.path.split(".").slice(0,r).join(".")}},a(l))}return["duration","fitRatio","initialExpandLevel","maxInitialScale","maxWidth","nodeMinHeight","paddingX","spacingHorizontal","spacingVertical"].forEach(a=>{const l=n[a];typeof l=="number"&&(e[a]=l)}),["zoom","pan"].forEach(a=>{const l=n[a];l!=null&&(e[a]=!!l)}),e}/*! @gera2ld/jsx-dom v2.2.2 | ISC License */const Et=1,Mt=2,he="http://www.w3.org/2000/svg",ot="http://www.w3.org/1999/xlink",de={show:ot,actuate:ot,href:ot},pe=t=>typeof t=="string"||typeof t=="number",me=t=>(t==null?void 0:t.vtype)===Et,fe=t=>(t==null?void 0:t.vtype)===Mt;function U(t,e){let n;if(typeof t=="string")n=Et;else if(typeof t=="function")n=Mt;else throw new Error("Invalid VNode type");return{vtype:n,type:t,props:e}}function ge(t){return t.children}const ye={isSvg:!1};function vt(t,e){Array.isArray(e)||(e=[e]),e=e.filter(Boolean),e.length&&t.append(...e)}function xe(t,e,n){for(const i in e)if(!(i==="key"||i==="children"||i==="ref"))if(i==="dangerouslySetInnerHTML")t.innerHTML=e[i].__html;else if(i==="innerHTML"||i==="textContent"||i==="innerText"||i==="value"&&["textarea","select"].includes(t.tagName)){const r=e[i];r!=null&&(t[i]=r)}else i.startsWith("on")?t[i.toLowerCase()]=e[i]:ke(t,i,e[i],n.isSvg)}const ve={className:"class",labelFor:"for"};function ke(t,e,n,i){if(e=ve[e]||e,n===!0)t.setAttribute(e,"");else if(n===!1)t.removeAttribute(e);else{const r=i?de[e]:void 0;r!==void 0?t.setAttributeNS(r,e,n):t.setAttribute(e,n)}}function ze(t){return t.reduce((e,n)=>e.concat(n),[])}function ut(t,e){return Array.isArray(t)?ze(t.map(n=>ut(n,e))):dt(t,e)}function dt(t,e=ye){if(t==null||typeof t=="boolean")return null;if(t instanceof Node)return t;if(fe(t)){const{type:n,props:i}=t;if(n===ge){const a=document.createDocumentFragment();if(i.children){const l=ut(i.children,e);vt(a,l)}return a}const r=n(i);return dt(r,e)}if(pe(t))return document.createTextNode(`${t}`);if(me(t)){let n;const{type:i,props:r}=t;if(!e.isSvg&&i==="svg"&&(e=Object.assign({},e,{isSvg:!0})),e.isSvg?n=document.createElementNS(he,i):n=document.createElement(i),xe(n,r,e),r.children){let l=e;e.isSvg&&i==="foreignObject"&&(l=Object.assign({},l,{isSvg:!1}));const u=ut(r.children,l);u!=null&&vt(n,u)}const{ref:a}=r;return typeof a=="function"&&a(n),n}throw new Error("mount: Invalid Vnode!")}function at(t){return dt(t)}function be(t){var e=0,n=t.children,i=n&&n.length;if(!i)e=1;else for(;--i>=0;)e+=n[i].value;t.value=e}function we(){return this.eachAfter(be)}function Se(t){var e=this,n,i=[e],r,a,l;do for(n=i.reverse(),i=[];e=n.pop();)if(t(e),r=e.children,r)for(a=0,l=r.length;a<l;++a)i.push(r[a]);while(i.length);return this}function Ee(t){for(var e=this,n=[e],i,r;e=n.pop();)if(t(e),i=e.children,i)for(r=i.length-1;r>=0;--r)n.push(i[r]);return this}function Me(t){for(var e=this,n=[e],i=[],r,a,l;e=n.pop();)if(i.push(e),r=e.children,r)for(a=0,l=r.length;a<l;++a)n.push(r[a]);for(;e=i.pop();)t(e);return this}function Xe(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,i=e.children,r=i&&i.length;--r>=0;)n+=i[r].value;e.value=n})}function Ce(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function Te(t){for(var e=this,n=_e(e,t),i=[e];e!==n;)e=e.parent,i.push(e);for(var r=i.length;t!==n;)i.splice(r,0,t),t=t.parent;return i}function _e(t,e){if(t===e)return t;var n=t.ancestors(),i=e.ancestors(),r=null;for(t=n.pop(),e=i.pop();t===e;)r=t,t=n.pop(),e=i.pop();return r}function je(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function Re(){var t=[];return this.each(function(e){t.push(e)}),t}function De(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function Ie(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function pt(t,e){var n=new Z(t),i=+t.value&&(n.value=t.value),r,a=[n],l,u,h,d;for(e==null&&(e=Be);r=a.pop();)if(i&&(r.value=+r.data.value),(u=e(r.data))&&(d=u.length))for(r.children=new Array(d),h=d-1;h>=0;--h)a.push(l=r.children[h]=new Z(u[h])),l.parent=r,l.depth=r.depth+1;return n.eachBefore(Oe)}function $e(){return pt(this).eachBefore(Ae)}function Be(t){return t.children}function Ae(t){t.data=t.data.data}function Oe(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Z(t){this.data=t,this.depth=this.height=0,this.parent=null}Z.prototype=pt.prototype={constructor:Z,count:we,each:Se,eachAfter:Me,eachBefore:Ee,sum:Xe,sort:Ce,path:Te,ancestors:je,descendants:Re,leaves:De,links:Ie,copy:$e};const He="d3-flextree",Ne="2.1.2",Ye="build/d3-flextree.js",Le="index",Pe={name:"Chris Maloney",url:"http://chrismaloney.org"},Ve="Flexible tree layout algorithm that allows for variable node sizes.",Fe=["d3","d3-module","layout","tree","hierarchy","d3-hierarchy","plugin","d3-plugin","infovis","visualization","2d"],We="https://github.com/klortho/d3-flextree",Ge="WTFPL",qe={type:"git",url:"https://github.com/klortho/d3-flextree.git"},Ke={clean:"rm -rf build demo test","build:demo":"rollup -c --environment BUILD:demo","build:dev":"rollup -c --environment BUILD:dev","build:prod":"rollup -c --environment BUILD:prod","build:test":"rollup -c --environment BUILD:test",build:"rollup -c",lint:"eslint index.js src","test:main":"node test/bundle.js","test:browser":"node test/browser-tests.js",test:"npm-run-all test:*",prepare:"npm-run-all clean build lint test"},Ue={"d3-hierarchy":"^1.1.5"},Ze={"babel-plugin-external-helpers":"^6.22.0","babel-preset-es2015-rollup":"^3.0.0",d3:"^4.13.0","d3-selection-multi":"^1.0.1",eslint:"^4.19.1",jsdom:"^11.6.2","npm-run-all":"^4.1.2",rollup:"^0.55.3","rollup-plugin-babel":"^2.7.1","rollup-plugin-commonjs":"^8.0.2","rollup-plugin-copy":"^0.2.3","rollup-plugin-json":"^2.3.0","rollup-plugin-node-resolve":"^3.0.2","rollup-plugin-uglify":"^3.0.0","uglify-es":"^3.3.9"},Qe={name:He,version:Ne,main:Ye,module:Le,"jsnext:main":"index",author:Pe,description:Ve,keywords:Fe,homepage:We,license:Ge,repository:qe,scripts:Ke,dependencies:Ue,devDependencies:Ze},{version:Je}=Qe,tn=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function Ct(t){const e=Object.assign({},tn,t);function n(u){const h=e[u];return typeof h=="function"?h:()=>h}function i(u){const h=l(a(),u,d=>d.children);return h.update(),h.data}function r(){const u=n("nodeSize"),h=n("spacing");return class Xt extends pt.prototype.constructor{constructor(p){super(p)}copy(){const p=l(this.constructor,this,y=>y.children);return p.each(y=>y.data=y.data.data),p}get size(){return u(this)}spacing(p){return h(this,p)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const p=this.ancestors();return p[p.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((p,y)=>Xt.maxExtents(p,y.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(p,y){return{top:Math.min(p.top,y.top),bottom:Math.max(p.bottom,y.bottom),left:Math.min(p.left,y.left),right:Math.max(p.right,y.right)}}}}function a(){const u=r(),h=n("nodeSize"),d=n("spacing");return class extends u{constructor(p){super(p),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return h(this.data)}spacing(p){return d(this.data,p.data)}get x(){return this.data.x}set x(p){this.data.x=p}get y(){return this.data.y}set y(p){this.data.y=p}update(){return Tt(this),_t(this),this}}}function l(u,h,d){const p=(y,k)=>{const E=new u(y);Object.assign(E,{parent:k,depth:k===null?0:k.depth+1,height:0,length:1});const z=d(y)||[];return E.children=z.length===0?null:z.map(M=>p(M,E)),E.children&&Object.assign(E,E.children.reduce((M,b)=>({height:Math.max(M.height,b.height+1),length:M.length+b.length}),E)),E};return p(h,null)}return Object.assign(i,{nodeSize(u){return arguments.length?(e.nodeSize=u,i):e.nodeSize},spacing(u){return arguments.length?(e.spacing=u,i):e.spacing},children(u){return arguments.length?(e.children=u,i):e.children},hierarchy(u,h){const d=typeof h>"u"?e.children:h;return l(r(),u,d)},dump(u){const h=n("nodeSize"),d=p=>y=>{const k=p+"  ",E=p+"    ",{x:z,y:M}=y,b=h(y),f=y.children||[],X=f.length===0?" ":`,${k}children: [${E}${f.map(d(E)).join(E)}${k}],${p}`;return`{ size: [${b.join(", ")}],${k}x: ${z}, y: ${M}${X}},`};return d(`
`)(u)}}),i}Ct.version=Je;const Tt=(t,e=0)=>(t.y=e,(t.children||[]).reduce((n,i)=>{const[r,a]=n;Tt(i,t.y+t.ySize);const l=(r===0?i.lExt:i.rExt).bottom;r!==0&&nn(t,r,a);const u=hn(l,r,a);return[r+1,u]},[0,null]),en(t),un(t),t),_t=(t,e,n)=>{typeof e>"u"&&(e=-t.relX-t.prelim,n=0);const i=e+t.relX;return t.relX=i+t.prelim-n,t.prelim=0,t.x=n+t.relX,(t.children||[]).forEach(r=>_t(r,i,t.x)),t},en=t=>{(t.children||[]).reduce((e,n)=>{const[i,r]=e,a=i+n.shift,l=r+a+n.change;return n.relX+=l,[a,l]},[0,0])},nn=(t,e,n)=>{const i=t.children[e-1],r=t.children[e];let a=i,l=i.relX,u=r,h=r.relX,d=!0;for(;a&&u;){a.bottom>n.lowY&&(n=n.next);const p=l+a.prelim-(h+u.prelim)+a.xSize/2+u.xSize/2+a.spacing(u);(p>0||p<0&&d)&&(h+=p,rn(r,p),on(t,e,n.index,p)),d=!1;const y=a.bottom,k=u.bottom;y<=k&&(a=sn(a),a&&(l+=a.relX)),y>=k&&(u=an(u),u&&(h+=u.relX))}!a&&u?ln(t,e,u,h):a&&!u&&cn(t,e,a,l)},rn=(t,e)=>{t.relX+=e,t.lExtRelX+=e,t.rExtRelX+=e},on=(t,e,n,i)=>{const r=t.children[e],a=e-n;if(a>1){const l=i/a;t.children[n+1].shift+=l,r.shift-=l,r.change-=i-l}},an=t=>t.hasChildren?t.firstChild:t.lThr,sn=t=>t.hasChildren?t.lastChild:t.rThr,ln=(t,e,n,i)=>{const r=t.firstChild,a=r.lExt,l=t.children[e];a.lThr=n;const u=i-n.relX-r.lExtRelX;a.relX+=u,a.prelim-=u,r.lExt=l.lExt,r.lExtRelX=l.lExtRelX},cn=(t,e,n,i)=>{const r=t.children[e],a=r.rExt,l=t.children[e-1];a.rThr=n;const u=i-n.relX-r.rExtRelX;a.relX+=u,a.prelim-=u,r.rExt=l.rExt,r.rExtRelX=l.rExtRelX},un=t=>{if(t.hasChildren){const e=t.firstChild,n=t.lastChild,i=(e.prelim+e.relX-e.xSize/2+n.relX+n.prelim+n.xSize/2)/2;Object.assign(t,{prelim:i,lExt:e.lExt,lExtRelX:e.lExtRelX,rExt:n.rExt,rExtRelX:n.rExtRelX})}},hn=(t,e,n)=>{for(;n!==null&&t>=n.lowY;)n=n.next;return{lowY:t,index:e,next:n}},dn=".markmap-container{position:absolute;width:0;height:0;top:-100px;left:-100px;overflow:hidden}.markmap-container>.markmap-foreign{display:inline-block}.markmap-container>.markmap-foreign>div:last-child,.markmap-container>.markmap-foreign>div:last-child :not(pre){white-space:nowrap}.markmap-container>.markmap-foreign>div:last-child code{white-space:inherit}",jt=".markmap{--markmap-max-width: none;--markmap-a-color: #0097e6;--markmap-a-hover-color: #00a8ff;--markmap-code-bg: #f0f0f0;--markmap-code-color: #555;--markmap-highlight-bg: #ffeaa7;--markmap-table-border: 1px solid currentColor;--markmap-font: 300 16px/20px sans-serif;--markmap-circle-open-bg: #fff;--markmap-text-color: #333;font:var(--markmap-font);color:var(--markmap-text-color)}.markmap-link{fill:none}.markmap-node>circle{cursor:pointer}.markmap-foreign{display:inline-block}.markmap-foreign p{margin:0}.markmap-foreign a{color:var(--markmap-a-color)}.markmap-foreign a:hover{color:var(--markmap-a-hover-color)}.markmap-foreign code{padding:.25em;font-size:calc(1em - 2px);color:var(--markmap-code-color);background-color:var(--markmap-code-bg);border-radius:2px}.markmap-foreign pre{margin:0}.markmap-foreign pre>code{display:block}.markmap-foreign del{text-decoration:line-through}.markmap-foreign em{font-style:italic}.markmap-foreign strong{font-weight:700}.markmap-foreign mark{background:var(--markmap-highlight-bg)}.markmap-foreign table,.markmap-foreign th,.markmap-foreign td{border-collapse:collapse;border:var(--markmap-table-border)}.markmap-foreign img{display:inline-block}.markmap-foreign svg{fill:currentColor}.markmap-foreign-testing-max{max-width:var(--markmap-max-width)}.markmap-foreign-testing-max img{max-width:var(--markmap-max-width);max-height:none}.markmap-dark .markmap{--markmap-code-bg: #1a1b26;--markmap-code-color: #ddd;--markmap-circle-open-bg: #444;--markmap-text-color: #eee}",Sn=jt;function kt(t){const e=t.data;return Math.max(4-2*e.state.depth,1.5)}function zt(t,e){const n=Vt(t,e);return t[n]}function st(t){t.stopPropagation()}const pn=new Dt;class Rt{constructor(e,n){this.options=St,this.revokers=[],this.imgCache={},this.handleZoom=i=>{const{transform:r}=i;this.g.attr("transform",r)},this.handlePan=i=>{i.preventDefault();const r=it(this.svg.node()),a=r.translate(-i.deltaX/r.k,-i.deltaY/r.k);this.svg.call(this.zoom.transform,a)},this.handleClick=(i,r)=>{let a=this.options.toggleRecursively;(wt?i.metaKey:i.ctrlKey)&&(a=!a),this.toggleNode(r.data,a)},this.svg=e.datum?e:L(e),this.styleNode=this.svg.append("style"),this.zoom=ce().filter(i=>this.options.scrollForPan&&i.type==="wheel"?i.ctrlKey&&!i.button:(!i.ctrlKey||i.type==="wheel")&&!i.button).on("zoom",this.handleZoom),this.setOptions(n),this.state={id:this.options.id||this.svg.attr("id")||It(),minX:0,maxX:0,minY:0,maxY:0},this.g=this.svg.append("g"),this.debouncedRefresh=$t(()=>this.setData(),200),this.revokers.push(pn.tap(()=>{this.setData()}))}getStyleContent(){const{style:e}=this.options,{id:n}=this.state,i=typeof e=="function"?e(n):"";return[this.options.embedGlobalCSS&&jt,i].filter(Boolean).join(`
`)}updateStyle(){this.svg.attr("class",Bt(this.svg.attr("class"),"markmap",this.state.id));const e=this.getStyleContent();this.styleNode.text(e)}toggleNode(e,n=!1){var i,r;const a=(i=e.payload)!=null&&i.fold?0:1;n?J(e,(l,u)=>{l.payload={...l.payload,fold:a},u()}):e.payload={...e.payload,fold:(r=e.payload)!=null&&r.fold?0:1},this.renderData(e)}initializeData(e){let n=0;const{color:i,nodeMinHeight:r,maxWidth:a,initialExpandLevel:l}=this.options,{id:u}=this.state,h=at(U("div",{className:`markmap-container markmap ${u}-g`})),d=at(U("style",{children:[this.getStyleContent(),dn].join(`
`)}));document.body.append(h,d);const p=a?`--markmap-max-width: ${a}px`:"";let y=0,k=0;J(e,(z,M,b)=>{var f,X,_;k+=1,z.children=(f=z.children)==null?void 0:f.map(j=>({...j})),n+=1;const $=at(U("div",{className:"markmap-foreign markmap-foreign-testing-max",style:p,children:U("div",{dangerouslySetInnerHTML:{__html:z.content}})}));h.append($),z.state={...z.state,depth:k,id:n,el:$.firstChild},z.state.path=[(X=b==null?void 0:b.state)==null?void 0:X.path,z.state.id].filter(Boolean).join("."),i(z);const D=((_=z.payload)==null?void 0:_.fold)===2;D?y+=1:(y||l>=0&&z.state.depth>=l)&&(z.payload={...z.payload,fold:1}),M(),D&&(y-=1),k-=1});const E=Array.from(h.childNodes).map(z=>z.firstChild);this._checkImages(h),E.forEach(z=>{var M;(M=z.parentNode)==null||M.append(z.cloneNode(!0))}),J(e,(z,M,b)=>{var f;const X=z.state,_=X.el.getBoundingClientRect();z.content=X.el.innerHTML,X.size=[Math.ceil(_.width)+1,Math.max(Math.ceil(_.height),r)],X.key=[(f=b==null?void 0:b.state)==null?void 0:f.id,X.id].filter(Boolean).join(".")+z.content,M()}),h.remove(),d.remove()}_checkImages(e){e.querySelectorAll("img").forEach(n=>{if(n.width)return;const i=this.imgCache[n.src];i!=null&&i[0]?[n.width,n.height]=i:i||this._loadImage(n.src)})}_loadImage(e){this.imgCache[e]=[0,0];const n=new Image;n.src=e,n.onload=()=>{this.imgCache[e]=[n.naturalWidth,n.naturalHeight],this.debouncedRefresh()}}setOptions(e){this.options={...this.options,...e},this.options.zoom?this.svg.call(this.zoom):this.svg.on(".zoom",null),this.options.pan?this.svg.on("wheel",this.handlePan):this.svg.on("wheel",null)}setData(e,n){n&&this.setOptions(n),e&&(this.state.data=e),this.state.data&&(this.initializeData(this.state.data),this.updateStyle(),this.renderData())}renderData(e){if(!this.state.data)return;const{spacingHorizontal:n,paddingX:i,spacingVertical:r,autoFit:a,color:l}=this.options,u=Ct({}).children(s=>{var x;if(!((x=s.payload)!=null&&x.fold))return s.children}).nodeSize(s=>{const[x,I]=s.data.state.size;return[I,x+(x?i*2:0)+n]}).spacing((s,x)=>s.parent===x.parent?r:r*2),h=u.hierarchy(this.state.data);u(h);const d=h.descendants().reverse(),p=h.links(),y=ne(),k=ft(d,s=>s.x-s.xSize/2),E=gt(d,s=>s.x+s.xSize/2),z=ft(d,s=>s.y),M=gt(d,s=>s.y+s.ySize-n);Object.assign(this.state,{minX:k,maxX:E,minY:z,maxY:M}),a&&this.fit();const b=e&&d.find(s=>s.data===e)||h,f=b.data.state.x0??b.x,X=b.data.state.y0??b.y,_=this.g.selectAll(G("g")).data(d,s=>s.data.state.key),$=_.enter().append("g").attr("data-depth",s=>s.data.state.depth).attr("data-path",s=>s.data.state.path).attr("transform",s=>`translate(${X+b.ySize-s.ySize},${f+b.xSize/2-s.xSize})`),D=this.transition(_.exit());D.select("line").attr("x1",s=>s.ySize-n).attr("x2",s=>s.ySize-n),D.select("foreignObject").style("opacity",0),D.attr("transform",s=>`translate(${b.y+b.ySize-s.ySize},${b.x+b.xSize/2-s.xSize})`).remove();const j=_.merge($).attr("class",s=>{var x;return["markmap-node",((x=s.data.payload)==null?void 0:x.fold)&&"markmap-fold"].filter(Boolean).join(" ")});this.transition(j).attr("transform",s=>`translate(${s.y},${s.x-s.xSize/2})`);const O=j.selectAll(G("line")).data(s=>[s],s=>s.data.state.key).join(s=>s.append("line").attr("x1",x=>x.ySize-n).attr("x2",x=>x.ySize-n),s=>s,s=>s.remove());this.transition(O).attr("x1",-1).attr("x2",s=>s.ySize-n+2).attr("y1",s=>s.xSize).attr("y2",s=>s.xSize).attr("stroke",s=>l(s.data)).attr("stroke-width",kt);const V=j.selectAll(G("circle")).data(s=>{var x;return(x=s.data.children)!=null&&x.length?[s]:[]},s=>s.data.state.key).join(s=>s.append("circle").attr("stroke-width","1.5").attr("cx",x=>x.ySize-n).attr("cy",x=>x.xSize).attr("r",0).on("click",(x,I)=>this.handleClick(x,I)).on("mousedown",st),s=>s,s=>s.remove());this.transition(V).attr("r",6).attr("cx",s=>s.ySize-n).attr("cy",s=>s.xSize).attr("stroke",s=>l(s.data)).attr("fill",s=>{var x;return(x=s.data.payload)!=null&&x.fold&&s.data.children?l(s.data):"var(--markmap-circle-open-bg)"});const F=j.selectAll(G("foreignObject")).data(s=>[s],s=>s.data.state.key).join(s=>{const x=s.append("foreignObject").attr("class","markmap-foreign").attr("x",i).attr("y",0).style("opacity",0).on("mousedown",st).on("dblclick",st);return x.append("xhtml:div").select(function(I){const o=I.data.state.el.cloneNode(!0);return this.replaceWith(o),o}).attr("xmlns","http://www.w3.org/1999/xhtml"),x},s=>s,s=>s.remove()).attr("width",s=>Math.max(0,s.ySize-n-i*2)).attr("height",s=>s.xSize);this.transition(F).style("opacity",1);const W=this.g.selectAll(G("path")).data(p,s=>s.target.data.state.key).join(s=>{const x=[X+b.ySize-n,f+b.xSize/2];return s.insert("path","g").attr("class","markmap-link").attr("data-depth",I=>I.target.data.state.depth).attr("data-path",I=>I.target.data.state.path).attr("d",y({source:x,target:x}))},s=>s,s=>{const x=[b.y+b.ySize-n,b.x+b.xSize/2];return this.transition(s).attr("d",y({source:x,target:x})).remove()});this.transition(W).attr("stroke",s=>l(s.target.data)).attr("stroke-width",s=>kt(s.target)).attr("d",s=>{const x=s.source,I=s.target,o=[x.y+x.ySize-n,x.x+x.xSize/2],m=[I.y,I.x+I.xSize/2];return y({source:o,target:m})}),d.forEach(s=>{s.data.state.x0=s.x,s.data.state.y0=s.y})}transition(e){const{duration:n}=this.options;return e.transition().duration(n)}async fit(e=this.options.maxInitialScale){const n=this.svg.node(),{width:i,height:r}=n.getBoundingClientRect(),{fitRatio:a}=this.options,{minX:l,maxX:u,minY:h,maxY:d}=this.state,p=d-h,y=u-l,k=Math.min(i/p*a,r/y*a,e),E=ht.translate((i-p*k)/2-h*k,(r-y*k)/2-l*k).scale(k);return this.transition(this.svg).call(this.zoom.transform,E).end().catch(tt)}findElement(e){let n;return this.g.selectAll(G("g")).each(function(i){i.data===e&&(n={data:i,g:this})}),n}async ensureView(e,n){var i;const r=(i=this.findElement(e))==null?void 0:i.data;if(!r)return;const a=this.svg.node(),{spacingHorizontal:l}=this.options,u=a.getBoundingClientRect(),h=it(a),[d,p]=[r.y,r.y+r.ySize-l+2].map(X=>X*h.k+h.x),[y,k]=[r.x-r.xSize/2,r.x+r.xSize/2].map(X=>X*h.k+h.y),E={left:0,right:0,top:0,bottom:0,...n},z=[E.left-d,u.width-E.right-p],M=[E.top-y,u.height-E.bottom-k],b=z[0]*z[1]>0?zt(z,Math.abs)/h.k:0,f=M[0]*M[1]>0?zt(M,Math.abs)/h.k:0;if(b||f){const X=h.translate(b,f);return this.transition(this.svg).call(this.zoom.transform,X).end().catch(tt)}}async rescale(e){const n=this.svg.node(),{width:i,height:r}=n.getBoundingClientRect(),a=i/2,l=r/2,u=it(n),h=u.translate((a-u.x)*(1-e)/u.k,(l-u.y)*(1-e)/u.k).scale(e);return this.transition(this.svg).call(this.zoom.transform,h).end().catch(tt)}destroy(){this.svg.on(".zoom",null),this.svg.html(null),this.revokers.forEach(e=>{e()})}static create(e,n,i=null){const r=new Rt(e,n);return i&&(r.setData(i),requestAnimationFrame(()=>{r.fit()})),r}}export{Rt as Markmap,ue as defaultColorFn,St as defaultOptions,wn as deriveOptions,Sn as globalCSS,wt as isMacintosh,Xn as loadCSS,Cn as loadJS,pn as refreshHook};
