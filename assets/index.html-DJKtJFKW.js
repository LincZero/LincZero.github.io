import{_ as c,c as u,a as s,e as a,d as t,b as e,w as r,r as i,o as d}from"./app-CcLagq2a.js";const k={},v={href:"https://marcus.se.net/obsidian-plugin-docs/user-interface/context-menus",target:"_blank",rel:"noopener noreferrer"},m={href:"https://docs.obsidian.md/Home",target:"_blank",rel:"noopener noreferrer"},b={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Plugin_2.html",target:"_blank",rel:"noopener noreferrer"},g={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Component.html#onload",target:"_blank",rel:"noopener noreferrer"},f={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Component.html#onunload",target:"_blank",rel:"noopener noreferrer"},w={href:"https://reactjs.org/",target:"_blank",rel:"noopener noreferrer"},y={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/views.html",target:"_blank",rel:"noopener noreferrer"},h={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/html-elements.html",target:"_blank",rel:"noopener noreferrer"},A={href:"https://svelte.dev/",target:"_blank",rel:"noopener noreferrer"},x={href:"https://svelte.dev/tutorial/basics",target:"_blank",rel:"noopener noreferrer"},q={href:"https://svelte.dev/docs",target:"_blank",rel:"noopener noreferrer"},V={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/getting-started/create-your-first-plugin.html",target:"_blank",rel:"noopener noreferrer"},E={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/html-elements.html",target:"_blank",rel:"noopener noreferrer"},P={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/ItemView.html",target:"_blank",rel:"noopener noreferrer"},z={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/getting-started/create-your-first-plugin.html#%E7%AC%AC%E5%9B%9B%E6%AD%A5-%E4%BF%AE%E6%94%B9%E6%8F%92%E4%BB%B6%E7%9A%84-manifest-%E9%85%8D%E7%BD%AE",target:"_blank",rel:"noopener noreferrer"},C={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/markdown-post-processing.html",target:"_blank",rel:"noopener noreferrer"},T={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/view-plugins.html",target:"_blank",rel:"noopener noreferrer"},M={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-fields.html",target:"_blank",rel:"noopener noreferrer"},X={href:"https://codemirror.net/docs/ref/#view.PluginValue",target:"_blank",rel:"noopener noreferrer"},S={href:"https://codemirror.net/docs/ref/#view.ViewPlugin%5EfromClass",target:"_blank",rel:"noopener noreferrer"},K={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/",target:"_blank",rel:"noopener noreferrer"},L={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Editor.html",target:"_blank",rel:"noopener noreferrer"},j={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/commands.html#editor-commands",target:"_blank",rel:"noopener noreferrer"},B={href:"https://codemirror.net/",target:"_blank",rel:"noopener noreferrer"},W={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Editor.html#replacerange",target:"_blank",rel:"noopener noreferrer"},U={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Editor.html#replaceselection",target:"_blank",rel:"noopener noreferrer"},O={href:"https://mermaid-js.github.io/",target:"_blank",rel:"noopener noreferrer"},F={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/html-elements.html",target:"_blank",rel:"noopener noreferrer"},N={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/MarkdownRenderChild.html",target:"_blank",rel:"noopener noreferrer"},I={href:"https://mermaid-js.github.io/",target:"_blank",rel:"noopener noreferrer"},Z={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Plugin_2.html#registermarkdowncodeblockprocessor",target:"_blank",rel:"noopener noreferrer"},R={href:"https://codemirror.net/docs/",target:"_blank",rel:"noopener noreferrer"},D={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/markdown-post-processing.html",target:"_blank",rel:"noopener noreferrer"},H={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Plugin_2.html#registereditorextension",target:"_blank",rel:"noopener noreferrer"},Y={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/view-plugins.html",target:"_blank",rel:"noopener noreferrer"},Q={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-fields.html",target:"_blank",rel:"noopener noreferrer"},G={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/MarkdownView.html",target:"_blank",rel:"noopener noreferrer"},J={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/view-plugins.html",target:"_blank",rel:"noopener noreferrer"},$={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-fields.html#dispatching-state-effects",target:"_blank",rel:"noopener noreferrer"},_={href:"https://codemirror.net/docs/guide/#state-and-updates",target:"_blank",rel:"noopener noreferrer"},nn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/",target:"_blank",rel:"noopener noreferrer"},sn={href:"https://codemirror.net/docs/guide/#state-fields",target:"_blank",rel:"noopener noreferrer"},an={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-management.html",target:"_blank",rel:"noopener noreferrer"},tn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-management.html",target:"_blank",rel:"noopener noreferrer"},pn={href:"https://codemirror.net/examples/million/",target:"_blank",rel:"noopener noreferrer"},en={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/view-plugins.html",target:"_blank",rel:"noopener noreferrer"},on={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/viewport.html",target:"_blank",rel:"noopener noreferrer"},ln={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/viewport.html",target:"_blank",rel:"noopener noreferrer"},cn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/",target:"_blank",rel:"noopener noreferrer"},un={href:"https://codemirror.net/docs/guide/#affecting-the-view",target:"_blank",rel:"noopener noreferrer"},rn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-fields.html",target:"_blank",rel:"noopener noreferrer"},dn={href:"https://codemirror.net/docs/ref/#view.PluginValue",target:"_blank",rel:"noopener noreferrer"},kn={href:"https://codemirror.net/docs/ref/#view.ViewPlugin%5EfromClass",target:"_blank",rel:"noopener noreferrer"},vn={href:"https://codemirror.net/docs/ref/#language.syntaxTree",target:"_blank",rel:"noopener noreferrer"},mn={href:"https://codemirror.net/docs/ref/#view.Decoration%5Ereplace",target:"_blank",rel:"noopener noreferrer"},bn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/state-fields.html#defining-a-state-field",target:"_blank",rel:"noopener noreferrer"},gn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/extensions/view-plugins.html#creating-a-view-plugin",target:"_blank",rel:"noopener noreferrer"},fn={href:"https://marcus.se.net/obsidian-plugin-docs/user-interface/settings",target:"_blank",rel:"noopener noreferrer"},wn={href:"https://lucide.dev/",target:"_blank",rel:"noopener noreferrer"},yn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Modal.html#open",target:"_blank",rel:"noopener noreferrer"},hn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/SuggestModal.html",target:"_blank",rel:"noopener noreferrer"},An={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/ItemView.html",target:"_blank",rel:"noopener noreferrer"},xn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Plugin_2.html#registerview",target:"_blank",rel:"noopener noreferrer"},qn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/ribbon-actions.html",target:"_blank",rel:"noopener noreferrer"},Vn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/commands.html",target:"_blank",rel:"noopener noreferrer"},En={href:"https://en.wikipedia.org/wiki/Tree_(data_structure)",target:"_blank",rel:"noopener noreferrer"},Pn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceItem.html",target:"_blank",rel:"noopener noreferrer"},zn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceParent.html",target:"_blank",rel:"noopener noreferrer"},Cn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceLeaf.html",target:"_blank",rel:"noopener noreferrer"},Tn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceSplit.html",target:"_blank",rel:"noopener noreferrer"},Mn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceTabs.html",target:"_blank",rel:"noopener noreferrer"},Xn={href:"https://help.obsidian.md/Plugins/Graph+view",target:"_blank",rel:"noopener noreferrer"},Sn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/App.html",target:"_blank",rel:"noopener noreferrer"},Kn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/user-interface/views.html",target:"_blank",rel:"noopener noreferrer"},Ln={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html",target:"_blank",rel:"noopener noreferrer"},jn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html#getleaf",target:"_blank",rel:"noopener noreferrer"},Bn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html#getleftleaf",target:"_blank",rel:"noopener noreferrer"},Wn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html#getrightleaf",target:"_blank",rel:"noopener noreferrer"},Un={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html#createleafinparent",target:"_blank",rel:"noopener noreferrer"},On={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceLeaf.html#detach",target:"_blank",rel:"noopener noreferrer"},Fn={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/Workspace.html#detachleavesoftype",target:"_blank",rel:"noopener noreferrer"},Nn={href:"https://help.obsidian.md/User+interface/Workspace/Panes/Linked+pane",target:"_blank",rel:"noopener noreferrer"},In={href:"https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/WorkspaceLeaf.html#setgroup",target:"_blank",rel:"noopener noreferrer"};function Zn(Rn,n){const p=i("ExternalLinkIcon"),o=i("Mermaid"),l=i("RouteLink");return d(),u("div",null,[n[300]||(n[300]=s("h1",{id:"readme",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#readme"},[s("span",null,"README")])],-1)),n[301]||(n[301]=s("p",null,"主参考：",-1)),s("ul",null,[s("li",null,[n[5]||(n[5]=a("API文档 （刚开始找来找去找不到，官网好像没文档。后来在论坛找到了，但应该不是官方弄的） ")),s("ul",null,[n[4]||(n[4]=s("li",null,"开发者文档：https://marcus.se.net/obsidian-plugin-docs/",-1)),s("li",null,[n[1]||(n[1]=s("mark",null,"中文社区网友的翻译",-1)),n[2]||(n[2]=a("：https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/（文档） https://forum-zh.obsidian.md/t/topic/9352/2（论坛） 翻译自 ")),s("a",v,[n[0]||(n[0]=a("这篇文章")),t(p)]),n[3]||(n[3]=a(" / https://marcus.se.net/obsidian-plugin-docs/vault （只翻译了一部分，看原文很有必要。像Vault这种东西翻译版就没有）"))])])])]),s("p",null,[n[7]||(n[7]=a("（202407补充：后来我又看了下，似乎补充了不少内容。想看比较新的可以去看那个。并且文档迁移到了")),s("a",m,[n[6]||(n[6]=a("新地址")),t(p)]),n[8]||(n[8]=a("，旧文档不再维护，不过这个新地址不提供中文翻译就是了……）"))]),n[302]||(n[302]=e('<h2 id="开发文档" tabindex="-1"><a class="header-anchor" href="#开发文档"><span>开发文档</span></a></h2><h3 id="重载插件" tabindex="-1"><a class="header-anchor" href="#重载插件"><span>重载插件</span></a></h3><p>一般要编译成js，然后移动到插件目录，再重载插件</p><p>也可以热重载：Hot-Reload 插件</p><h3 id="插件剖析" tabindex="-1"><a class="header-anchor" href="#插件剖析"><span>插件剖析</span></a></h3>',5)),s("p",null,[s("a",b,[n[9]||(n[9]=s("code",null,"Plugin",-1)),t(p)]),n[10]||(n[10]=a(" 类中定义了插件的生命周期，并且将操作暴露给其他插件："))]),n[303]||(n[303]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 配置插件所需的资源</span>
    <span class="token comment">// 不过有时我看到其他插件写的是：override async onload(): Promise&lt;void&gt; {}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 释放插件配置的任何资源</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="插件生命周期、控制台打印" tabindex="-1"><a class="header-anchor" href="#插件生命周期、控制台打印"><span>插件生命周期、控制台打印</span></a></h3>`,2)),s("p",null,[s("a",g,[n[11]||(n[11]=s("code",null,"onload()",-1)),t(p)]),n[12]||(n[12]=a(" 生命周期函数在用户激活 Obsidian 插件时触发。这将是您设置插件大部分功能的地方。"))]),s("p",null,[s("a",f,[n[13]||(n[13]=s("code",null,"onunload()",-1)),t(p)]),n[14]||(n[14]=a(" 生命周期函数在插件被禁用时触发。插件所调用的任何资源必须在这里得到释放，以防止在您的插件被禁用后对 Obsidian 的性能产生影响。"))]),n[304]||(n[304]=e(`<p>为了更好的理解这些方法会在何时被调用，当插件被加载或者被卸载时，您可以在控制台中打印一条消息。控制台是个很有用的工具，可以让开发者们监控他们代码的状态。</p><p>要想打开控制台:</p><ol><li>通过在 Windows 和 Linux 系统中按下组合键 Ctrl+Shift+I，或者在 macOS 系统中按下组合键 Cmd-Option-I 的方式打开或关闭开发者工具。</li><li>在开发者工具的窗口中点击 Console 标签打开控制台。</li></ol><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// highlight-next-line</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;loading plugin&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">async</span> <span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// highlight-next-line</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;unloading plugin&#39;</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="react" tabindex="-1"><a class="header-anchor" href="#react"><span>React</span></a></h3>`,5)),s("p",null,[n[17]||(n[17]=a("在本指南中，您将配置您的插件以使用 ")),s("a",w,[n[15]||(n[15]=a("React")),t(p)]),n[18]||(n[18]=a("。假设您已经拥有一个使用 ")),s("a",y,[n[16]||(n[16]=a("custom view")),t(p)]),n[19]||(n[19]=a(" 的插件，并且想使用 React 来改写它。"))]),n[305]||(n[305]=s("p",null,"虽然您并不需要使用单独的框架来开发一个插件，以下是您想使用 React 的几点原因：",-1)),s("ul",null,[n[23]||(n[23]=s("li",null,"您有使用 React 的经验，并且想使用熟悉的技术。",-1)),n[24]||(n[24]=s("li",null,"您想在插件中重复使用现有的 React 组件。",-1)),s("li",null,[n[21]||(n[21]=a("您的插件需要复杂的状态管理，或者有使用常规 ")),s("a",h,[n[20]||(n[20]=a("HTML element")),t(p)]),n[22]||(n[22]=a(" 无法实现的其他功能。"))])]),n[306]||(n[306]=e(`<h4 id="配置您的插件" tabindex="-1"><a class="header-anchor" href="#配置您的插件"><span>配置您的插件</span></a></h4><ol><li>将 React 添加到依赖中:<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> react react-dom
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>添加 React 的类型声明:<div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev @types/react @types/react-dom
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li>在 <code>tsconfig.json</code> 的 <code>compilerOptions</code> 对象中开启 JSX 支持： tsconfig.json<div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token punctuation">{</span>
  <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;jsx&quot;</span><span class="token operator">:</span> <span class="token string">&quot;react&quot;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h4 id="创建react组件" tabindex="-1"><a class="header-anchor" href="#创建react组件"><span>创建React组件</span></a></h4><p>……</p><h3 id="svelte" tabindex="-1"><a class="header-anchor" href="#svelte"><span>Svelte</span></a></h3>`,5)),s("p",null,[n[26]||(n[26]=a("该指南解释了如何配置您的插件以使用 ")),s("a",A,[n[25]||(n[25]=a("Svelte")),t(p)]),n[27]||(n[27]=a(", 一个")),n[28]||(n[28]=s("strong",null,"轻量级",-1)),n[29]||(n[29]=a("的可用于替换诸如 React 以及 Vue 这些的框架。"))]),n[307]||(n[307]=s("p",null,"Svelte 是围绕一个可以预编译您的代码为普通 Javascript 的编辑器构建的，这意味着在运行时不需要加载任何类库。这也意味着不需要使用虚拟 DOM 去追踪状态的变化，允许您的插件以最小的额外开销运行。",-1)),s("p",null,[n[32]||(n[32]=a("如果您想学习到更多关于 Svelte 的只是，以及如何去使用它，可以查阅 ")),s("a",x,[n[30]||(n[30]=a("tutorial")),t(p)]),n[33]||(n[33]=a(" 以及 ")),s("a",q,[n[31]||(n[31]=a("documentation")),t(p)]),n[34]||(n[34]=a(" 这两篇文档。"))]),s("p",null,[n[36]||(n[36]=a("本指南假定您已经阅读完")),s("a",V,[n[35]||(n[35]=a("创建您的第一个插件")),t(p)]),n[37]||(n[37]=a(" 这篇文档。"))]),n[308]||(n[308]=e(`<h4 id="配置您的插件-1" tabindex="-1"><a class="header-anchor" href="#配置您的插件-1"><span>配置您的插件</span></a></h4><p>要想构建一个 Svelte 应用，您需要去安装依赖以及配置您的插件以编译使用 Svelte 编写的代码。</p><ol><li><p>将 Svelte 添加到您插件的依赖中：</p><p>npm</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> --save-dev svelte svelte-preprocess @tsconfig/svelte esbuild-svelte
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>yarn</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">yarn</span> <span class="token function">add</span> <span class="token parameter variable">--dev</span> svelte svelte-preprocess @tsconfig/svelte esbuild-svelte
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>修改 <code>tsconfig.json</code> 文件以为常见的 Svelte 问题启用额外的类型检查。<code>types</code> 属性非常关键，它可以让 Typescript 识别出 <code>.svelte</code> 文件。 并将<code>inlineSourceMap</code>内容从 <code>tsconfig.json</code> 中移除，该配置与 Svelte 的配置相冲突。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token punctuation">{</span>
    <span class="token string-property property">&quot;extends&quot;</span><span class="token operator">:</span> <span class="token string">&quot;@tsconfig/svelte/tsconfig.json&quot;</span><span class="token punctuation">,</span>	<span class="token comment">// 增加</span>
        <span class="token string-property property">&quot;compilerOptions&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
            <span class="token string-property property">&quot;types&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;svelte&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;node&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>			<span class="token comment">// 增加</span>
            <span class="token comment">// &quot;inlineSourceMap&quot;: true,				// 去除</span>
        <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>在 <code>esbuild.config.mjs</code> 文件中引入以下内容：（Import和将 Svelte 添加到插件列表中）</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>
<span class="token keyword">import</span> esbuildSvelte <span class="token keyword">from</span> <span class="token string">&quot;esbuild-svelte&quot;</span><span class="token punctuation">;</span>			<span class="token comment">// 增加</span>
<span class="token keyword">import</span> sveltePreprocess <span class="token keyword">from</span> <span class="token string">&quot;svelte-preprocess&quot;</span><span class="token punctuation">;</span>	<span class="token comment">// 增加</span>

esbuild<span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">plugins</span><span class="token operator">:</span> <span class="token punctuation">[</span>										<span class="token comment">// 增加</span>
        <span class="token function">esbuildSvelte</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
            <span class="token literal-property property">compilerOptions</span><span class="token operator">:</span> <span class="token punctuation">{</span> <span class="token literal-property property">css</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
            <span class="token literal-property property">preprocess</span><span class="token operator">:</span> <span class="token function">sveltePreprocess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token operator">...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> process<span class="token punctuation">.</span><span class="token function">exit</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h4 id="创建并加载一个-svelte-组件" tabindex="-1"><a class="header-anchor" href="#创建并加载一个-svelte-组件"><span>创建并加载一个 Svelte 组件</span></a></h4><p>在插件的根目录下，创建一个名为 <code>Component.svelte</code> 的新文件</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ts<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  export let variable: number;
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>number<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  </span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">My number is </span><span class="token punctuation">{</span>variable<span class="token punctuation">}</span><span class="token plain-text">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>span</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">&gt;</span></span><span class="token plain-text">
  .number {
    color: red;
  }
</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">&gt;</span></span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,6)),s("p",null,[n[40]||(n[40]=a("要想使用 Svelte 组件，需要在一个即存的 ")),s("a",E,[n[38]||(n[38]=a("HTML element")),t(p)]),n[41]||(n[41]=a(". 中加载它。比如，如果在 Obsidian 的自定义 ")),s("a",P,[n[39]||(n[39]=s("code",null,"ItemView",-1)),t(p)]),n[42]||(n[42]=a(" 中进行加载："))]),n[309]||(n[309]=e(`<div class="ab-note drop-shadow"><div class="markdown-rendered"><div><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ItemView<span class="token punctuation">,</span> WorkspaceLeaf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Component <span class="token keyword">from</span> <span class="token string">&quot;./Component.svelte&quot;</span><span class="token punctuation">;</span>			<span class="token comment">// Svelte 组件文件</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span> <span class="token operator">=</span> <span class="token string">&quot;example-view&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ExampleView</span> <span class="token keyword">extends</span> <span class="token class-name">ItemView</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">component</span><span class="token operator">:</span> Component<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">leaf</span><span class="token operator">:</span> WorkspaceLeaf</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>leaf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getViewType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getDisplayText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Example view&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>component <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Component</span><span class="token punctuation">(</span><span class="token punctuation">{</span>				<span class="token comment">// 创建组件</span>
      <span class="token literal-property property">target</span><span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>contentEl<span class="token punctuation">,</span>							<span class="token comment">// 需要创建在哪</span>
      <span class="token literal-property property">props</span><span class="token operator">:</span> <span class="token punctuation">{</span>											<span class="token comment">// 组件参数</span>
        <span class="token literal-property property">variable</span><span class="token operator">:</span> <span class="token number">1</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>component<span class="token punctuation">.</span><span class="token function">$destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>						<span class="token comment">// 销毁组件</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div></div><h3 id="vue" tabindex="-1"><a class="header-anchor" href="#vue"><span>Vue</span></a></h3><p>文档的该节内容是新增的，Vue弄起来也有点麻烦</p><h4 id="第一步-下载插件开发模板" tabindex="-1"><a class="header-anchor" href="#第一步-下载插件开发模板"><span>第一步：下载插件开发模板</span></a></h4><p>……</p><p>载到本地。</p><ol><li><p>跳转到您刚才创建的代码仓库。</p></li><li><p>点击 <strong>Code</strong> ，并复制代码仓库地址。</p></li><li><p>打开终端，进入您本地 Obsidian 仓库插件所在的文件夹。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> path/to/vault/.obsidian/plugins
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>将源码下载到该文件夹下。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">git</span> clone https://github.com/your-username/obsidian-instant-coffee.git
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h4 id="第二步-安装依赖" tabindex="-1"><a class="header-anchor" href="#第二步-安装依赖"><span>第二步：安装依赖</span></a></h4><ol><li><p>打开终端，进入您的插件文件夹。</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token builtin class-name">cd</span> path/to/vault/.obsidian/plugins/obsidian-instant-coffee
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li><li><p>安装依赖。</p><p>npm</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>yarn</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> <span class="token parameter variable">-D</span> naive-ui
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></li></ol><h4 id="第三步-修改插件的-manifest-配置" tabindex="-1"><a class="header-anchor" href="#第三步-修改插件的-manifest-配置"><span>第三步：修改插件的 manifest 配置</span></a></h4>`,10)),s("p",null,[n[44]||(n[44]=a("可以参照 ")),s("a",z,[n[43]||(n[43]=a("创建您的第一个插件 - 修改插件的 manifest 配置")),t(p)]),n[45]||(n[45]=a(" 。"))]),n[310]||(n[310]=e('<h4 id="第四步-查看-src-文件夹" tabindex="-1"><a class="header-anchor" href="#第四步-查看-src-文件夹"><span>第四步：查看 <code>src</code> 文件夹</span></a></h4><h4 id="第五步-编写-vue-组件" tabindex="-1"><a class="header-anchor" href="#第五步-编写-vue-组件"><span>第五步：编写 Vue 组件</span></a></h4><h4 id="第六步-挂载-vue-组件" tabindex="-1"><a class="header-anchor" href="#第六步-挂载-vue-组件"><span>第六步：挂载 Vue 组件</span></a></h4><h4 id="第七步-编译" tabindex="-1"><a class="header-anchor" href="#第七步-编译"><span>第七步：编译</span></a></h4><h2 id="编辑器接口" tabindex="-1"><a class="header-anchor" href="#编辑器接口"><span>编辑器接口</span></a></h2><h3 id="【总结】" tabindex="-1"><a class="header-anchor" href="#【总结】"><span>【总结】</span></a></h3><p>不同的扩展 %LT</p>',7)),s("ul",null,[s("li",null,[n[53]||(n[53]=a("Markdown后处理 ")),s("ul",null,[n[51]||(n[51]=s("li",null,[a("使用方法："),s("code",null,"registerMarkdownPostProcessor()")],-1)),n[52]||(n[52]=s("li",null,[a("运行次序："),s("strong",null,[a("在 Markdown 被处理成 HTML "),s("mark",null,"之后"),a(" 运行")])],-1)),s("li",null,[n[47]||(n[47]=a("使用场景：如果您想改变")),n[48]||(n[48]=s("strong",null,"阅读视图下如何将 Markdown 转换为 HTML",-1)),n[49]||(n[49]=a("，可以考虑构建一个 ")),s("a",C,[n[46]||(n[46]=a("Markdown post processor")),t(p)]),n[50]||(n[50]=a("（Markdown后处理器）"))])])]),s("li",null,[n[61]||(n[61]=a("编辑器扩展 ")),s("ul",null,[n[60]||(n[60]=s("li",null,[a("使用方法："),s("code",null,"registerEditorExtension()")],-1)),s("li",null,[n[56]||(n[56]=a("使用场景：如果您想改变")),n[57]||(n[57]=s("strong",null,"文档在实时预览时的外观和感觉",-1)),n[58]||(n[58]=a("，您需要构建一个编辑器扩展。包含 ")),s("a",T,[n[54]||(n[54]=a("View plugins")),t(p)]),n[59]||(n[59]=a(" 以及 ")),s("a",M,[n[55]||(n[55]=a("State fields")),t(p)])])])]),s("li",null,[n[68]||(n[68]=a("视图插件（")),n[69]||(n[69]=s("code",null,"CodeMirror",-1)),n[70]||(n[70]=a("相关） ")),s("ul",null,[s("li",null,[n[64]||(n[64]=a("使用方法：需要创建一个继承自 ")),s("a",X,[n[62]||(n[62]=s("code",null,"PluginValue",-1)),t(p)]),n[65]||(n[65]=a(" 的类，并将它传给 ")),s("a",S,[n[63]||(n[63]=s("code",null,"ViewPlugin.fromClass()",-1)),t(p)]),n[66]||(n[66]=a(" 方法"))]),n[67]||(n[67]=s("li",null,[a("运行次序："),s("strong",null,[a("在视窗被重新计算 "),s("mark",null,"之后"),a(" 运行")])],-1))])]),s("li",null,[n[75]||(n[75]=a("状态字段 ")),s("ul",null,[n[74]||(n[74]=s("li",null,[a("使用方法："),s("code",null,"StateEffect "),a("与"),s("code",null,"StateField")],-1)),s("li",null,[n[72]||(n[72]=a("使用场景：让您管理自定义编辑器状态的 ")),s("a",K,[n[71]||(n[71]=a("编辑器扩展")),t(p)]),n[73]||(n[73]=a("（不是很懂）"))])])])]),n[311]||(n[311]=e(`<p>其他辅助手段</p><ul><li>状态管理</li></ul><h3 id="编辑器-editor" tabindex="-1"><a class="header-anchor" href="#编辑器-editor"><span>编辑器 <code>Editor</code></span></a></h3><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">;</span>			  <span class="token comment">// 注意这里的this不能为plugin_this。view的类型分别Any和View|null</span>
<span class="token keyword">const</span> cursor <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="编辑器" tabindex="-1"><a class="header-anchor" href="#编辑器"><span>编辑器</span></a></h4>`,5)),s("p",null,[s("a",L,[n[76]||(n[76]=s("code",null,"Editor",-1)),t(p)]),n[77]||(n[77]=a(" 类透出在编辑模式下读取以及操作 Markdown 文档的操作。"))]),s("p",null,[n[79]||(n[79]=a("如果您想在命令中访问编辑器，可以使用 ")),s("a",j,[n[78]||(n[78]=a("editorCallback")),t(p)]),n[80]||(n[80]=a("。"))]),n[312]||(n[312]=e(`<p>如果您想在其他地方使用编辑器，您可以通过 <code>view</code> 访问到它。</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// Make sure the user is editing a Markdown file.</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span>view<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// highlight-next-line</span>
  <span class="token keyword">const</span> cursor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// ...</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,2)),s("blockquote",null,[n[88]||(n[88]=s("p",null,"TIP",-1)),s("p",null,[n[82]||(n[82]=a("Obsidian 使用 ")),s("a",B,[n[81]||(n[81]=a("CodeMirror")),t(p)]),n[83]||(n[83]=a(" (CM) 作为底层文本编辑器，并且将 CodeMirror 作为 API 的一部分暴露出来。 ")),n[84]||(n[84]=s("code",null,"Editor",-1)),n[85]||(n[85]=a(" 作为CM5（桌面端）和 CM6（移动端）中的桥接功能而被抽象出来。使用 ")),n[86]||(n[86]=s("code",null,"Editor",-1)),n[87]||(n[87]=a(" 而不是直接访问 CodeMirror，那么您的插件就可以在两个平台上都可以运行。"))])]),n[313]||(n[313]=s("h4",{id:"在光标处插入文本",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#在光标处插入文本"},[s("span",null,"在光标处插入文本")])],-1)),s("p",null,[s("a",W,[n[89]||(n[89]=s("code",null,"replaceRange()",-1)),t(p)]),n[90]||(n[90]=a(" 方法用于替换选中的文本。如果您没有选中文本，那么文本将会在光标处被插入。"))]),n[314]||(n[314]=e(`<p>下例中的指令会将当前日期插入光标所在位置：</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Editor<span class="token punctuation">,</span> moment<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">&quot;insert-todays-date&quot;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Insert today&#39;s date&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// highlight-next-line</span>
        editor<span class="token punctuation">.</span><span class="token function">replaceRange</span><span class="token punctuation">(</span><span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">&quot;YYYY-MM-DD&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="替换当前选中的内容" tabindex="-1"><a class="header-anchor" href="#替换当前选中的内容"><span>替换当前选中的内容</span></a></h4>`,3)),s("p",null,[n[92]||(n[92]=a("如果您想编辑选中的文本，使用 ")),s("a",U,[n[91]||(n[91]=s("code",null,"replaceSelection()",-1)),t(p)]),n[93]||(n[93]=a(" 方法去替换选中的文本。"))]),n[315]||(n[315]=e(`<p>下例中的指令读取当前选中的内容并替换成大写：</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Editor<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">&quot;convert-to-uppercase&quot;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Convert to uppercase&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token comment">// highlight-start</span>
        <span class="token keyword">const</span> selection <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span>selection<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// highlight-end</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="markdown后处理-registermarkdownpostprocessor" tabindex="-1"><a class="header-anchor" href="#markdown后处理-registermarkdownpostprocessor"><span>Markdown后处理 <code>registerMarkdownPostProcessor()</code></span></a></h3><p>英语：这里的post有 在……之后 的意思</p><h4 id="markdown后处理" tabindex="-1"><a class="header-anchor" href="#markdown后处理"><span>Markdown后处理</span></a></h4>`,5)),s("p",null,[n[95]||(n[95]=a("您知道么，您可以通过类似以下文本创建 ")),n[96]||(n[96]=s("code",null,"mermaid",-1)),n[97]||(n[97]=a(" 代码块，以在在 Obsidian 中创建 ")),s("a",O,[n[94]||(n[94]=a("Mermaid")),t(p)]),n[98]||(n[98]=a(" 图表？"))]),s("p",null,[n[100]||(n[100]=a("如果您想要改变 Markdown 文档在")),n[101]||(n[101]=s("strong",null,"预览模式下",-1)),n[102]||(n[102]=a("的渲染方式，您可以添加自己的 ")),n[103]||(n[103]=s("strong",null,"Markdown 后处理器",-1)),n[104]||(n[104]=a("。 见名知意，该后处理器")),n[105]||(n[105]=s("strong",null,[a("在 Markdown 被处理成 HTML "),s("mark",null,"之后"),a(" 运行")],-1)),n[106]||(n[106]=a("。它可以让您添加，删除，或者替换渲染后的文档中的")),s("a",F,[n[99]||(n[99]=a("HTML 元素")),t(p)]),n[107]||(n[107]=a("。"))]),n[316]||(n[316]=e(`<p>区别 %%LT</p><ul><li>后处理器：<strong>在 Markdown 被处理成 HTML <mark>之后</mark> 运行</strong></li><li>视图插件：<strong>在视窗被重新计算 <mark>之后</mark> 运行</strong></li></ul><p>下例搜索包含在两个冒号 <code>:</code> 之间的内容，并将其替换为恰当的 emoji 表情：</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> Emoji <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./emoji&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// highlight-next-line</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerMarkdownPostProcessor</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">element<span class="token punctuation">,</span> context</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> codeblocks <span class="token operator">=</span> element<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> codeblocks<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> codeblock <span class="token operator">=</span> codeblocks<span class="token punctuation">.</span><span class="token function">item</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> text <span class="token operator">=</span> codeblock<span class="token punctuation">.</span>innerText<span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">const</span> isEmoji <span class="token operator">=</span> text<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;:&quot;</span> <span class="token operator">&amp;&amp;</span> text<span class="token punctuation">[</span>text<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string">&quot;:&quot;</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>isEmoji<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// highlight-next-line</span>
          context<span class="token punctuation">.</span><span class="token function">addChild</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Emoji</span><span class="token punctuation">(</span>codeblock<span class="token punctuation">,</span> text<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),s("p",null,[n[109]||(n[109]=s("code",null,"Emoji",-1)),n[110]||(n[110]=a(" 类继承自 ")),s("a",N,[n[108]||(n[108]=s("code",null,"MarkdownRenderChild",-1)),t(p)]),n[111]||(n[111]=a(", 并用带有表情符号的 ")),n[112]||(n[112]=s("code",null,"span",-1)),n[113]||(n[113]=a(" 元素替换代码块:"))]),n[317]||(n[317]=e(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> MarkdownRenderChild <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// highlight-next-line</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Emoji</span> <span class="token keyword">extends</span> <span class="token class-name">MarkdownRenderChild</span> <span class="token punctuation">{</span>
  <span class="token keyword">static</span> <span class="token constant">ALL_EMOJIS</span><span class="token operator">:</span> Record<span class="token operator">&lt;</span>string<span class="token punctuation">,</span> string<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token string-property property">&quot;:+1:&quot;</span><span class="token operator">:</span> <span class="token string">&quot;👍&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;:sunglasses:&quot;</span><span class="token operator">:</span> <span class="token string">&quot;😎&quot;</span><span class="token punctuation">,</span>
    <span class="token string-property property">&quot;:smile:&quot;</span><span class="token operator">:</span> <span class="token string">&quot;😄&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

  <span class="token literal-property property">text</span><span class="token operator">:</span> string<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">containerEl</span><span class="token operator">:</span> HTMLElement<span class="token punctuation">,</span> <span class="token literal-property property">text</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>containerEl<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>text <span class="token operator">=</span> text<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// highlight-start</span>
    <span class="token keyword">const</span> emojiEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerEl<span class="token punctuation">.</span><span class="token function">createSpan</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">text</span><span class="token operator">:</span> Emoji<span class="token punctuation">.</span><span class="token constant">ALL_EMOJIS</span><span class="token punctuation">[</span><span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">]</span> <span class="token operator">??</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>containerEl<span class="token punctuation">.</span><span class="token function">replaceWith</span><span class="token punctuation">(</span>emojiEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// highlight-end</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="后处理-markdown-代码块" tabindex="-1"><a class="header-anchor" href="#后处理-markdown-代码块"><span>后处理 Markdown 代码块</span></a></h4>`,2)),s("p",null,[n[115]||(n[115]=a("您知道么，您可以通过类似以下文本创建 ")),n[116]||(n[116]=s("code",null,"mermaid",-1)),n[117]||(n[117]=a(" 代码块，以在在 Obsidian 中创建 ")),s("a",I,[n[114]||(n[114]=a("Mermaid")),t(p)]),n[118]||(n[118]=a(" 图表？"))]),n[318]||(n[318]=e('<div class="language-markdown line-numbers-mode" data-ext="md" data-title="md"><pre class="language-markdown"><code><span class="token code"><span class="token punctuation">```</span><span class="token code-language">mermaid</span>\n<span class="token code-block language-mermaid language-mermaid language-mermaid language-mermaid language-mermaid">flowchart LR\n    Start --&gt; Stop</span>\n<span class="token punctuation">```</span></span>\n</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>如果更改为预览模式，代码块中的文本变为下图：</p><p>【Mermaid效果】</p>',3)),s("p",null,[n[120]||(n[120]=a("如果您想添加自己的类似以下 Mermaid 的自定义代码块，您可以使用 ")),s("a",Z,[n[119]||(n[119]=s("code",null,"registerMarkdownCodeBlockProcessor",-1)),t(p)]),n[121]||(n[121]=a("。 以下示例")),n[122]||(n[122]=s("strong",null,"将包含 CSV 数据的代码块呈现为表格",-1))]),n[319]||(n[319]=e(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerMarkdownCodeBlockProcessor</span><span class="token punctuation">(</span><span class="token string">&quot;csv&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">source<span class="token punctuation">,</span> el<span class="token punctuation">,</span> ctx</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token comment">// registerMarkdownCodeBlockProcessor</span>
      <span class="token keyword">const</span> rows <span class="token operator">=</span> source<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;\\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">row</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> row<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">const</span> table <span class="token operator">=</span> el<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;table&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">const</span> body <span class="token operator">=</span> table<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;tbody&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> rows<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> cols <span class="token operator">=</span> rows<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&quot;,&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> row <span class="token operator">=</span> body<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;tr&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> cols<span class="token punctuation">.</span>length<span class="token punctuation">;</span> j<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          row<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;td&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> cols<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="codemirror相关" tabindex="-1"><a class="header-anchor" href="#codemirror相关"><span>CodeMirror相关</span></a></h2><p>学习顺序：</p><ul><li>状态管理</li><li>状态字段、视图插件</li><li>装饰</li></ul><h3 id="编辑器扩展-registereditorextension" tabindex="-1"><a class="header-anchor" href="#编辑器扩展-registereditorextension"><span>编辑器扩展 <code>registerEditorExtension()</code></span></a></h3><p>编辑器扩展可以让您自行改变在 Obsidian 中编辑文档的体验。本页解释了什么是编辑器扩展，以及在何时使用它们。</p><p><mark>Obsidian 中的 Markdown 编辑器底层使用的是 CodeMirror 6 (CM6)。</mark><mark>跟 Obsidian 一样，CM6 也有自己的插件，称之为 <strong>扩展（extensions）</strong>。</mark><mark>换句话说，Obsidian 的 <strong>编辑器扩展</strong> 和 <strong>CodeMirror 6 的扩展</strong> 是一回事。</mark></p>`,7)),s("p",null,[n[124]||(n[124]=a("构建编辑器扩展所用到的 API 有些不合常规，因此在您开始使用之前需要您对其架构有基本的认知。本篇文档旨在为您提供足够的背景信息以及实例以供您入门。如果您想要了解更多关于构建编辑器扩展的内容，可以查阅 ")),s("a",R,[n[123]||(n[123]=a("CodeMirror 6 documentation")),t(p)]),n[125]||(n[125]=a(" 这篇文档。"))]),n[320]||(n[320]=s("h4",{id:"我是否需要一个编辑器扩展",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#我是否需要一个编辑器扩展"},[s("span",null,"我是否需要一个编辑器扩展？")])],-1)),n[321]||(n[321]=s("p",null,"构建编辑器扩展可能会是个挑战，因此在您开始构建之前，您需要考虑是否真的需要它。",-1)),s("ul",null,[s("li",null,[n[127]||(n[127]=a("如果您想改变")),n[128]||(n[128]=s("strong",null,"阅读视图下如何将 Markdown 转换为 HTML",-1)),n[129]||(n[129]=a("，可以考虑构建一个 ")),s("a",D,[n[126]||(n[126]=a("Markdown post processor")),t(p)]),n[130]||(n[130]=a("（Markdown后处理器）。"))]),n[131]||(n[131]=s("li",null,[a("如果您想改变"),s("strong",null,"文档在实时预览时的外观和感觉"),a("，您需要构建一个编辑器扩展。")],-1))]),n[322]||(n[322]=s("h4",{id:"注册编辑器扩展",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#注册编辑器扩展"},[s("span",null,"注册编辑器扩展")])],-1)),n[323]||(n[323]=s("p",null,[a("CodeMirror 6 (CM6) 是使用 web 技术编辑代码的强大引擎。作为它的核心，编辑器本身具有最少的功能集。任何您期望在流行的编辑器上可以获得功能都可以作为 "),s("strong",null,"扩展"),a(" 供您挑选。尽管 Obsidian 附带了许多开箱即用的扩展，您依旧可以注册属于您自己的。")],-1)),s("p",null,[n[133]||(n[133]=a("要想注册一个编辑器扩展，需要在您的 Obsidian 插件的 ")),n[134]||(n[134]=s("code",null,"onload",-1)),n[135]||(n[135]=a(" 方法中使用 ")),s("a",H,[n[132]||(n[132]=a("registerEditorExtension")),t(p)]),n[136]||(n[136]=a("。"))]),n[324]||(n[324]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerEditorExtension</span><span class="token punctuation">(</span><span class="token punctuation">[</span>examplePlugin<span class="token punctuation">,</span> exampleField<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1)),s("p",null,[n[139]||(n[139]=a("尽管 CM6 支持多种扩展，但其中两个最常见的分别是 ")),s("a",Y,[n[137]||(n[137]=a("View plugins")),t(p)]),n[140]||(n[140]=a(" 以及 ")),s("a",Q,[n[138]||(n[138]=a("State fields")),t(p)]),n[141]||(n[141]=a("。"))]),n[325]||(n[325]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// 这TM又是个什么代码</span>
<span class="token keyword">import</span> DocCardList <span class="token keyword">from</span> <span class="token string">&#39;@theme/DocCardList&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>useCurrentSidebarCategory<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@docusaurus/theme-common&#39;</span><span class="token punctuation">;</span>

<span class="token operator">&lt;</span>DocCardList items<span class="token operator">=</span><span class="token punctuation">{</span><span class="token function">useCurrentSidebarCategory</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>items<span class="token punctuation">}</span><span class="token operator">/</span><span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="与编辑器扩展通信-editorview" tabindex="-1"><a class="header-anchor" href="#与编辑器扩展通信-editorview"><span>与编辑器扩展通信 <code>EditorView</code></span></a></h3>`,2)),s("p",null,[n[143]||(n[143]=a("您可以从 ")),s("a",G,[n[142]||(n[142]=a("Markdown 视图")),t(p)]),n[144]||(n[144]=a("中访问 CodeMirror 6 编辑器。 但是，由于 Obsidian API 实际上并未公开编辑器 （view.editor.cm会报错：Editor上不存在属性“cm”，因此您需要使用 ")),n[145]||(n[145]=s("code",null,"@ts-expect-error",-1)),n[146]||(n[146]=a(" 绕过 Typescript 的验证）"))]),n[326]||(n[326]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> EditorView <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// @ts-expect-error, not typed</span>
<span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView<span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="视图插件1" tabindex="-1"><a class="header-anchor" href="#视图插件1"><span>视图插件1</span></a></h4>`,2)),s("p",null,[n[148]||(n[148]=a("您可以通过 ")),n[149]||(n[149]=s("code",null,"EditorView.plugin()",-1)),n[150]||(n[150]=a(" 方法访问")),s("a",J,[n[147]||(n[147]=a("视图插件")),t(p)]),n[151]||(n[151]=a("实例。"))]),n[327]||(n[327]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">&quot;example-editor-command&quot;</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Example editor command&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token punctuation">,</span> view<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// @ts-expect-error, not typed</span>
    <span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView<span class="token punctuation">;</span>

    <span class="token keyword">const</span> plugin <span class="token operator">=</span> editorView<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>examplePlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span>plugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      plugin<span class="token punctuation">.</span><span class="token function">addPointerToSelection</span><span class="token punctuation">(</span>editorView<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="状态字段" tabindex="-1"><a class="header-anchor" href="#状态字段"><span>状态字段</span></a></h4>`,2)),s("p",null,[n[153]||(n[153]=a("您可以在编辑器视图内直接派发变动以及")),s("a",$,[n[152]||(n[152]=a("state effects")),t(p)]),n[154]||(n[154]=a("。"))]),n[328]||(n[328]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  id<span class="token operator">:</span> <span class="token string">&quot;example-editor-command&quot;</span><span class="token punctuation">,</span>
  name<span class="token operator">:</span> <span class="token string">&quot;Example editor command&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token punctuation">,</span> view<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// @ts-expect-error, not typed</span>
    <span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView<span class="token punctuation">;</span>

    editorView<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      effects<span class="token operator">:</span> <span class="token punctuation">[</span>
        <span class="token comment">// ...</span>
      <span class="token punctuation">]</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="状态管理" tabindex="-1"><a class="header-anchor" href="#状态管理"><span>状态管理</span></a></h3><h4 id="状态管理-view-dispatch" tabindex="-1"><a class="header-anchor" href="#状态管理-view-dispatch"><span>状态管理 <code>view.dispatch</code></span></a></h4><p>TIP</p>`,4)),s("blockquote",null,[s("p",null,[n[156]||(n[156]=a("本页旨在为 Obsidian 插件开发者们精炼 CodeMirror 6 官方文档。要想获取更多关于状态管理的详细信息，请查阅 ")),s("a",_,[n[155]||(n[155]=a("State and Updates")),t(p)]),n[157]||(n[157]=a(" 这篇文档。"))])]),n[329]||(n[329]=e(`<h4 id="状态变化" tabindex="-1"><a class="header-anchor" href="#状态变化"><span>状态变化</span></a></h4><p>在大部分的应用中，您可能会通过为一个属性或者变量分配一个新值的方式来更新状态。这样一来，原先的值就会永远丢失。</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">let</span> note <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
note <span class="token operator">=</span> <span class="token string">&quot;Heading&quot;</span>
note <span class="token operator">=</span> <span class="token string">&quot;# Heading&quot;</span>
note <span class="token operator">=</span> <span class="token string">&quot;## Heading&quot;</span> <span class="token comment">// How to undo this?</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>为了支持对用户工作区的类似撤销以及重置更改的功能，诸如 Obsidian 的应用会保留所有的历史改动。要撤回改动，您可以返回改动前的时间点。</p><p>在 TypeScript 中，您会得到这样的结果：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> changes<span class="token operator">:</span> ChangeSpec<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

changes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> from<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> insert<span class="token operator">:</span> <span class="token string">&quot;Heading&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
changes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> from<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> insert<span class="token operator">:</span> <span class="token string">&quot;# &quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
changes<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token punctuation">{</span> from<span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span> insert<span class="token operator">:</span> <span class="token string">&quot;#&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="举例-transactions" tabindex="-1"><a class="header-anchor" href="#举例-transactions"><span>举例 Transactions</span></a></h4><p>试想一个在按下双引号 <code>&quot;</code> 后会在选中文本前后加上该标点符号的功能。实现该功能的一种方式是：</p><ol><li>在选中的文本前添加 <code>&quot;</code>。</li><li>在选中的文本后添加 <code>&quot;</code>。</li></ol><p>注意这种实现包含了 <strong>两次</strong> 操作。如果您将这两个操作添加到了撤销历史记录中，那么用户将需要撤回 <strong>两次</strong>，每次撤回一个双引号。为了避免这个问题，是否可以将这两次改动合并成一次？</p><p>在编辑器扩展中，一组发生在一起的状态变化被称之为 <strong>transaction</strong>。</p><p>如果结合您到目前为止所学的知识，如果允许 transaction 只包含单个状态更改, 那么可以将状态视为 transaction 的 <em>历史</em>。</p><p>在编辑器扩展中，将所有这些功能放在一起来实现环绕特性，下面是你如何添加或分派事务到编辑器视图的方法:</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code>view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  changes<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token punctuation">{</span> from<span class="token operator">:</span> selectionStart<span class="token punctuation">,</span> insert<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&quot;</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">{</span> from<span class="token operator">:</span> selectionEnd<span class="token punctuation">,</span> insert<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">&quot;</span><span class="token template-punctuation string">\`</span></span> <span class="token punctuation">}</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="状态字段-statefield-ob" tabindex="-1"><a class="header-anchor" href="#状态字段-statefield-ob"><span>状态字段 <code>StateField</code> - OB</span></a></h3><h4 id="状态字段-1" tabindex="-1"><a class="header-anchor" href="#状态字段-1"><span>状态字段</span></a></h4><p>作用</p>`,17)),s("blockquote",null,[s("p",null,[n[159]||(n[159]=a("状态字段是一个可以让您管理自定义编辑器状态的 ")),s("a",nn,[n[158]||(n[158]=a("编辑器扩展")),t(p)]),n[160]||(n[160]=a("。此页面将引导您通过实现计算器扩展来构建状态字段。"))]),n[161]||(n[161]=s("p",null,"该计算器需要支持从当前状态中加减数字，并在您想要重新开始时重置状态。",-1)),n[162]||(n[162]=s("p",null,"在本页最后，您将会理解构建状态字段的基本概念。",-1))]),n[330]||(n[330]=s("p",null,"TIP",-1)),s("blockquote",null,[s("p",null,[n[164]||(n[164]=a("本页旨在为 Obsidian 插件开发者们精炼 CodeMirror 6 的官方文档。要想获取更多关于状态字段的详细信息，可以参考 ")),s("a",sn,[n[163]||(n[163]=a("State Fields")),t(p)]),n[165]||(n[165]=a(" 这篇文档"))])]),n[331]||(n[331]=s("h4",{id:"插件",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#插件"},[s("span",null,"插件")])],-1)),n[332]||(n[332]=s("p",null,"前置准备",-1)),s("ul",null,[s("li",null,[s("p",null,[n[167]||(n[167]=a("Basic understanding of ")),s("a",an,[n[166]||(n[166]=a("State management")),t(p)]),n[168]||(n[168]=a("."))])]),s("li",null,[s("p",null,[n[170]||(n[170]=a("对于 ")),s("a",tn,[n[169]||(n[169]=a("状态管理")),t(p)]),n[171]||(n[171]=a(" 有基本了解。"))])])]),n[333]||(n[333]=e(`<h4 id="定义状态效果-stateeffect" tabindex="-1"><a class="header-anchor" href="#定义状态效果-stateeffect"><span>定义状态效果 <code>StateEffect </code></span></a></h4><p>State effect 描述了您想要做出的状态变化。您可以将它们想象成 class 中的 方法。</p><p>在计算器的例子中，您需要为每个计算操作定义一个 state effect:</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">const</span> addEffect <span class="token operator">=</span> StateEffect<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">define</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 		<span class="token comment">// 加</span>
<span class="token keyword">const</span> subtractEffect <span class="token operator">=</span> StateEffect<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">define</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 减</span>
<span class="token keyword">const</span> resetEffect <span class="token operator">=</span> StateEffect<span class="token punctuation">.</span><span class="token function">define</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 				<span class="token comment">// 结果</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>&lt;&gt;</code> 之间的类型定义了 effect 的输入类型。比如您想要加或减的数字。Reset effect 不需要任何输入，因此您可以不用管它。</p><h4 id="定义状态字段-statefield" tabindex="-1"><a class="header-anchor" href="#定义状态字段-statefield"><span>定义状态字段 <code>StateField</code></span></a></h4><p>与预料相反的是，状态字段实际上并不 <strong>存储</strong> 状态。而是 <strong>管理</strong> 状态。状态字段获取当前状态，应用任何 state effects, 并返回新的状态。</p><p>状态字段包含根据 transaction 中的效果应用数学操作的计算器逻辑。一个 transaction 可以包含多个 effects, 比如两次相加，状态字段需要一个接一个的应用它们。</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">const</span> calculatorField <span class="token operator">=</span> StateField<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">define</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">create</span><span class="token punctuation">(</span>state<span class="token operator">:</span> EditorState<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">update</span><span class="token punctuation">(</span>oldState<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> transaction<span class="token operator">:</span> Transaction<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> newState <span class="token operator">=</span> oldState<span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> effect <span class="token keyword">of</span> transaction<span class="token punctuation">.</span>effects<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>effect<span class="token punctuation">.</span><span class="token keyword">is</span><span class="token punctuation">(</span>addEffect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newState <span class="token operator">+=</span> effect<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>effect<span class="token punctuation">.</span><span class="token keyword">is</span><span class="token punctuation">(</span>subtractEffect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newState <span class="token operator">-=</span> effect<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>effect<span class="token punctuation">.</span><span class="token keyword">is</span><span class="token punctuation">(</span>resetEffect<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        newState <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> newState<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><code>create</code> 方法返回计算器的初始值。</li><li><code>update</code> 包含应用 effects 的逻辑。</li><li><code>effect.is()</code> 使您可以在使用 effect 之前检查它的类型。</li></ul><h4 id="派发-view-dispatch" tabindex="-1"><a class="header-anchor" href="#派发-view-dispatch"><span>派发 <code>view.dispatch</code></span></a></h4><p>原型</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span>TransactionSpec<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">// 实例中可以是</span>
<span class="token keyword">let</span> <span class="token literal-property property">effects</span><span class="token operator">:</span> StateEffect<span class="token operator">&lt;</span>unknown<span class="token operator">&gt;</span><span class="token punctuation">[</span><span class="token punctuation">]</span>
view<span class="token punctuation">.</span><span class="token function">despatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>effects<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要想将 state effect 应用到一个状态字段中，您需要将它作为 transaction 的一部分派发到编辑器窗口。</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code>view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  effects<span class="token operator">:</span> <span class="token punctuation">[</span>addEffect<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>您甚至可以定义一组提供更熟悉的 API 的辅助函数:</p><div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">add</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">,</span> num<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    effects<span class="token operator">:</span> <span class="token punctuation">[</span>addEffect<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">subtract</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">,</span> num<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    effects<span class="token operator">:</span> <span class="token punctuation">[</span>subtractEffect<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">reset</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  view<span class="token punctuation">.</span><span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    effects<span class="token operator">:</span> <span class="token punctuation">[</span>resetEffect<span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="视图插件-pluginvalue-ob" tabindex="-1"><a class="header-anchor" href="#视图插件-pluginvalue-ob"><span>视图插件 <code>PluginValue</code> - OB</span></a></h3><h4 id="视窗-view" tabindex="-1"><a class="header-anchor" href="#视窗-view"><span>视窗 <code>View</code></span></a></h4><ul><li>ViewPort <ul><li><img src="data:image/jpeg;base64, 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"></li></ul></li><li>State Field &amp; View Plugin <ul><li><img src="data:image/jpeg;base64, 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i/Iafiiv9SivJNNQXgGgWJTX8EN5rddR5XX/Hspr2bLuZa42AABFarW8rlnGpbLKloP7KK9aR5VX+VYn30onxSWtnxYprwCQTKvlld9ili9pfeEP5TUHrZZXceTNEbNjc8VsWD32K2tZ6ZvWVEhOWb100KxfWTFb1ldS+0lRUF4BIJlWy6vYt3uoekxfs/ytArVh1ejYSjKPvNerl1aqY+n2TUOpfUGBoLzmIEl5RWeivAJAMknKKzoT5TUHlFdYlFcASIbyCovymgPKKyzKKwAkQ3mFRXnNAeUVFuUVAJKhvMKivOaA8gqL8goAyVBeYVFec0B5hUV5BYBkKK+wKK85KGN5ff3QsNm+qWK2rGsz6yupXQO1G1BeASCZMpZX+VKhbRsllbayc5tcSiqda6B2A8prDrIur4cPHzZTpkwxkyZNMrNmzardGk2Kq73eXVrZuXWoNnc0QnkFgGTKVl63b07/G7wosPFQXnOQZXmV4nr++eebyy7oMTdP7jGnvr3HrFy5snav347N2XzryBD9tSnKKwAkU6byOtCfzTdh7trOQBoH5TUHWZVXXVzXTR/LBWf3VG+Ts7A606ZNq01lzJb12ZTXgQF+YmyG8goAyaRVXuVbE32/undzcG90kTzel015lY/zoTnKaw6yKK+2uE6++B1m0a3vNgdmnVv979w73ufNpPdPMDNmzKhOS3ktDuUVAJJJs7z6xjA3lNfyorzmIO3y2tvbe7K4msUXNs0bz000l110upk6dWp1esprcSivAJAM5RUW5TUHaZXXnp6eak475W3myk+eMa6kDi+aaA4+dKbZdd87Tz7W5tJLL62erRWU1+JQXgEgGcorLMprDtIsr25hjUr1sREor8WhvAJAMpRXWJTXHORVXt0zr1Hk2qy+nabdUF6bo7wCQDJpldejb47EThTKa7EorznI+8zrYzeea84666zaVOPtfSX967yuX8kOFwflFQCSSau8pmFktNeuXpb+iaADe/jSnzgorznIq7wenn2O2XzPGdXHNbrW6/DoviGXAfHtOEmyZvmgeeN1zrrGQXkFgGTKVF7FoYPDZtWS9MZSGZcRD+U1B3meeZWzruedd15tisZOHB8xx/razFFKaysorwCQTNnKq5Av5/F93KDVHD/GWNoKymsO0iyvzTJhwoRYXxGLYlBeASCZMpZXFIPymoO0yivCR3kFgGQor7AorzmgvMKivAJAMpRXWJTXHFBeYVFeASAZyissymsOKK+wKK8AkAzlFRblNQeUV1iUVwBIhvIKi/KaA8orLMorACRDeYVFec0B5RUW5RUAkqG8wqK85mCZU17vuI7y2q02rXHK679TXgEgjtt/cKzu+LniRcprt7r39vptYe6T/bV7wlLq8rrRKSw3UFi61rJFg3Xbwu0/6KvdAwBo5Oe31heWeXPCLCxo3x3X1Z+Fl7E1RKUur3t2DdW9yZJKha+C60a/faK/bju49/bjtXsAAI38+t4TdcfP3/yK8tqt5LeWeluQ32qGqNTlte/ISN2bLNm4Osw3Gu25+z/rzxzMfvBE7R4AQCPP/6b+h/9bruE3V91oz87huu1Asn/PcO3esJS6vAq3tDx2P6Wl27zxOj/EAEBSO7fVfwRPsu+VMEsLknv+8fofYmZMDfeHmNKX1wVP17/Zkt/tY6frJr/5Zf2vvK656ogZGuLjIwAQ1/Rv1f+6+OGZnAjqJieOGfP9f3tr/UueeDjcj4+UvrweOjj+NPcjP2en6xa7e8d/7nnWL1j/ANCKOY+OPxG0fdNQ7V50uqcfG7/+d2wJd/2XvryKJx8Z/6bPf4oPnHe6viPD5ubv1p8tkLz2O868A0Ar5Hh67b/WH0unf7PPvH6I32J1Ork0ml7vkl/dE/YfPQdRXo++OWKuvWp8iVn0XJgX10Vzh18bMffMqP+8s+TpWfzQAgBJzH+q/trpkh/fdKz6G050plVLxhdXyb7dYa/zIMqrWL10/AfOJfJ5yL6j/OTYSTasrpjp36q/Fp1EyiwAILn77qj/hiWJXEN9/Sr+CLaTjIzWIvn2LHddSzrhxF8w5VXIN0H4VsS1V8lFlwfMgUAv+QBjKoPGrF9Z8R5YJVJmXz/E+gWAdsglKOVSWb7jrFw/e8NoiR3mo7DBkqvzLF0wYP7zO/513CmXmQyqvIrnZvsLrM2t3+szP7/1uHn03hPmN7/sJyXPgz85bn48/ZiZdqV/fUpu/m6f2d1LcQWANOzfPWRu+76/3EiumXLE/PTmY+ahmcfNU7/uJyWP/Ab6wR8fN3fdFL1OJY910B87B1dehe/Dx6QzI9/DLGcKAADp6R/tMQ+MFh7fcZd0Xjrtj9yDLK/iwN4h88jP6q//STon8jGBJfP5gzwAyNLShYPmh99ufMaOhBv5KMiOLZ33eeZgy6vVu2XI/PcDJ8xN3xx/NQISXuSPshY+O2CGKpxtBYA8DA+b6nHX/UZLEmbk6ky/vPt49e9IOlXw5VXr3TpU/UjBvDn95vFf9VdLLSl3nnms37w0d9CsXVExbx7mc60AUCT5g5+VSwbNgmcGzBMPn6j+hpOUO/I3PjKWvvjbAbNpTcUMdcEf3HVUeQUAAEBno7wCAAAgGJRXAAAABIPyCgAAgGBQXgEAABAMyisAAACCQXkFAABAMCivAAAACAblFQAAAMGgvAIAACAYlFcAAAAEg/IKAACAYFBeAQAAEAzKKwAAAIJBeQUAAEAwKK8AAAAIBuUVAAAAwaC8AgAAIBiUVwAAAASD8goAAIBgUF4BAAAQDMorAAAAgkF5BQAAQDAorwAAAAgG5RUAAADBoLwCAAAgGJRXAAAABIPyCgAAgGBQXgEAABAMyisAAACCQXkFAABAMCivAAAACIQx/x98Bcwf3QkIpAAAAABJRU5ErkJggg=="></li></ul></li></ul><p>该原理可以解释：</p><ul><li>为什么不能用CSS计数器实现标题计数</li><li>为什么块装饰需要使用StateField而不能用ViewPlugin</li></ul>`,22)),s("p",null,[n[173]||(n[173]=a("Obsidian 编辑器支持上万行的 ")),s("a",pn,[n[172]||(n[172]=a("庞大文件")),t(p)]),n[174]||(n[174]=a("。其中一个可能的原因是因为编辑器只渲染可见的（多一点点）的内容。"))]),n[334]||(n[334]=s("p",null,[a("试想下您想编辑一个内容多到一屏无法展示完整的大型文档。Obsidian 编辑器创建了一个可以在文档中移动的 “窗口”，只渲染在这个“窗口”里的内容（而忽略窗口以外的内容）。这个窗口被称之为编辑器的 "),s("strong",null,"视窗"),a("。")],-1)),n[335]||(n[335]=s("p",null,"无论何时当用户滚动浏览文档，或者是文档内容发生了变化，视图就会过期，需要重新计算。",-1)),s("p",null,[n[176]||(n[176]=a("如果您想构建一个基于视图的编辑器扩展，可以查阅")),s("a",en,[n[175]||(n[175]=a("视图插件")),t(p)]),n[177]||(n[177]=a("这篇文档。"))]),n[336]||(n[336]=s("h4",{id:"视图插件2",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#视图插件2"},[s("span",null,"视图插件2")])],-1)),s("p",null,[n[179]||(n[179]=a("前置准备：对")),s("a",on,[n[178]||(n[178]=a("视窗")),t(p)]),n[180]||(n[180]=a("有基本了解。"))]),s("p",null,[n[183]||(n[183]=a("视图插件是一个可以让您访问编辑器")),s("a",ln,[n[181]||(n[181]=a("视窗")),t(p)]),n[184]||(n[184]=a("的")),s("a",cn,[n[182]||(n[182]=a("编辑器扩展")),t(p)]),n[185]||(n[185]=a("。"))]),n[337]||(n[337]=s("p",null,"% TIP",-1)),s("blockquote",null,[s("p",null,[n[187]||(n[187]=a("本页旨在为 Obsidian 插件开发者们精炼 CodeMirror 6 的官方文档。要想获取更多关于状态管理的详细信息，请查阅 ")),s("a",un,[n[186]||(n[186]=a("Affecting the View")),t(p)]),n[188]||(n[188]=a(" 这篇文档。"))])]),n[338]||(n[338]=e('<h4 id="创建一个视图插件" tabindex="-1"><a class="header-anchor" href="#创建一个视图插件"><span>创建一个视图插件</span></a></h4><p>视图插件是<strong>在视窗被重新计算<mark>后</mark>执行的编辑器扩展</strong>。这意味着它们可以访问视窗，这也意味着视图插件不能对视窗做出任何有巨大影响的改动。比如在文档中插入块或者换行符。</p><p>区别 %%LT</p><ul><li>后处理器：<strong>在 Markdown 被处理成 HTML <mark>之后</mark> 运行</strong></li><li>视图插件：<strong>在视窗被重新计算 <mark>之后</mark> 运行</strong></li></ul><p>TIP %%</p>',5)),s("blockquote",null,[s("p",null,[n[190]||(n[190]=a("如果您想做出影响编辑器垂直布局的变动，比如插入块或者换行符，您需要使用")),s("a",rn,[n[189]||(n[189]=a("状态字段")),t(p)]),n[191]||(n[191]=a("。"))])]),s("p",null,[n[194]||(n[194]=a("要想创建一个视图插件，需要创建一个继承自 ")),s("a",dn,[n[192]||(n[192]=a("PluginValue")),t(p)]),n[195]||(n[195]=a(" 的类，并将它传给 ")),s("a",kn,[n[193]||(n[193]=a("ViewPlugin.fromClass()")),t(p)]),n[196]||(n[196]=a(" 方法。"))]),n[339]||(n[339]=e(`<div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>
  ViewUpdate<span class="token punctuation">,</span>
  PluginValue<span class="token punctuation">,</span>
  EditorView<span class="token punctuation">,</span>
  ViewPlugin<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">implements</span> <span class="token class-name">PluginValue</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span>update<span class="token operator">:</span> ViewUpdate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>

  <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> examplePlugin <span class="token operator">=</span> ViewPlugin<span class="token punctuation">.</span><span class="token function">fromClass</span><span class="token punctuation">(</span>ExamplePlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>以下三个视图插件的方法控制它的生命周期：</p><ul><li><code>constructor()</code> 方法用于插件的初始化。</li><li><code>update()</code> 方法在发生改变时更新您的插件，比如在用户输入或者选择一些文本时。</li><li><code>destroy()</code> 方法在插件卸载后进行清理操作。</li></ul><p>虽然例子中的视图插件生效了，但是它做的事情并不多。如果您想更好地理解导致插件更新的原因，您可以在 <code>update()</code> 方法中添加 <code>console.log(update);</code> 这行代码以在控制台中打印所有的更新内容。</p><h3 id="装饰-decoration-ob" tabindex="-1"><a class="header-anchor" href="#装饰-decoration-ob"><span>装饰 <code>Decoration</code> - OB</span></a></h3><p><mark>（CM版的会详细一点，推荐看那个）</mark></p><p>先决条件</p><ul><li>基本了解 状态字段。</li><li>基本了解 视图插件。</li></ul><p>装饰让您控制在编辑器扩展中如何绘制或者展示内容。如果您打算通过在编辑器中添加，替换或者样式化标签来更改外观，您很可能需要使用装饰。</p><p>阅读完此指南后，您将会：</p><ul><li>理解如何使用装饰去改变编辑器的外观。</li><li>理解使用<strong>状态字段</strong>以及<strong>视图插件</strong>提供装饰之间的区别。</li></ul><h4 id="何时使用视图插件或者状态字段" tabindex="-1"><a class="header-anchor" href="#何时使用视图插件或者状态字段"><span>何时使用视图插件或者状态字段</span></a></h4><p>视图插件以及状态字段都可以为编辑器提供装饰，但是他们之间有些区别：</p><ul><li>如果您可以根据视图内部的内容决定装饰，此时可以使用视图插件。</li><li>如果您需要在视图外部管理装饰，此时可以使用状态字段。</li><li>如果您想做出可能改变视图内容的修改，比如添加分割线，此时可以使用状态字段。</li></ul><p>如果您可以使用任何一种方法来实现您的扩展, 那么视图插件往往能带来更好的性能。比如，试想下您打算实现一个用来检查文档拼写的编辑器扩展。</p><p>一种方法是将整个文档传递给外部拼写检查器，然后返回错误列表。在此情况下，不管当前视口中有什么，您需要将每条错误映射到装饰，并使用状态字段来管理装饰。</p><p>另一种方式是仅仅只检查展示在视口中的内容。在用户滚动浏览文档时，改扩展需要不断地执行拼写检查，但您可以拼写检查包含数百万行文本的文档。</p><h4 id="提供装饰" tabindex="-1"><a class="header-anchor" href="#提供装饰"><span>提供装饰</span></a></h4><p>想象一下，您想构建一个编辑器扩展，用表情符号替换项目符号列表项。 您可以使用视图插件或状态字段来完成此操作，但有一些区别。 在本节中，您将看到如何使用这两种类型的扩展来实现它。</p><p>两种实现共享相同的核心逻辑：</p>`,20)),s("ol",null,[s("li",null,[n[198]||(n[198]=a("使用 ")),s("a",vn,[n[197]||(n[197]=a("syntaxTree")),t(p)]),n[199]||(n[199]=a(" 查找列表项。"))]),n[200]||(n[200]=s("li",null,[a("将每个列表项的前导连字符 "),s("code",null,"-"),a(" 替换为小部件。")],-1))]),n[340]||(n[340]=e(`<h4 id="小部件-widgettype" tabindex="-1"><a class="header-anchor" href="#小部件-widgettype"><span>小部件 <code>WidgetType</code></span></a></h4><p>小部件是您添加到编辑器中的自定义 HTML 标签。您可以在文档中的特定位置插入一个小部件，或者用一个小部件替换一段内容。</p><p>下例中定义了一个返回 <code>&lt;span&gt;👉&lt;/span&gt;</code> HTML 标签的小部件。您将在稍后使用到它。</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> EditorView<span class="token punctuation">,</span> WidgetType <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">EmojiWidget</span> <span class="token keyword">extends</span> <span class="token class-name">WidgetType</span> <span class="token punctuation">{</span>
  <span class="token function">toDOM</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">)</span><span class="token operator">:</span> HTMLElement <span class="token punctuation">{</span>
    <span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;span&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    div<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;👉&quot;</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> div<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,4)),s("p",null,[n[202]||(n[202]=a("要想使用 emoji 小部件替换您文档中的一部分内容，可以使用")),s("a",mn,[n[201]||(n[201]=a("替换装饰")),t(p)]),n[203]||(n[203]=a("。"))]),n[341]||(n[341]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Decoration <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span>	<span class="token comment">// 这个居然被我蒙对了</span>

<span class="token keyword">const</span> decoration <span class="token operator">=</span> Decoration<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>	<span class="token comment">// replace方法不能换行</span>
  widget<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">EmojiWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="状态字段-2" tabindex="-1"><a class="header-anchor" href="#状态字段-2"><span>状态字段</span></a></h4><p>提供来自状态字段的装饰：</p>`,3)),s("ol",null,[s("li",null,[n[205]||(n[205]=a("使用 ")),n[206]||(n[206]=s("code",null,"DecorationSet",-1)),n[207]||(n[207]=a(" 类型")),s("a",bn,[n[204]||(n[204]=a("定义状态字段")),t(p)])]),n[208]||(n[208]=s("li",null,[a("将 "),s("code",null,"provide"),a(" 属性添加到状态字段中。")],-1))]),n[342]||(n[342]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token function">provide</span><span class="token punctuation">(</span>field<span class="token operator">:</span> StateField<span class="token operator">&lt;</span>DecorationSet<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> Extension <span class="token punctuation">{</span>
  <span class="token keyword">return</span> EditorView<span class="token punctuation">.</span>decorations<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>_</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> syntaxTree <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/language&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Extension<span class="token punctuation">,</span>
  RangeSetBuilder<span class="token punctuation">,</span>
  StateField<span class="token punctuation">,</span>
  Transaction<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/state&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Decoration<span class="token punctuation">,</span>
  DecorationSet<span class="token punctuation">,</span>
  EditorView<span class="token punctuation">,</span>
  WidgetType<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EmojiWidget <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;emoji&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> emojiListField <span class="token operator">=</span> StateField<span class="token punctuation">.</span><span class="token generic-function"><span class="token function">define</span><span class="token generic class-name"><span class="token operator">&lt;</span>DecorationSet<span class="token operator">&gt;</span></span></span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token function">create</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token operator">:</span> DecorationSet <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Decoration<span class="token punctuation">.</span>none<span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">update</span><span class="token punctuation">(</span>oldState<span class="token operator">:</span> DecorationSet<span class="token punctuation">,</span> transaction<span class="token operator">:</span> Transaction<span class="token punctuation">)</span><span class="token operator">:</span> DecorationSet <span class="token punctuation">{</span>
    <span class="token keyword">const</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RangeSetBuilder<span class="token operator">&lt;</span>Decoration<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token function">syntaxTree</span><span class="token punctuation">(</span>transaction<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token function">enter</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">// Position of the &#39;-&#39; or the &#39;*&#39;.</span>
          <span class="token keyword">const</span> listCharFrom <span class="token operator">=</span> node<span class="token punctuation">.</span>from <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>

          builder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
            listCharFrom<span class="token punctuation">,</span>
            listCharFrom <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
            Decoration<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
              widget<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">EmojiWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span>
          <span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token function">provide</span><span class="token punctuation">(</span>field<span class="token operator">:</span> StateField<span class="token operator">&lt;</span>DecorationSet<span class="token operator">&gt;</span><span class="token punctuation">)</span><span class="token operator">:</span> Extension <span class="token punctuation">{</span>
    <span class="token keyword">return</span> EditorView<span class="token punctuation">.</span>decorations<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span>field<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="视图插件" tabindex="-1"><a class="header-anchor" href="#视图插件"><span>视图插件</span></a></h4><p>To manage your decorations using a view plugin:</p><p>使用视图插件管理您的装饰：</p>`,6)),s("ol",null,[s("li",null,[s("a",gn,[n[209]||(n[209]=a("创建一个视图插件")),t(p)]),n[210]||(n[210]=a("."))]),n[211]||(n[211]=s("li",null,[a("在您的插件中添加 "),s("code",null,"DecorationSet"),a(" 成员属性。")],-1)),n[212]||(n[212]=s("li",null,[a("在 "),s("code",null,"constructor()"),a(" 方法中初始化装饰。")],-1)),n[213]||(n[213]=s("li",null,[a("在 "),s("code",null,"update()"),a(" 中重新构建装饰。")],-1))]),n[343]||(n[343]=e(`<p>以下示例仅在基础文档或视口更改时重建装饰。以下示例仅在基础文档或视口更改时重建装饰。</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> syntaxTree <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/language&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> RangeSetBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/state&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  Decoration<span class="token punctuation">,</span>
  DecorationSet<span class="token punctuation">,</span>
  EditorView<span class="token punctuation">,</span>
  PluginSpec<span class="token punctuation">,</span>
  PluginValue<span class="token punctuation">,</span>
  ViewPlugin<span class="token punctuation">,</span>
  ViewUpdate<span class="token punctuation">,</span>
  WidgetType<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;@codemirror/view&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> EmojiWidget <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;emoji&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">EmojiListPlugin</span> <span class="token keyword">implements</span> <span class="token class-name">PluginValue</span> <span class="token punctuation">{</span>
  decorations<span class="token operator">:</span> DecorationSet<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>decorations <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">buildDecorations</span><span class="token punctuation">(</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">update</span><span class="token punctuation">(</span>update<span class="token operator">:</span> ViewUpdate<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>update<span class="token punctuation">.</span>docChanged <span class="token operator">||</span> update<span class="token punctuation">.</span>viewportChanged<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>decorations <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">buildDecorations</span><span class="token punctuation">(</span>update<span class="token punctuation">.</span>view<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>

  <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

  <span class="token function">buildDecorations</span><span class="token punctuation">(</span>view<span class="token operator">:</span> EditorView<span class="token punctuation">)</span><span class="token operator">:</span> DecorationSet <span class="token punctuation">{</span>
    <span class="token keyword">const</span> builder <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RangeSetBuilder<span class="token operator">&lt;</span>Decoration<span class="token operator">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> <span class="token punctuation">{</span> from<span class="token punctuation">,</span> to <span class="token punctuation">}</span> <span class="token keyword">of</span> view<span class="token punctuation">.</span>visibleRanges<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">syntaxTree</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>state<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">iterate</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        from<span class="token punctuation">,</span>
        to<span class="token punctuation">,</span>
        <span class="token function">enter</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type<span class="token punctuation">.</span>name<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">&quot;list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// Position of the &#39;-&#39; or the &#39;*&#39;.</span>
            <span class="token keyword">const</span> listCharFrom <span class="token operator">=</span> node<span class="token punctuation">.</span>from <span class="token operator">-</span> <span class="token number">2</span><span class="token punctuation">;</span>

            builder<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>
              listCharFrom<span class="token punctuation">,</span>
              listCharFrom <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span>
              Decoration<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
                widget<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">EmojiWidget</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
              <span class="token punctuation">}</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">return</span> builder<span class="token punctuation">.</span><span class="token function">finish</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> pluginSpec<span class="token operator">:</span> PluginSpec<span class="token operator">&lt;</span>EmojiListPlugin<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">decorations</span><span class="token operator">:</span> <span class="token punctuation">(</span>value<span class="token operator">:</span> EmojiListPlugin<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> value<span class="token punctuation">.</span>decorations<span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> emojiListPlugin <span class="token operator">=</span> ViewPlugin<span class="token punctuation">.</span><span class="token function">fromClass</span><span class="token punctuation">(</span>
  EmojiListPlugin<span class="token punctuation">,</span>
  pluginSpec
<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>buildDecorations()</code> 是一个辅助方法，它基于编辑器视图构建一整套装饰。</p><p>注意传入 <code>ViewPlugin.fromClass()</code> 的第二个参数。<code>PluginSpec</code> 中的 <code>decorations</code> 属性指定视图插件如何向编辑器提供装饰。</p><p>由于视图插件知道什么对用户可见，因此您可以使用 <code>view.visibleRanges</code> 来限制要访问的语法树的哪些部分。</p><h2 id="用户界面接口" tabindex="-1"><a class="header-anchor" href="#用户界面接口"><span>用户界面接口</span></a></h2><h3 id="指令" tabindex="-1"><a class="header-anchor" href="#指令"><span>指令</span></a></h3><h3 id="快捷菜单" tabindex="-1"><a class="header-anchor" href="#快捷菜单"><span>快捷菜单</span></a></h3><p>多种菜单</p><ul><li><strong>右键菜单</strong>，通过<code>registerEvent</code>注册事件获取menu，使用<code>menu.addItem</code>方法</li><li><code>addRibbonIcon</code>，向<strong>功能区</strong>中添加一个项，并且可以展开子菜单</li><li>订阅 <code>file-menu</code> workspace 事件的方式，向<strong>文件菜单</strong>中添加一个菜单项</li><li>订阅 <code>editor-menu</code> workspace 事件的方式，向<strong>编辑菜单</strong>中添加一个菜单项</li></ul><h4 id="右键菜单" tabindex="-1"><a class="header-anchor" href="#右键菜单"><span>右键菜单</span></a></h4><p>这个文档里没有，我学习参考了Table Enhance的代码</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建右键菜单</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerEvent</span><span class="token punctuation">(</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;editor-menu&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>menu<span class="token operator">:</span> Menu<span class="token punctuation">,</span> editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleCreateTableGeneratorInMenu</span><span class="token punctuation">(</span>menu<span class="token punctuation">,</span> editor<span class="token punctuation">,</span> view<span class="token punctuation">)</span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建TG项，在右键菜单里</span>
<span class="token function">handleCreateTableGeneratorInMenu</span><span class="token punctuation">(</span>menu<span class="token operator">:</span> Menu<span class="token punctuation">,</span> editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    menu<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> itemDom <span class="token operator">=</span> <span class="token punctuation">(</span>item <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>dom <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>
        itemDom<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;type-enhance-menu&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        item
            <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Type Enhance&quot;</span><span class="token punctuation">)</span>
            <span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token string">&quot;table&quot;</span><span class="token punctuation">)</span>
        	<span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">createTableGeneratorMenu</span><span class="token punctuation">(</span>editor<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">showTableGeneratorView</span><span class="token punctuation">(</span>editor<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        	<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>另外还有段代码，但好像没什么用</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 在0.15.0等新版本中使用时，在多个窗口中处理相同的mouseevent</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">requireApiVersion</span><span class="token punctuation">(</span><span class="token string">&quot;0.15.0&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerTableGeneratorMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 注册TG菜单</span>
<span class="token function">registerTableGeneratorMenu</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;window-open&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>leaf<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>leaf<span class="token punctuation">.</span>doc<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">const</span> target <span class="token operator">=</span> evt<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl <span class="token operator">||</span> <span class="token operator">!</span>target<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;typora-enhance-menu&quot;</span><span class="token punctuation">)</span> 
                <span class="token operator">||</span> target<span class="token punctuation">.</span>parentElement<span class="token operator">?.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;typora-enhance-menu&quot;</span><span class="token punctuation">)</span> 
                <span class="token operator">||</span> target<span class="token punctuation">.</span>tagName <span class="token operator">==</span> <span class="token string">&quot;BUTTON&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token operator">?.</span><span class="token function">contains</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>activeDocument<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

            <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>子菜单（）</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 选中单击并取消菜单，如果单击在菜单之外</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handleHideTableGeneratorMenu</span><span class="token punctuation">(</span>evt<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 创建TG菜单</span>
<span class="token function">createTableGeneratorMenu</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> plugin<span class="token operator">:</span> TyporaPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 检查这个tableGeneratorEl是否已经创建，如果已经创建，则删除它</span>
    <span class="token comment">// 用于多弹窗</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>activeDocument<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">requireApiVersion</span><span class="token punctuation">(</span><span class="token string">&quot;0.15.0&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span> activeDocument <span class="token operator">:</span> document<span class="token punctuation">)</span><span class="token operator">?.</span>body<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cls<span class="token operator">:</span> <span class="token string">&quot;table-generator-view&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token comment">// 注意这里的 TableGenerator 是 \`import TableGenerator from &quot;./ui/TableGenerator.svelte&quot;;\`  导入的</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorComponent <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">TableGenerator</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        target<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">,</span>
        props<span class="token operator">:</span> <span class="token punctuation">{</span> editor<span class="token operator">:</span> editor<span class="token punctuation">,</span> plugin<span class="token operator">:</span> plugin <span class="token punctuation">}</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 展示TG菜单</span>
<span class="token function">showTableGeneratorView</span><span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> tableGeneratorBoard<span class="token operator">:</span> HTMLElement <span class="token operator">|</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>tableGeneratorBoard<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> cursor <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token string">&#39;from&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> coords<span class="token operator">:</span> Coords<span class="token punctuation">;</span>

    <span class="token comment">// 使用适当的CM5或CM6接口获取光标位置</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>editor <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cursorCoords<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        coords <span class="token operator">=</span> <span class="token punctuation">(</span>editor <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">cursorCoords</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">&#39;window&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>editor <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>coordsAtPos<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> offset <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">posToOffset</span><span class="token punctuation">(</span>cursor<span class="token punctuation">)</span><span class="token punctuation">;</span>
        coords <span class="token operator">=</span> <span class="token punctuation">(</span>editor <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span>cm<span class="token punctuation">.</span>coordsAtPos<span class="token operator">?.</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token punctuation">(</span>editor <span class="token keyword">as</span> <span class="token builtin">any</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">coordsAtPos</span><span class="token punctuation">(</span>offset<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">const</span> calculateTop <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token function">requireApiVersion</span><span class="token punctuation">(</span><span class="token string">&quot;0.15.0&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span>
                          activeDocument <span class="token operator">:</span> document<span class="token punctuation">)</span><span class="token operator">?.</span>body<span class="token punctuation">.</span><span class="token function">getBoundingClientRect</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>height <span class="token operator">-</span> coords<span class="token punctuation">.</span>top <span class="token operator">-</span> coords<span class="token punctuation">.</span>height<span class="token punctuation">;</span>
    tableGeneratorBoard<span class="token punctuation">.</span>style<span class="token punctuation">.</span>transform <span class="token operator">=</span> <span class="token string">&quot;translate(&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>coords<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;px, &quot;</span> <span class="token operator">+</span> <span class="token string">&quot;-&quot;</span> <span class="token operator">+</span> <span class="token punctuation">(</span>calculateTop<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;)&quot;</span><span class="token punctuation">;</span>
    tableGeneratorBoard<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&#39;unset&#39;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 隐藏TG菜单</span>
<span class="token function">handleHideTableGeneratorMenu</span><span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> target <span class="token operator">=</span> evt<span class="token punctuation">.</span>target <span class="token keyword">as</span> HTMLElement<span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl <span class="token operator">||</span> <span class="token operator">!</span>target<span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>target<span class="token punctuation">.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;typora-enhance-menu&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        target<span class="token punctuation">.</span>parentElement<span class="token operator">?.</span>classList<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token string">&quot;typora-enhance-menu&quot;</span><span class="token punctuation">)</span> <span class="token operator">||</span>
        target<span class="token punctuation">.</span>tagName <span class="token operator">==</span> <span class="token string">&quot;BUTTON&quot;</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token operator">?.</span><span class="token function">contains</span><span class="token punctuation">(</span>target<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>document<span class="token punctuation">.</span>body<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>tableGeneratorEl<span class="token punctuation">.</span><span class="token function">detach</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="功能区菜单-context-menu-其实应该叫ribbon-menu才对" tabindex="-1"><a class="header-anchor" href="#功能区菜单-context-menu-其实应该叫ribbon-menu才对"><span>功能区菜单（context menu，其实应该叫ribbon menu才对）</span></a></h4><p>简易版</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> ribbonIconEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&#39;dice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;TyporaEnhance&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&#39;This is a TyporaEnhance notice!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>示例版（图标菜单）</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Menu<span class="token punctuation">,</span> Notice<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 快捷菜单</span>
	<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&quot;dice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Open menu&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>event<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> menu <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Menu</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 会报错：应有 0 个参数，但获得 1 个。可以不管</span>

      menu<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        item
          <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Copy&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token string">&quot;documents&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&quot;Copied&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      menu<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        item
          <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Paste&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token string">&quot;paste&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&quot;Pasted&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span>
      <span class="token punctuation">)</span><span class="token punctuation">;</span>

      menu<span class="token punctuation">.</span><span class="token function">showAtMouseEvent</span><span class="token punctuation">(</span>event<span class="token punctuation">)</span><span class="token punctuation">;</span>		<span class="token comment">// 打开鼠标点击的菜单</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><p>![TIP]</p><p>如果您需要控制菜单出现的位置，您可以使用 <code>menu.showAtPosition({ x: 20, y: 20 })</code> 去打开相对 Obsidian 窗口左上角相应位置的菜单。</p></blockquote><h4 id="文件菜单-file-menu" tabindex="-1"><a class="header-anchor" href="#文件菜单-file-menu"><span>文件菜单（file-menu）</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerEvent</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;file-menu&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>menu<span class="token punctuation">,</span> file<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        menu<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            item
                <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Print file path 👈&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token string">&quot;document&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span>file<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="编辑菜单-editor-menu" tabindex="-1"><a class="header-anchor" href="#编辑菜单-editor-menu"><span>编辑菜单（editor-menu）</span></a></h4><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerEvent</span><span class="token punctuation">(</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;editor-menu&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>menu<span class="token punctuation">,</span> editor<span class="token punctuation">,</span> view<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        menu<span class="token punctuation">.</span><span class="token function">addItem</span><span class="token punctuation">(</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            item
                <span class="token punctuation">.</span><span class="token function">setTitle</span><span class="token punctuation">(</span><span class="token string">&quot;Print file path 👈&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setIcon</span><span class="token punctuation">(</span><span class="token string">&quot;document&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
                <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span>view<span class="token punctuation">.</span>file<span class="token punctuation">.</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="html元素" tabindex="-1"><a class="header-anchor" href="#html元素"><span>HTML元素</span></a></h3>`,28)),s("p",null,[n[215]||(n[215]=a("Obsidian API 中的几个组件，例如 ")),s("a",fn,[n[214]||(n[214]=a("设置选项卡 ")),t(p)]),n[216]||(n[216]=a("，公开 ")),n[217]||(n[217]=s("em",null,"了容器元素",-1)),n[218]||(n[218]=a(" ："))]),n[344]||(n[344]=e(`<div class="language-tsx line-numbers-mode" data-ext="tsx" data-title="tsx"><pre class="language-tsx"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> PluginSettingTab <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">ExampleSettingTab</span> <span class="token keyword">extends</span> <span class="token class-name">PluginSettingTab</span> <span class="token punctuation">{</span>
  plugin<span class="token operator">:</span> ExamplePlugin<span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> plugin<span class="token operator">:</span> ExamplePlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>plugin <span class="token operator">=</span> plugin<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> containerEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    <span class="token comment">// ...</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>容器元素是 <code>HTMLElement</code>使在 Obsidian 中创建自定义界面成为可能的对象</p><h4 id="使用创建-html-元素-createel" tabindex="-1"><a class="header-anchor" href="#使用创建-html-元素-createel"><span>使用创建 HTML 元素 <code>createEl()</code></span></a></h4><p>每一个 <code>HTMLElement</code>，包括容器元素，公开了一个 <code>createEl()</code>创建一个方法 <code>HTMLElement</code>在原始元素下。</p><p>例如，您可以通过以下方式添加 <code>&lt;h1&gt;</code>容器元素内的标题元素：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Heading 1&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p><code>createEl()</code>返回对新元素的引用：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> book <span class="token operator">=</span> containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;How to Take Smart Notes&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;small&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Sönke Ahrens&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>注意这个是OB接口提供的快捷接口，原生js的不是这样的。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 原生js方式</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
div<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&quot;abReplace&quot;</span><span class="token punctuation">)</span>
div<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;style&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;background-color: #272e3a&quot;</span><span class="token punctuation">)</span>
div<span class="token punctuation">.</span>innerText <span class="token operator">=</span> <span class="token string">&quot;👉&quot;</span> <span class="token operator">+</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">;</span>

<span class="token comment">// Obsidian.d.ts里的方法</span>
<span class="token keyword">const</span> div <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createDiv</span><span class="token punctuation">(</span><span class="token punctuation">{</span>	<span class="token comment">// createEl</span>
    <span class="token literal-property property">cls</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&quot;abReplace&quot;</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token literal-property property">attr</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token literal-property property">style</span><span class="token operator">:</span> <span class="token string">&quot;background-color: #272e3a&quot;</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// 【区别】他们不同的</span>
Document<span class="token punctuation">.</span>createElement
HTMLElement<span class="token punctuation">.</span>createEl		<span class="token comment">// 继承树：Node--&gt;Element--&gt;HTMLElement/HTML{Div}Element</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="元素样式" tabindex="-1"><a class="header-anchor" href="#元素样式"><span>元素样式</span></a></h4><p>您可以通过添加一个自定义 CSS 样式到您的插件 <code>styles.css</code>插件根目录下的文件。 为上一本书示例添加一些样式</p><div class="language-css line-numbers-mode" data-ext="css" data-title="css"><pre class="language-css"><code><span class="token selector">.book</span> <span class="token punctuation">{</span>
  <span class="token property">border</span><span class="token punctuation">:</span> 1px solid <span class="token function">var</span><span class="token punctuation">(</span>--background-modifier-border<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.book__title</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> 600<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">.book__author</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--text-muted<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>要使 HTML 元素使用样式，请设置 <code>cls</code>HTML 元素的属性：</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">const</span> book <span class="token operator">=</span> containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cls<span class="token operator">:</span> <span class="token string">&quot;book&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;div&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;How to Take Smart Notes&quot;</span><span class="token punctuation">,</span> cls<span class="token operator">:</span> <span class="token string">&quot;book__title&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
book<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;small&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Sönke Ahrens&quot;</span><span class="token punctuation">,</span> cls<span class="token operator">:</span> <span class="token string">&quot;book__author&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="条件格式" tabindex="-1"><a class="header-anchor" href="#条件格式"><span>条件格式</span></a></h4><p>如果你想根据用户的设置或其他值来改变一个元素的风格，使用 <code>toggleClass</code> 方法:</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code>element<span class="token punctuation">.</span><span class="token function">toggleClass</span><span class="token punctuation">(</span><span class="token string">&quot;danger&quot;</span><span class="token punctuation">,</span> status <span class="token operator">===</span> <span class="token string">&quot;error&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="图标" tabindex="-1"><a class="header-anchor" href="#图标"><span>图标</span></a></h3><p>Obsidian API 中的一些 UI 组件允许您配置与之对应的icon。您可以从内置的 icon 中选择一个，或者添加自定义的icon。</p><h4 id="浏览可用的-icon" tabindex="-1"><a class="header-anchor" href="#浏览可用的-icon"><span>浏览可用的 icon</span></a></h4>`,21)),s("p",null,[n[220]||(n[220]=a("浏览 ")),s("a",wn,[n[219]||(n[219]=a("lucide.dev")),t(p)]),n[221]||(n[221]=a(" 站点以查看所有可用的图标以及对应的名称。"))]),n[345]||(n[345]=e(`<h4 id="绘制-icons" tabindex="-1"><a class="header-anchor" href="#绘制-icons"><span>绘制 icons</span></a></h4><h4 id="添加您自己的-ico" tabindex="-1"><a class="header-anchor" href="#添加您自己的-ico"><span>添加您自己的 ico</span></a></h4><h3 id="用户界面" tabindex="-1"><a class="header-anchor" href="#用户界面"><span>用户界面</span></a></h3><h3 id="对话框" tabindex="-1"><a class="header-anchor" href="#对话框"><span>对话框</span></a></h3><h4 id="创建对话框" tabindex="-1"><a class="header-anchor" href="#创建对话框"><span>创建对话框</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Modal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ExampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">app</span><span class="token operator">:</span> App</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">// onOpen() 方法在对话框打开时被调用，它负责创建对话框中的内容。想要获取更多信息，可以查阅 HTML elements。</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    contentEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&quot;Look at me, I&#39;m a modal! 👀&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">// onClose() 方法在对话框被关闭时调用，它负责清理对话框所占用的资源。</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="打开对话框" tabindex="-1"><a class="header-anchor" href="#打开对话框"><span>打开对话框</span></a></h4>`,7)),s("p",null,[n[223]||(n[223]=a("要想打开一个对话框，需要创建一个 ")),n[224]||(n[224]=s("code",null,"ExampleModal",-1)),n[225]||(n[225]=a(" 的实例并调用其上的 ")),s("a",yn,[n[222]||(n[222]=s("code",null,"open()",-1)),t(p)]),n[226]||(n[226]=a(" 方法:"))]),n[346]||(n[346]=e(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ExampleModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modal&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&quot;display-modal&quot;</span><span class="token punctuation">,</span>
      <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&quot;Display modal&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">new</span> <span class="token class-name">ExampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="接受用户输入" tabindex="-1"><a class="header-anchor" href="#接受用户输入"><span>接受用户输入</span></a></h4><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token comment">// 定义输入框</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ExampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">result</span><span class="token operator">:</span> string<span class="token punctuation">;</span>
  <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">result</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">result</span><span class="token operator">:</span> string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>	<span class="token comment">// 传入回调函数</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit <span class="token operator">=</span> onSubmit<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    contentEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">&quot;What&#39;s your name?&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span>										<span class="token comment">// 输入框</span>
      <span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Name&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">text</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        text<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span>result <span class="token operator">=</span> value
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span>										<span class="token comment">// 提交按钮</span>
      <span class="token punctuation">.</span><span class="token function">addButton</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">btn</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
        btn
          <span class="token punctuation">.</span><span class="token function">setButtonText</span><span class="token punctuation">(</span><span class="token string">&quot;Submit&quot;</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">setCta</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
          <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>											<span class="token comment">// 关闭窗口</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>result<span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 打开输入框和获取返回</span>
<span class="token keyword">new</span> <span class="token class-name">ExampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">Hello, </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>result<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">!</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="从建议列表中选择" tabindex="-1"><a class="header-anchor" href="#从建议列表中选择"><span>从建议列表中选择</span></a></h4>`,4)),s("p",null,[s("a",hn,[n[227]||(n[227]=s("code",null,"SuggestModal",-1)),t(p)]),n[228]||(n[228]=a(" 是一个比较特殊的对话框，用于展示一个列表供用户选择"))]),n[347]||(n[347]=e('<p>……</p><h3 id="功能区操作" tabindex="-1"><a class="header-anchor" href="#功能区操作"><span>功能区操作</span></a></h3><h3 id="设置" tabindex="-1"><a class="header-anchor" href="#设置"><span>设置</span></a></h3><h3 id="状态栏" tabindex="-1"><a class="header-anchor" href="#状态栏"><span>状态栏</span></a></h3><h3 id="视图-view" tabindex="-1"><a class="header-anchor" href="#视图-view"><span>视图 View</span></a></h3><h4 id="基本用法" tabindex="-1"><a class="header-anchor" href="#基本用法"><span>基本用法</span></a></h4><p>视图决定 Obsidian 如何去展示内容。比如 file explorer, graph view, 以及 Markdown view 等都是视图。当然，您也可以为自己的插件创建一个可以更好的展示其内容的自定义视图。</p>',7)),s("p",null,[n[230]||(n[230]=a("要想创建一个自定义视图，需要创建一个继承自 ")),s("a",An,[n[229]||(n[229]=s("code",null,"ItemView",-1)),t(p)]),n[231]||(n[231]=a(" 的类:"))]),n[348]||(n[348]=e(`<div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ItemView<span class="token punctuation">,</span> WorkspaceLeaf <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span> <span class="token operator">=</span> <span class="token string">&quot;example-view&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ExampleView</span> <span class="token keyword">extends</span> <span class="token class-name">ItemView</span> <span class="token punctuation">{</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span>leaf<span class="token operator">:</span> WorkspaceLeaf<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>leaf<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getViewType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">getDisplayText</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token string">&quot;Example view&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> container <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>containerEl<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    container<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    container<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;h4&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Example view&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Nothing to clean up.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>每个视图都由一个唯一的名称来标识，并且有几个操作需要您指定要使用的视图。 把它抽成一个常量，<code>VIEW_TYPE_EXAMPLE</code>，这是一个不错的方式。稍后您将在本指南中看到它。</p><ul><li><code>getViewType()</code> 用于返回当前视图的唯一标识。必须override</li><li><code>getDisplayText()</code> 用于返回一个更加人性化的视图名称。必须override</li><li><code>onOpen()</code> 在视图打开时调用，它负责构建视图的内容。</li><li><code>onClose()</code> 在视图需要被关闭时调用，它负责释放视图占用的资源。</li></ul><p>自定义视图需要在插件被启用时注册，并且在插件被禁用时释放。</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> ExampleView<span class="token punctuation">,</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span> <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./view&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerView</span><span class="token punctuation">(</span>
      <span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">,</span>
      <span class="token punctuation">(</span><span class="token parameter">leaf</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">new</span> <span class="token class-name">ExampleView</span><span class="token punctuation">(</span>leaf<span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&quot;dice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Activate view&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">activateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">detachLeavesOfType</span><span class="token punctuation">(</span><span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">async</span> <span class="token function">activateView</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">detachLeavesOfType</span><span class="token punctuation">(</span><span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getRightLeaf</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setViewState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">,</span>
      <span class="token literal-property property">active</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">revealLeaf</span><span class="token punctuation">(</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getLeavesOfType</span><span class="token punctuation">(</span><span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5)),s("p",null,[s("a",xn,[n[232]||(n[232]=s("code",null,"registerView()",-1)),t(p)]),n[233]||(n[233]=a(" 的第二个参数是一个工厂函数，用于返回您想注册的视图实例。"))]),n[349]||(n[349]=e(`<h4 id="其他补充" tabindex="-1"><a class="header-anchor" href="#其他补充"><span>其他补充</span></a></h4><blockquote><p>WARNING</p><p>永远不要在插件中管理对视图的引用，因为 Obsidian 可能会调用视图工厂函数多次。 为了避免视图中的副作用，在需要访问视图实例时使用 <code>getLeavesOfType()</code>。（和<code>getActiveViewOfType</code>有所不同）</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getLeavesOfType</span><span class="token punctuation">(</span><span class="token constant">VIEW_TYPE_EXAMPLE</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span>leaf<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>leaf<span class="token punctuation">.</span>view <span class="token keyword">instanceof</span> <span class="token class-name">ExampleView</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// Access your view instance.</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></blockquote><p>在 <code>onunload()</code> 方法中，确保在插件被禁用时清理视图：</p><ul><li>通过调用 <code>close()</code> 方法允许视图自行清理。</li><li>分离使用视图的所有节点。</li></ul><p>在您为插件注册了一个自定义视图后，您需要为用户提供一个激活它的方式。<code>activateView()</code> 是个很实用的方法，它做了以下三件事情：</p><ul><li>使用自定义视图分离所有节点。</li><li>将自定义视图添加到正确的节点上。</li><li>显示包含自定义视图的节点。</li></ul><blockquote><p>TIP</p><p><code>activateView()</code> 方法限制您的插件一次最多显示一个视图。尝试注释掉对 <code>detachLeavesOfType()</code> 的调用，以允许用户创建多个视图。每次调用 <code>activateView()</code>。</p></blockquote>`,7)),s("p",null,[n[236]||(n[236]=a("用户如何激活视图的方式取决于您。这是使用 ")),s("a",qn,[n[234]||(n[234]=a("ribbon action")),t(p)]),n[237]||(n[237]=a(" 的例子，当然您也可以使用 ")),s("a",Vn,[n[235]||(n[235]=a("指令")),t(p)]),n[238]||(n[238]=a("。"))]),n[350]||(n[350]=s("h3",{id:"工作区",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#工作区"},[s("span",null,"工作区")])],-1)),n[351]||(n[351]=s("h4",{id:"工作区-1",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#工作区-1"},[s("span",null,"工作区")])],-1)),n[352]||(n[352]=s("p",null,[a("Obsidian 允许您配置在任何指定的时间对您可见的内容。当您不需要文件搜索的时候隐藏它、并列显示多个文档、或者在您编辑文档的时候显示文档大纲。关于应用内的可见内容配置窗口在 "),s("em",null,"workspace"),a(" 配置项中。")],-1)),s("p",null,[n[243]||(n[243]=a("workspace 是")),s("a",En,[n[239]||(n[239]=a("树形结构")),t(p)]),n[244]||(n[244]=a("的, 树上的每一个节点都是一个 ")),s("a",Pn,[n[240]||(n[240]=a("工作区项")),t(p)]),n[245]||(n[245]=a("。 有两种类型的工作区项： ")),s("a",zn,[n[241]||(n[241]=s("em",null,"父节点",-1)),t(p)]),n[246]||(n[246]=a(" and ")),s("a",Cn,[n[242]||(n[242]=s("em",null,"叶子节点",-1)),t(p)]),n[247]||(n[247]=a("。 两者之间的主要区别在于 ")),n[248]||(n[248]=s("em",null,"parents",-1)),n[249]||(n[249]=a(" 可以包含 ")),n[250]||(n[250]=s("em",null,"leaves",-1)),n[251]||(n[251]=a(" 以及其他 ")),n[252]||(n[252]=s("em",null,"parents",-1)),n[253]||(n[253]=a(" ，而 ")),n[254]||(n[254]=s("em",null,"leaves",-1)),n[255]||(n[255]=a(" 不可以包含任何其他项。"))]),s("p",null,[n[258]||(n[258]=s("em",null,"parents",-1)),n[259]||(n[259]=a(" 也存在两种类型， ")),s("a",Tn,[n[256]||(n[256]=s("em",null,"splits",-1)),t(p)]),n[260]||(n[260]=a(" 以及 ")),s("a",Mn,[n[257]||(n[257]=s("em",null,"tabs",-1)),t(p)]),n[261]||(n[261]=a(", 用来决定其中的子项如何呈现给用户:"))]),t(o,{id:"mermaid-1310",code:"eJxLL0osyFAIceIKLsjJLNHVtfNJTUwzROEZofCMuUISk4qhHBNkjikyx4wLAAE1G2Y="}),n[353]||(n[353]=s("ul",null,[s("li",null,"split 沿垂直或水平方向依次排列其子项。"),s("li",null,"tabs 每次只显示一个子项。")],-1)),n[354]||(n[354]=s("p",null,[a("在 workspace 下面有三种特殊的 split: "),s("em",null,"left"),a(", "),s("em",null,"right"),a(", and "),s("em",null,"root"),a(" 。下图是典型的 workspace 示例：")],-1)),t(o,{id:"mermaid-1326",code:"eJxLL0osyFAIceIKzy/KLi5ITE7V1bXzSU0riS8uyMksAXJCEpOKDcGCiWmGXMg8Iy4UXUH5+QhdwVAapM6YC5lnwoWiECRkimZQZnoGqv1GUIVmYPthPHMUngUXANb4Qbc="}),s("p",null,[n[263]||(n[263]=a("leaf 是一个能以不同形式展示内容的窗口。leaf 的类型决定了内容该要如何展示，以及对应哪个具体的 ")),n[264]||(n[264]=s("em",null,"view",-1)),n[265]||(n[265]=a("。举个例子，一个 ")),n[266]||(n[266]=s("code",null,"graph",-1)),n[267]||(n[267]=a(" 类型的 leaf 对应显示 ")),s("a",Xn,[n[262]||(n[262]=a("graph view")),t(p)]),n[268]||(n[268]=a("。"))]),n[355]||(n[355]=s("h4",{id:"splits",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#splits"},[s("span",null,"Splits")])],-1)),n[356]||(n[356]=s("p",null,"默认情况下，root split 按照垂直方向排列。当您创建了一个新的 leaf，Obsidian 在用户界面中创建一个新列。当您拆分一个 leaf，被拆分出来的 leaves 会被添加到新的 split 中去。当没有限制 root split 的层级时，实际上每个层级的实用性会降低。",-1)),t(o,{id:"mermaid-1336",code:"eJxLL0osyFAIceIKys8viS8uyMksiU9KTcsvSk7V1bXzSU1MM8QtZcSFLJeYVpJaBJQJBvG4wCRUnTEKzwSbJpCEKRcA/yQxLA=="}),n[357]||(n[357]=s("p",null,"左右的 splits 的工作方式略有不同。当您拆分一个 leaf 到侧边栏，Obsidian 会生成一个新的 tabs，并将新的 leaf 插入到其中。事实上，这意味着它们在任何时候只能拥有三层的 workpace，并且直接子级必须是 tabs 。",-1)),t(o,{id:"mermaid-1340",code:"eJxLL0osyFAIceIKys8viS8uyMksiU9KTcsvSk7V1bULSUwqNgTSPqmJaYZcyDwjLmQdiWklqUVQ9Ua4JIzBBhhBDUDlmYB5xlCeKRcADl8xAg=="}),n[358]||(n[358]=s("h4",{id:"检查工作区",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#检查工作区"},[s("span",null,"检查工作区")])],-1)),s("p",null,[n[270]||(n[270]=a("您可以通过 ")),s("a",Sn,[n[269]||(n[269]=a("App")),t(p)]),n[271]||(n[271]=a(" 对象访问工作区。下例中打印了在工作区中每个 leaf 的类型:"))]),n[359]||(n[359]=e(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">ExamplePlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&quot;dice&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;Print leaf types&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">iterateAllLeaves</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">leaf</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>leaf<span class="token punctuation">.</span><span class="token function">getViewState</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>type<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="leaf-lifecycle" tabindex="-1"><a class="header-anchor" href="#leaf-lifecycle"><span>Leaf lifecycle</span></a></h4>`,2)),s("p",null,[n[274]||(n[274]=a("插件可以向 workspace 中添加任意类型的 leaf，也可以通过 [自定义视图]")),s("a",Kn,[n[272]||(n[272]=a("custom views")),t(p)]),n[275]||(n[275]=a("。以下是一些添加 leaf 到 workspace 的方式。想要了解更多，可以查阅 ")),s("a",Ln,[n[273]||(n[273]=s("code",null,"Workspace",-1)),t(p)]),n[276]||(n[276]=a(" 这篇文档。"))]),s("ul",null,[s("li",null,[n[278]||(n[278]=a("如果您想在根 split 中添加一个新的 leaf， 使用 ")),s("a",jn,[n[277]||(n[277]=s("code",null,"workspace.getLeaf(true)",-1)),t(p)]),n[279]||(n[279]=a(" 方法."))]),s("li",null,[n[282]||(n[282]=a("如果您想在侧边栏中添加任意一个新的 leaf，可以使用 ")),s("a",Bn,[n[280]||(n[280]=s("code",null,"workspace.getLeftLeaf()",-1)),t(p)]),n[283]||(n[283]=a(" 以及 ")),s("a",Wn,[n[281]||(n[281]=s("code",null,"workspace.getRightLeaf()",-1)),t(p)]),n[284]||(n[284]=a("方法。两者都可以让您决定是否需要将 leaf 添加到新的 split 上。"))])]),s("p",null,[n[286]||(n[286]=a("您也可以使用 ")),s("a",Un,[n[285]||(n[285]=s("code",null,"createLeafInParent()",-1)),t(p)]),n[287]||(n[287]=a("方法在您选择的 split 中显式的添加 leaf。"))]),n[360]||(n[360]=s("p",null,"除非明确删除，否则即使在插件被禁用后，插件添加到工作区上的任何 leaf 依旧会被保留。插件负责删除它们添加到 工作区的任何叶子节点。",-1)),s("p",null,[n[290]||(n[290]=a("要想从 workspace 中删除一个 leaf，在您想要删除的 leaf 上调用 ")),s("a",On,[n[288]||(n[288]=s("code",null,"detach()",-1)),t(p)]),n[291]||(n[291]=a("方法。您也可以通过使用 ")),s("a",Fn,[n[289]||(n[289]=s("code",null,"detachLeavesOfType()",-1)),t(p)]),n[292]||(n[292]=a("."))]),n[361]||(n[361]=s("h4",{id:"leaf-组",tabindex:"-1"},[s("a",{class:"header-anchor",href:"#leaf-组"},[s("span",null,"Leaf 组")])],-1)),s("p",null,[n[295]||(n[295]=a("您可以使用 ")),s("a",Nn,[n[293]||(n[293]=a("linked panes")),t(p)]),n[296]||(n[296]=a(" 方法来分配多个 leaf 到同一个组中以创建 ")),s("a",In,[n[294]||(n[294]=s("code",null,"setGroup()",-1)),t(p)]),n[297]||(n[297]=a("."))]),n[362]||(n[362]=e(`<div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code>leaves<span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">leaf</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> leaf<span class="token punctuation">.</span><span class="token function">setGroup</span><span class="token punctuation">(</span><span class="token string">&quot;group1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="开发支持其他格式文件的插件" tabindex="-1"><a class="header-anchor" href="#开发支持其他格式文件的插件"><span>开发支持其他格式文件的插件</span></a></h2>`,2)),s("p",null,[n[299]||(n[299]=a("见 ")),t(l,{to:"/MdNote_Public/01.%20DesignAndDevelop/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/Obsidian/%E3%80%8AObsidian%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3%E3%80%8B/%E5%BC%80%E5%8F%91%E6%94%AF%E6%8C%81%E5%85%B6%E4%BB%96%E6%A0%BC%E5%BC%8F%E6%96%87%E4%BB%B6%E7%9A%84%E6%8F%92%E4%BB%B6.html"},{default:r(()=>n[298]||(n[298]=[a("./开发支持其他格式文件的插件")])),_:1})]),n[363]||(n[363]=e(`<h2 id="官方示例" tabindex="-1"><a class="header-anchor" href="#官方示例"><span>官方示例</span></a></h2><h3 id="obsidian-sample-plugin" tabindex="-1"><a class="header-anchor" href="#obsidian-sample-plugin"><span>Obsidian-sample-plugin</span></a></h3><p>https://github.com/obsidianmd/obsidian-sample-plugin</p><h4 id="使用" tabindex="-1"><a class="header-anchor" href="#使用"><span>使用</span></a></h4><blockquote><h5 id="编译方法" tabindex="-1"><a class="header-anchor" href="#编译方法"><span>编译方法</span></a></h5></blockquote><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token comment"># 首先要先安装nodejs，里面包含npm工具</span>
<span class="token function">npm</span> i             <span class="token comment"># 等同于npm install</span>
<span class="token function">npm</span> run dev       <span class="token comment"># 进行编译，将ts编译成js</span>

<span class="token comment"># 如果Obsidian API更新了</span>
<span class="token function">npm</span> update
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><blockquote><h5 id="手动安装插件" tabindex="-1"><a class="header-anchor" href="#手动安装插件"><span>手动安装插件</span></a></h5></blockquote><p>复制 <code>main.js, styles.css, manifest. js</code> 到Ob的插件路径</p><blockquote><h5 id="功能" tabindex="-1"><a class="header-anchor" href="#功能"><span>功能</span></a></h5></blockquote><ul><li>有设置菜单</li><li>有小图标，小图标可以输出tips</li><li>输出文字 “Sample Editor Command”</li><li>打开提示窗</li></ul><blockquote><h5 id="发布新版本" tabindex="-1"><a class="header-anchor" href="#发布新版本"><span>发布新版本</span></a></h5></blockquote><ul><li><p>json加上你的版本号，以及最新版本所需的最低Obsidian版本</p></li><li><p>更新你的版本</p></li><li><p>上传清单：Json，main.js，styles.css。<br> 注意: Json文件必须在两个地方，第一个是存储库的根路径，另一个是发布版本</p></li><li><p>你可以在手动更新 manifest.json 中的 minAppVersion 运行：</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code><span class="token function">npm</span> version patch
<span class="token comment"># 或</span>
<span class="token function">npm</span> version minor
<span class="token comment"># 或</span>
<span class="token function">npm</span> version major
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>来来简化版本碰撞过程</p></li></ul><blockquote><h5 id="将您的插件添加到社区插件列表中" tabindex="-1"><a class="header-anchor" href="#将您的插件添加到社区插件列表中"><span>将您的插件添加到社区插件列表中</span></a></h5></blockquote><p>略</p><blockquote><h5 id="使用eslint提高代码质量-可选" tabindex="-1"><a class="header-anchor" href="#使用eslint提高代码质量-可选"><span>使用eslint提高代码质量(可选)</span></a></h5></blockquote><p>略</p><h4 id="代码" tabindex="-1"><a class="header-anchor" href="#代码"><span>代码</span></a></h4><p>main.ts（注释汉化版本）</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Editor<span class="token punctuation">,</span> MarkdownView<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Notice<span class="token punctuation">,</span> Plugin<span class="token punctuation">,</span> PluginSettingTab<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;obsidian&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 记得重命名这些类和接口!</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPluginSettings</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token operator">:</span> MyPluginSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token string">&#39;default&#39;</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
	settings<span class="token operator">:</span> MyPluginSettings<span class="token punctuation">;</span>

	<span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将在左侧色带中创建一个图标</span>
		<span class="token keyword">const</span> ribbonIconEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&#39;dice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sample Plugin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 当用户单击图标时调用：发送一条信息</span>
			<span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&#39;This is a notice!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 对色带执行额外的操作</span>
		ribbonIconEl<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;my-plugin-ribbon-class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个状态栏项目的底部的应用程序。不工作在移动应用程序</span>
		<span class="token keyword">const</span> statusBarItemEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addStatusBarItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		statusBarItemEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Status Bar Text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这增加了一个可以在任何地方触发的简单命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-simple&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (simple)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 这将添加一个编辑器命令，可以对当前编辑器实例执行某些操作</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;sample-editor-command&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Sample editor command&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token string">&#39;Sample Editor Command&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 这添加了一个复杂的命令,可以检查应用程序的当前状态是否允许执行命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-complex&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (complex)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">checkCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>checking<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 条件检查</span>
				<span class="token keyword">const</span> markdownView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>markdownView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 如果检查为真，我们只是在“检查”命令是否可以运行</span>
					<span class="token comment">// 如果检查为false，那么我们想实际执行操作</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// 只有当check函数返回true时，该命令才会显示在命令面板中</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个设置选项卡，以便用户可以配置插件的各个方面</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSettingTab</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SampleSettingTab</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 如果该插件连接了任何全局DOM事件(在不属于该插件的应用程序部分上)</span>
		<span class="token comment">//当这个插件被禁用时，使用这个函数会自动删除事件监听器。</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 当注册间隔时，当插件被禁用时，该函数将自动清除间隔</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerInterval</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;setInterval&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token keyword">async</span> <span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>settings <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token keyword">async</span> <span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Woah!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">class</span> <span class="token class-name">SampleSettingTab</span> <span class="token keyword">extends</span> <span class="token class-name">PluginSettingTab</span> <span class="token punctuation">{</span>
	plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>plugin <span class="token operator">=</span> plugin<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>containerEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>text<span class="token operator">:</span> <span class="token string">&#39;Settings for my awesome plugin.&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>containerEl<span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&#39;Setting #1&#39;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token string">&#39;It\\&#39;s a secret&#39;</span><span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span>text <span class="token operator">=&gt;</span> text
				<span class="token punctuation">.</span><span class="token function">setPlaceholder</span><span class="token punctuation">(</span><span class="token string">&#39;Enter your secret&#39;</span><span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Secret: &#39;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting <span class="token operator">=</span> value<span class="token punctuation">;</span>
					<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span><span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="api接口" tabindex="-1"><a class="header-anchor" href="#api接口"><span>API接口</span></a></h3><p>https://github.com/obsidianmd/obsidian-api</p><p>也可以看开发文档中，接口类自动生成的文档（但是没有多什么注释，感觉和直接看api文件也差不多）： https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/reference/typescript/classes/AbstractTextComponent.html</p><p>obsidian.d.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// 4406行</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="插入链接示例-开发文档示例" tabindex="-1"><a class="header-anchor" href="#插入链接示例-开发文档示例"><span>插入链接示例（开发文档示例）</span></a></h3><p>https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/examples/insert-link.html</p><p>main.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> Editor<span class="token punctuation">,</span> Plugin <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> InsertLinkModal <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;./modal&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">InsertLinkPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      id<span class="token operator">:</span> <span class="token string">&quot;insert-link&quot;</span><span class="token punctuation">,</span>
      name<span class="token operator">:</span> <span class="token string">&quot;Insert link&quot;</span><span class="token punctuation">,</span>
      <span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">const</span> selectedText <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">const</span> <span class="token function-variable function">onSubmit</span> <span class="token operator">=</span> <span class="token punctuation">(</span>text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> url<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">[</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>text<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">](</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">\${</span>url<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">;</span>

        <span class="token keyword">new</span> <span class="token class-name">InsertLinkModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> selectedText<span class="token punctuation">,</span> onSubmit<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>./modal.ts</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&quot;obsidian&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">InsertLinkModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
  linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span>linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token punctuation">;</span>

  <span class="token function">constructor</span><span class="token punctuation">(</span>
    app<span class="token operator">:</span> App<span class="token punctuation">,</span>
    defaultLinkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span>
    <span class="token function-variable function">onSubmit</span><span class="token operator">:</span> <span class="token punctuation">(</span>linkText<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> linkUrl<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>linkText <span class="token operator">=</span> defaultLinkText<span class="token punctuation">;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>onSubmit <span class="token operator">=</span> onSubmit<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

    contentEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&quot;h1&quot;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> text<span class="token operator">:</span> <span class="token string">&quot;Insert link&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Link text&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkText<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>linkText <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&quot;Link URL&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span><span class="token punctuation">(</span>text<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      text<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl <span class="token operator">=</span> value<span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>contentEl<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">addButton</span><span class="token punctuation">(</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span> <span class="token operator">=&gt;</span>
      btn
        <span class="token punctuation">.</span><span class="token function">setButtonText</span><span class="token punctuation">(</span><span class="token string">&quot;Insert&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">setCta</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">onClick</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
          <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">onSubmit</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>linkText<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>linkUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> <span class="token punctuation">{</span> contentEl <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="试作插件-切换复选框状态" tabindex="-1"><a class="header-anchor" href="#试作插件-切换复选框状态"><span>试作插件 - 切换复选框状态</span></a></h3><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> App<span class="token punctuation">,</span> Editor<span class="token punctuation">,</span> MarkdownView<span class="token punctuation">,</span> Modal<span class="token punctuation">,</span> Notice<span class="token punctuation">,</span> Plugin<span class="token punctuation">,</span> PluginSettingTab<span class="token punctuation">,</span> Setting <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;obsidian&#39;</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> test <span class="token keyword">from</span> <span class="token string">&#39;node:test&#39;</span><span class="token punctuation">;</span>

<span class="token comment">// 记得重命名这些类和接口!</span>

<span class="token keyword">interface</span> <span class="token class-name">MyPluginSettings</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token operator">:</span> MyPluginSettings <span class="token operator">=</span> <span class="token punctuation">{</span>
	mySetting<span class="token operator">:</span> <span class="token string">&#39;default&#39;</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 1. Plugin接口的实现
 *
 */</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">class</span> <span class="token class-name">MyPlugin</span> <span class="token keyword">extends</span> <span class="token class-name">Plugin</span> <span class="token punctuation">{</span>
	settings<span class="token operator">:</span> MyPluginSettings<span class="token punctuation">;</span>

	<span class="token comment">// 插件加载后</span>
	<span class="token keyword">async</span> <span class="token function">onload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">/* 1. 左侧工具栏相关的操作 */</span>
		<span class="token comment">/* 在左侧色带中创建一个图标
		 *     参数1：估计是图标名
		 *     参数2：悬浮提示名
		 *     参数3：事件
		 */</span>
		<span class="token keyword">const</span> ribbonIconEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addRibbonIcon</span><span class="token punctuation">(</span><span class="token string">&#39;dice&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Sample Plugin&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token comment">// 当用户单击图标时调用：发送一条信息</span>
			<span class="token keyword">new</span> <span class="token class-name">Notice</span><span class="token punctuation">(</span><span class="token string">&#39;This is a notice!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 对色带执行额外的操作</span>
		ribbonIconEl<span class="token punctuation">.</span><span class="token function">addClass</span><span class="token punctuation">(</span><span class="token string">&#39;my-plugin-ribbon-class&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token comment">/* 2. 右下角的状态栏增添一段文字
		 * 移动应用程序中不工作
		 */</span>
		<span class="token keyword">const</span> statusBarItemEl <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addStatusBarItem</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		statusBarItemEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Status Bar Text&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


		<span class="token comment">/* 3. 下面增加三个可以在任何地方触发的简单命令
		 * addCommand函数
		 *     参数1：id
		 *     参数2：命令名字
		 *     参数3：事件，一个回调函数
		 */</span>

		<span class="token comment">// 3.1. 打开一个窗口</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-simple&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (simple)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">callback</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.2. 这将添加一个编辑器命令，可以对当前编辑器实例执行某些操作。这里是在光标所在位置打印一串字符串</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;sample-editor-command&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Sample editor command&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getSelection</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				editor<span class="token punctuation">.</span><span class="token function">replaceSelection</span><span class="token punctuation">(</span><span class="token string">&#39;Sample Editor Command&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 3.3. 这添加了一个复杂的命令,可以检查应用程序的当前状态是否允许执行命令</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;open-sample-modal-complex&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;Open sample modal (complex)&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">checkCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>checking<span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				<span class="token comment">// 条件检查</span>
				<span class="token keyword">const</span> markdownView <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>markdownView<span class="token punctuation">)</span> <span class="token punctuation">{</span>
					<span class="token comment">// 如果检查为真，我们只是在“检查”命令是否可以运行</span>
					<span class="token comment">// 如果检查为false，那么我们想实际执行操作</span>
					<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>checking<span class="token punctuation">)</span> <span class="token punctuation">{</span>
						<span class="token keyword">new</span> <span class="token class-name">SampleModal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">open</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token punctuation">}</span>

					<span class="token comment">// 只有当check函数返回true时，该命令才会显示在命令面板中</span>
					<span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span>
			<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 一些实验：</span>
		<span class="token comment">// editor.getValue() // 获取全部内容</span>
		<span class="token comment">// editor.lineCount() // 一共有多少行</span>
		<span class="token comment">// let i = editor.getCursor().line // 光标在第几行</span>
		<span class="token comment">// editor.replaceSelection(&#39;SSS：&#39;+s1+&quot;DDD&quot;) // 光标后输出</span>

		<span class="token comment">// &quot;- [ ] 678&quot;.match(new RegExp(\`^(\\s*- )(\\\\[[* +-x]\\\\])(.*)\`))</span>
		<span class="token comment">// Array(4) [ &quot;- [ ] 678&quot;, &quot;- &quot;, &quot;[ ]&quot;, &quot; 678&quot; ]</span>
		<span class="token comment">// editor.replaceSelection(&#39;   SSS:【&#39;+ s1.match(r1)+&quot;】【&quot; +s1.match(r2)+&quot;】【&quot;+ s1+&quot;】&quot;)</span>

		<span class="token comment">// 4. 切换鼠标所在行的复选框状态</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
			id<span class="token operator">:</span> <span class="token string">&#39;test&#39;</span><span class="token punctuation">,</span>
			name<span class="token operator">:</span> <span class="token string">&#39;切换鼠标所在行的复选框状态&#39;</span><span class="token punctuation">,</span>
			<span class="token function-variable function">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>editor<span class="token operator">:</span> Editor<span class="token punctuation">,</span> view<span class="token operator">:</span> MarkdownView<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
				

				<span class="token keyword">let</span> s1 <span class="token operator">:</span><span class="token builtin">string</span> <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getLine</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>line<span class="token punctuation">)</span> <span class="token comment">// 获取序列行的内容</span>
				
				<span class="token keyword">let</span> r1 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">^\\\\s*- \\\\[[( )]\\\\](.*)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
				<span class="token keyword">let</span> r2 <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RegExp</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">\`</span><span class="token string">^\\\\s*- \\\\[[(*+-x)]\\\\](.*)</span><span class="token template-punctuation string">\`</span></span><span class="token punctuation">)</span>
				<span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r1<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					s1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;[ ]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;[*]&quot;</span><span class="token punctuation">)</span>	<span class="token comment">// 这里写得比较简陋，会有bug，比如- [ ] [ ]</span>
				<span class="token punctuation">}</span>
				<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>s1<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span>r2<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
					s1 <span class="token operator">=</span> s1<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;[*]&quot;</span><span class="token punctuation">,</span><span class="token string">&quot;[ ]&quot;</span><span class="token punctuation">)</span>
				<span class="token punctuation">}</span>

				editor<span class="token punctuation">.</span><span class="token function">setLine</span><span class="token punctuation">(</span>editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>line<span class="token punctuation">,</span> s1<span class="token punctuation">)</span>
				<span class="token punctuation">}</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 这将添加一个设置选项卡，以便用户可以配置插件的各个方面</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addSettingTab</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SampleSettingTab</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 如果该插件连接了任何全局DOM事件(在不属于该插件的应用程序部分上)</span>
		<span class="token comment">//当这个插件被禁用时，使用这个函数会自动删除事件监听器。</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerDomEvent</span><span class="token punctuation">(</span>document<span class="token punctuation">,</span> <span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>evt<span class="token operator">:</span> MouseEvent<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
			<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;click&#39;</span><span class="token punctuation">,</span> evt<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 当注册间隔时，当插件被禁用时，该函数将自动清除间隔</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">registerInterval</span><span class="token punctuation">(</span>window<span class="token punctuation">.</span><span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;setInterval&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插件停用后</span>
	<span class="token function">onunload</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>

	<span class="token punctuation">}</span>

	<span class="token comment">// 插件设置加载后</span>
	<span class="token keyword">async</span> <span class="token function">loadSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>settings <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token constant">DEFAULT_SETTINGS</span><span class="token punctuation">,</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">loadData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token comment">// 插件设置保存后</span>
	<span class="token keyword">async</span> <span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">saveData</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>settings<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 2. Modal接口的实现
 * 打开的提示窗口的实体
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SampleModal</span> <span class="token keyword">extends</span> <span class="token class-name">Modal</span> <span class="token punctuation">{</span>
	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onOpen</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">setText</span><span class="token punctuation">(</span><span class="token string">&#39;Woah!&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">onClose</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>contentEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
		contentEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">/* 3. PluginSettingTab接口的实现
 * 这个是设置菜单里的设置
 */</span>
<span class="token keyword">class</span> <span class="token class-name">SampleSettingTab</span> <span class="token keyword">extends</span> <span class="token class-name">PluginSettingTab</span> <span class="token punctuation">{</span>
	plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">;</span>

	<span class="token function">constructor</span><span class="token punctuation">(</span>app<span class="token operator">:</span> App<span class="token punctuation">,</span> plugin<span class="token operator">:</span> MyPlugin<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token keyword">super</span><span class="token punctuation">(</span>app<span class="token punctuation">,</span> plugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">this</span><span class="token punctuation">.</span>plugin <span class="token operator">=</span> plugin<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token function">display</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{</span>
		<span class="token keyword">const</span> <span class="token punctuation">{</span>containerEl<span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>

		containerEl<span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token comment">// 一个h2标题</span>
		containerEl<span class="token punctuation">.</span><span class="token function">createEl</span><span class="token punctuation">(</span><span class="token string">&#39;h2&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>text<span class="token operator">:</span> <span class="token string">&#39;Settings for my awesome plugin.&#39;</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

		<span class="token comment">// 创建一个新的设置项</span>
		<span class="token keyword">new</span> <span class="token class-name">Setting</span><span class="token punctuation">(</span>containerEl<span class="token punctuation">)</span>
			<span class="token punctuation">.</span><span class="token function">setName</span><span class="token punctuation">(</span><span class="token string">&#39;Setting #1&#39;</span><span class="token punctuation">)</span>											<span class="token comment">// 设置项名字</span>
			<span class="token punctuation">.</span><span class="token function">setDesc</span><span class="token punctuation">(</span><span class="token string">&#39;It\\&#39;s a secret&#39;</span><span class="token punctuation">)</span>									<span class="token comment">// 设置项提示</span>
			<span class="token punctuation">.</span><span class="token function">addText</span><span class="token punctuation">(</span>text <span class="token operator">=&gt;</span> text												<span class="token comment">// 输入框</span>
				<span class="token punctuation">.</span><span class="token function">setPlaceholder</span><span class="token punctuation">(</span><span class="token string">&#39;Enter your secret&#39;</span><span class="token punctuation">)</span>			<span class="token comment">// 没有内容时的提示</span>
				<span class="token punctuation">.</span><span class="token function">setValue</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting<span class="token punctuation">)</span>
				<span class="token punctuation">.</span><span class="token function">onChange</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span>value<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
					<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&#39;Secret: &#39;</span> <span class="token operator">+</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
					<span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span>settings<span class="token punctuation">.</span>mySetting <span class="token operator">=</span> value<span class="token punctuation">;</span>
					<span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>plugin<span class="token punctuation">.</span><span class="token function">saveSettings</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
				<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="后处理器" tabindex="-1"><a class="header-anchor" href="#后处理器"><span>后处理器</span></a></h3><p>https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/editor/markdown-post-processing.html</p><p>使用：例如：（预览模式下生效）</p><div class="language-text line-numbers-mode" data-ext="text" data-title="text"><pre class="language-text"><code>\`:+1:\`
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="其他" tabindex="-1"><a class="header-anchor" href="#其他"><span>其他</span></a></h2><p>直接让Obsidian界面半崩溃</p><div class="language-typescript line-numbers-mode" data-ext="ts" data-title="ts"><pre class="language-typescript"><code><span class="token comment">// app = new App()</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h2 id="vault" tabindex="-1"><a class="header-anchor" href="#vault"><span>Vault</span></a></h2><p>js文件都是在一个虚拟路径上运行的：</p><p>C:\\Users\\A\\AppData\\Local\\Obsidian\\resources\\electron.asar</p><p>英文状态下，打开其他库叫 “Open another vault” 打开其他库的菜单中，显示的是：Create new vault、OPen folder as vault、Open vault form Obsidian Sync</p><p>控制台可以直接打印：（比较方便）</p><div class="language-bash line-numbers-mode" data-ext="sh" data-title="sh"><pre class="language-bash"><code>__filename
this
this.app 或 app
this.app.vault 	<span class="token comment"># .adapter.basePath就是库的路径了（包括库名）</span>
				<span class="token comment"># .configDir</span>
				<span class="token comment"># .getName()，当前库的名字</span>
				<span class="token comment"># _.sourcePath</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="view-editor" tabindex="-1"><a class="header-anchor" href="#view-editor"><span>view / editor</span></a></h2><p>好多叫view/editor的，他们的类型都不同</p><p><strong>我个人认为将诸如MarkdownView、EditorView、View的变量都叫成view，是非常不妥的</strong></p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// 受参类</span>
<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">addCommand</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">name</span><span class="token operator">:</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">editorCallback</span><span class="token operator">:</span> <span class="token punctuation">(</span>
        <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor<span class="token punctuation">,</span> 							<span class="token comment">// Editor</span>
        <span class="token literal-property property">view</span><span class="token operator">:</span> MarkdownView							<span class="token comment">// MarkdownView</span>
  <span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// @ts-expect-error, not typed</span>
    <span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView<span class="token punctuation">;</span><span class="token comment">// EditorView from &quot;@codemirror/view&quot;</span>
    <span class="token keyword">const</span> plugin <span class="token operator">=</span> editorView<span class="token punctuation">.</span><span class="token function">plugin</span><span class="token punctuation">(</span>examplePlugin<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
<span class="token comment">// 受参类</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AnyBlockPluginValue</span> <span class="token keyword">implements</span> <span class="token class-name">PluginValue</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">decorations</span><span class="token operator">:</span> DecorationSet<span class="token punctuation">;</span>
  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">view</span><span class="token operator">:</span> EditorView</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> view <span class="token punctuation">}</span>			<span class="token comment">// EditorView from &quot;@codemirror/view&quot;</span>
  <span class="token function">update</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">update</span><span class="token operator">:</span> ViewUpdate</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> update<span class="token punctuation">.</span>view <span class="token punctuation">}</span> 		<span class="token comment">// 这个view和上面那个是一样的</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> <span class="token literal-property property">view</span><span class="token operator">:</span> View<span class="token operator">|</span><span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//  // 未聚焦(active)会返回null</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span> 							<span class="token comment">// 不在编辑模式好像**不**会返回null</span>
<span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
<span class="token comment">// @ts-ignore 这里会说Editor没有containerEl属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorElement</span><span class="token operator">:</span> Element <span class="token operator">=</span> editVar<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>containerEl
<span class="token keyword">const</span> <span class="token literal-property property">editorState</span><span class="token operator">:</span> EditorState <span class="token operator">=</span> editorView<span class="token punctuation">.</span>state
<span class="token comment">// const state: any = view.getState() 这个不是</span>
<span class="token keyword">const</span> <span class="token literal-property property">cursor</span><span class="token operator">:</span> EditorPosition <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


<span class="token keyword">const</span> view <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>	
<span class="token keyword">this</span>
plugin_this
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token keyword">const</span> editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token keyword">const</span> cursor <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>									<span class="token comment">// </span>
<span class="token keyword">const</span> state <span class="token operator">=</span> view<span class="token punctuation">.</span><span class="token function">getState</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">const</span> editorView <span class="token operator">=</span> view<span class="token punctuation">.</span>editor<span class="token punctuation">.</span>cm <span class="token keyword">as</span> EditorView

<span class="token comment">// 转化类</span>
EditorView<span class="token punctuation">.</span><span class="token function">state</span><span class="token punctuation">(</span><span class="token punctuation">)</span>									<span class="token comment">// EditorState from &quot;@codemirror/state&quot;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>补充：ts报错说找不到属性的问题</p><blockquote><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>this.app.workspace.getActiveViewOfType(MarkdownView);</code>中，this和plugin_this都可以 他们的.app出来的内容是一样，区别在于类型声明不同。 所以看起来用plugin_this会报错而this不会，但其实本质是一样的，报错的话加个@ts-ignore就行了。</p><p>View类型看原型没有，但打印出来它确实是有editor参数的 Ediot类型看原型没有，但打印出来它确实是有cm参数的</p></blockquote><p>类型验证</p><div class="language-javascript line-numbers-mode" data-ext="js" data-title="js"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token literal-property property">view</span><span class="token operator">:</span> View<span class="token operator">|</span><span class="token keyword">null</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>app<span class="token punctuation">.</span>workspace<span class="token punctuation">.</span><span class="token function">getActiveViewOfType</span><span class="token punctuation">(</span>MarkdownView<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>view<span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span>
<span class="token comment">// @ts-ignore 这里会说View没有editor属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editor</span><span class="token operator">:</span> Editor <span class="token operator">=</span> view<span class="token punctuation">.</span>editor
<span class="token comment">// @ts-ignore 这里会说Editor没有cm属性</span>
<span class="token keyword">const</span> <span class="token literal-property property">editorView</span><span class="token operator">:</span> EditorView <span class="token operator">=</span> editor<span class="token punctuation">.</span>cm
<span class="token keyword">const</span> <span class="token literal-property property">editorState</span><span class="token operator">:</span> EditorState <span class="token operator">=</span> editorView<span class="token punctuation">.</span>state
<span class="token comment">// const state: any = view.getState() // 这个不是</span>
<span class="token keyword">const</span> <span class="token literal-property property">cursor</span><span class="token operator">:</span> EditorPosition <span class="token operator">=</span> editor<span class="token punctuation">.</span><span class="token function">getCursor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// console.log(&quot;【Msg】 this&quot;, this.constructor.name, this instanceof Window, typeof(this), this)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 cursor&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">.</span>discriminator <span class="token operator">===</span> <span class="token string">&quot;EditorPosition&quot;</span><span class="token punctuation">,</span> cursor<span class="token punctuation">)</span> 			<span class="token comment">// False Object</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 view&quot;</span><span class="token punctuation">,</span> view <span class="token keyword">instanceof</span> <span class="token class-name">View</span><span class="token punctuation">,</span> view<span class="token punctuation">)</span>								<span class="token comment">// from &#39;obsidian&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editor&quot;</span><span class="token punctuation">,</span> editor <span class="token keyword">instanceof</span> <span class="token class-name">Editor</span><span class="token punctuation">,</span> editor<span class="token punctuation">)</span>						<span class="token comment">// from &#39;obsidian&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editorState&quot;</span><span class="token punctuation">,</span> editorState <span class="token keyword">instanceof</span> <span class="token class-name">EditorState</span><span class="token punctuation">,</span> editorState<span class="token punctuation">)</span>	<span class="token comment">// from &#39;@codemirror/state&#39;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 editorView&quot;</span><span class="token punctuation">,</span> editorView <span class="token keyword">instanceof</span> <span class="token class-name">EditorView</span><span class="token punctuation">,</span> editorView<span class="token punctuation">)</span>		<span class="token comment">// from &quot;@codemirror/view&quot;</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 state&quot;</span><span class="token punctuation">,</span> state <span class="token keyword">instanceof</span> <span class="token class-name">EditorState</span><span class="token punctuation">,</span> state<span class="token punctuation">)</span> 						<span class="token comment">// False Object any</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 this&quot;</span><span class="token punctuation">,</span> <span class="token keyword">this</span> <span class="token keyword">instanceof</span> <span class="token class-name">Window</span><span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;【Msg】 plugin_this&quot;</span><span class="token punctuation">,</span> plugin_this <span class="token keyword">instanceof</span> <span class="token class-name">AnyBlockPlugin</span><span class="token punctuation">,</span> plugin_this<span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,53))])}const Hn=c(k,[["render",Zn],["__file","index.html.vue"]]),Yn=JSON.parse('{"path":"/MdNote_Public/01.%20DesignAndDevelop/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/Obsidian/%E3%80%8AObsidian%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3%E3%80%8B/","title":"README","lang":"zh-CN","frontmatter":{"create_time":"2022‎-11‎-‎11‎","description":"README 主参考： API文档 （刚开始找来找去找不到，官网好像没文档。后来在论坛找到了，但应该不是官方弄的） 开发者文档：https://marcus.se.net/obsidian-plugin-docs/ 中文社区网友的翻译：https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2....","head":[["meta",{"property":"og:url","content":"http://192.168.0.101:8080/MdNote_Public/01.%20DesignAndDevelop/Develop/04.%20Project/Type/Doc/MarkdwonAbout/01.%20Soft%20And%20Frame/Obsidian/%E3%80%8AObsidian%20%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%96%87%E6%A1%A3%E3%80%8B/"}],["meta",{"property":"og:site_name","content":"Linc 的小站"}],["meta",{"property":"og:title","content":"README"}],["meta",{"property":"og:description","content":"README 主参考： API文档 （刚开始找来找去找不到，官网好像没文档。后来在论坛找到了，但应该不是官方弄的） 开发者文档：https://marcus.se.net/obsidian-plugin-docs/ 中文社区网友的翻译：https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2...."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"LincZero"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"README\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincZero\\",\\"url\\":\\"https://github.com/LincZero/\\"}]}"]]},"headers":[{"level":1,"title":"README","slug":"readme","link":"#readme","children":[{"level":2,"title":"开发文档","slug":"开发文档","link":"#开发文档","children":[{"level":3,"title":"重载插件","slug":"重载插件","link":"#重载插件","children":[]},{"level":3,"title":"插件剖析","slug":"插件剖析","link":"#插件剖析","children":[]},{"level":3,"title":"插件生命周期、控制台打印","slug":"插件生命周期、控制台打印","link":"#插件生命周期、控制台打印","children":[]},{"level":3,"title":"React","slug":"react","link":"#react","children":[{"level":4,"title":"配置您的插件","slug":"配置您的插件","link":"#配置您的插件","children":[]},{"level":4,"title":"创建React组件","slug":"创建react组件","link":"#创建react组件","children":[]}]},{"level":3,"title":"Svelte","slug":"svelte","link":"#svelte","children":[{"level":4,"title":"配置您的插件","slug":"配置您的插件-1","link":"#配置您的插件-1","children":[]},{"level":4,"title":"创建并加载一个 Svelte 组件","slug":"创建并加载一个-svelte-组件","link":"#创建并加载一个-svelte-组件","children":[]}]},{"level":3,"title":"Vue","slug":"vue","link":"#vue","children":[{"level":4,"title":"第一步：下载插件开发模板","slug":"第一步-下载插件开发模板","link":"#第一步-下载插件开发模板","children":[]},{"level":4,"title":"第二步：安装依赖","slug":"第二步-安装依赖","link":"#第二步-安装依赖","children":[]},{"level":4,"title":"第三步：修改插件的 manifest 配置","slug":"第三步-修改插件的-manifest-配置","link":"#第三步-修改插件的-manifest-配置","children":[]},{"level":4,"title":"第四步：查看 src 文件夹","slug":"第四步-查看-src-文件夹","link":"#第四步-查看-src-文件夹","children":[]},{"level":4,"title":"第五步：编写 Vue 组件","slug":"第五步-编写-vue-组件","link":"#第五步-编写-vue-组件","children":[]},{"level":4,"title":"第六步：挂载 Vue 组件","slug":"第六步-挂载-vue-组件","link":"#第六步-挂载-vue-组件","children":[]},{"level":4,"title":"第七步：编译","slug":"第七步-编译","link":"#第七步-编译","children":[]}]}]},{"level":2,"title":"编辑器接口","slug":"编辑器接口","link":"#编辑器接口","children":[{"level":3,"title":"【总结】","slug":"【总结】","link":"#【总结】","children":[]},{"level":3,"title":"编辑器 Editor","slug":"编辑器-editor","link":"#编辑器-editor","children":[{"level":4,"title":"编辑器","slug":"编辑器","link":"#编辑器","children":[]},{"level":4,"title":"在光标处插入文本","slug":"在光标处插入文本","link":"#在光标处插入文本","children":[]},{"level":4,"title":"替换当前选中的内容","slug":"替换当前选中的内容","link":"#替换当前选中的内容","children":[]}]},{"level":3,"title":"Markdown后处理 registerMarkdownPostProcessor()","slug":"markdown后处理-registermarkdownpostprocessor","link":"#markdown后处理-registermarkdownpostprocessor","children":[{"level":4,"title":"Markdown后处理","slug":"markdown后处理","link":"#markdown后处理","children":[]},{"level":4,"title":"后处理 Markdown 代码块","slug":"后处理-markdown-代码块","link":"#后处理-markdown-代码块","children":[]}]}]},{"level":2,"title":"CodeMirror相关","slug":"codemirror相关","link":"#codemirror相关","children":[{"level":3,"title":"编辑器扩展 registerEditorExtension()","slug":"编辑器扩展-registereditorextension","link":"#编辑器扩展-registereditorextension","children":[{"level":4,"title":"我是否需要一个编辑器扩展？","slug":"我是否需要一个编辑器扩展","link":"#我是否需要一个编辑器扩展","children":[]},{"level":4,"title":"注册编辑器扩展","slug":"注册编辑器扩展","link":"#注册编辑器扩展","children":[]}]},{"level":3,"title":"与编辑器扩展通信 EditorView","slug":"与编辑器扩展通信-editorview","link":"#与编辑器扩展通信-editorview","children":[{"level":4,"title":"视图插件1","slug":"视图插件1","link":"#视图插件1","children":[]},{"level":4,"title":"状态字段","slug":"状态字段","link":"#状态字段","children":[]}]},{"level":3,"title":"状态管理","slug":"状态管理","link":"#状态管理","children":[{"level":4,"title":"状态管理 view.dispatch","slug":"状态管理-view-dispatch","link":"#状态管理-view-dispatch","children":[]},{"level":4,"title":"状态变化","slug":"状态变化","link":"#状态变化","children":[]},{"level":4,"title":"举例 Transactions","slug":"举例-transactions","link":"#举例-transactions","children":[]}]},{"level":3,"title":"状态字段 StateField - OB","slug":"状态字段-statefield-ob","link":"#状态字段-statefield-ob","children":[{"level":4,"title":"状态字段","slug":"状态字段-1","link":"#状态字段-1","children":[]},{"level":4,"title":"插件","slug":"插件","link":"#插件","children":[]},{"level":4,"title":"定义状态效果 StateEffect","slug":"定义状态效果-stateeffect","link":"#定义状态效果-stateeffect","children":[]},{"level":4,"title":"定义状态字段 StateField","slug":"定义状态字段-statefield","link":"#定义状态字段-statefield","children":[]},{"level":4,"title":"派发 view.dispatch","slug":"派发-view-dispatch","link":"#派发-view-dispatch","children":[]}]},{"level":3,"title":"视图插件 PluginValue - OB","slug":"视图插件-pluginvalue-ob","link":"#视图插件-pluginvalue-ob","children":[{"level":4,"title":"视窗 View","slug":"视窗-view","link":"#视窗-view","children":[]},{"level":4,"title":"视图插件2","slug":"视图插件2","link":"#视图插件2","children":[]},{"level":4,"title":"创建一个视图插件","slug":"创建一个视图插件","link":"#创建一个视图插件","children":[]}]},{"level":3,"title":"装饰 Decoration - OB","slug":"装饰-decoration-ob","link":"#装饰-decoration-ob","children":[{"level":4,"title":"何时使用视图插件或者状态字段","slug":"何时使用视图插件或者状态字段","link":"#何时使用视图插件或者状态字段","children":[]},{"level":4,"title":"提供装饰","slug":"提供装饰","link":"#提供装饰","children":[]},{"level":4,"title":"小部件 WidgetType","slug":"小部件-widgettype","link":"#小部件-widgettype","children":[]},{"level":4,"title":"状态字段","slug":"状态字段-2","link":"#状态字段-2","children":[]},{"level":4,"title":"视图插件","slug":"视图插件","link":"#视图插件","children":[]}]}]},{"level":2,"title":"用户界面接口","slug":"用户界面接口","link":"#用户界面接口","children":[{"level":3,"title":"指令","slug":"指令","link":"#指令","children":[]},{"level":3,"title":"快捷菜单","slug":"快捷菜单","link":"#快捷菜单","children":[{"level":4,"title":"右键菜单","slug":"右键菜单","link":"#右键菜单","children":[]},{"level":4,"title":"功能区菜单（context menu，其实应该叫ribbon menu才对）","slug":"功能区菜单-context-menu-其实应该叫ribbon-menu才对","link":"#功能区菜单-context-menu-其实应该叫ribbon-menu才对","children":[]},{"level":4,"title":"文件菜单（file-menu）","slug":"文件菜单-file-menu","link":"#文件菜单-file-menu","children":[]},{"level":4,"title":"编辑菜单（editor-menu）","slug":"编辑菜单-editor-menu","link":"#编辑菜单-editor-menu","children":[]}]},{"level":3,"title":"HTML元素","slug":"html元素","link":"#html元素","children":[{"level":4,"title":"使用创建 HTML 元素 createEl()","slug":"使用创建-html-元素-createel","link":"#使用创建-html-元素-createel","children":[]},{"level":4,"title":"元素样式","slug":"元素样式","link":"#元素样式","children":[]},{"level":4,"title":"条件格式","slug":"条件格式","link":"#条件格式","children":[]}]},{"level":3,"title":"图标","slug":"图标","link":"#图标","children":[{"level":4,"title":"浏览可用的 icon","slug":"浏览可用的-icon","link":"#浏览可用的-icon","children":[]},{"level":4,"title":"绘制 icons","slug":"绘制-icons","link":"#绘制-icons","children":[]},{"level":4,"title":"添加您自己的 ico","slug":"添加您自己的-ico","link":"#添加您自己的-ico","children":[]}]},{"level":3,"title":"用户界面","slug":"用户界面","link":"#用户界面","children":[]},{"level":3,"title":"对话框","slug":"对话框","link":"#对话框","children":[{"level":4,"title":"创建对话框","slug":"创建对话框","link":"#创建对话框","children":[]},{"level":4,"title":"打开对话框","slug":"打开对话框","link":"#打开对话框","children":[]},{"level":4,"title":"接受用户输入","slug":"接受用户输入","link":"#接受用户输入","children":[]},{"level":4,"title":"从建议列表中选择","slug":"从建议列表中选择","link":"#从建议列表中选择","children":[]}]},{"level":3,"title":"功能区操作","slug":"功能区操作","link":"#功能区操作","children":[]},{"level":3,"title":"设置","slug":"设置","link":"#设置","children":[]},{"level":3,"title":"状态栏","slug":"状态栏","link":"#状态栏","children":[]},{"level":3,"title":"视图 View","slug":"视图-view","link":"#视图-view","children":[{"level":4,"title":"基本用法","slug":"基本用法","link":"#基本用法","children":[]},{"level":4,"title":"其他补充","slug":"其他补充","link":"#其他补充","children":[]}]},{"level":3,"title":"工作区","slug":"工作区","link":"#工作区","children":[{"level":4,"title":"工作区","slug":"工作区-1","link":"#工作区-1","children":[]},{"level":4,"title":"Splits","slug":"splits","link":"#splits","children":[]},{"level":4,"title":"检查工作区","slug":"检查工作区","link":"#检查工作区","children":[]},{"level":4,"title":"Leaf lifecycle","slug":"leaf-lifecycle","link":"#leaf-lifecycle","children":[]},{"level":4,"title":"Leaf 组","slug":"leaf-组","link":"#leaf-组","children":[]}]}]},{"level":2,"title":"开发支持其他格式文件的插件","slug":"开发支持其他格式文件的插件","link":"#开发支持其他格式文件的插件","children":[]},{"level":2,"title":"官方示例","slug":"官方示例","link":"#官方示例","children":[{"level":3,"title":"Obsidian-sample-plugin","slug":"obsidian-sample-plugin","link":"#obsidian-sample-plugin","children":[{"level":4,"title":"使用","slug":"使用","link":"#使用","children":[]},{"level":4,"title":"代码","slug":"代码","link":"#代码","children":[]}]},{"level":3,"title":"API接口","slug":"api接口","link":"#api接口","children":[]},{"level":3,"title":"插入链接示例（开发文档示例）","slug":"插入链接示例-开发文档示例","link":"#插入链接示例-开发文档示例","children":[]},{"level":3,"title":"试作插件 - 切换复选框状态","slug":"试作插件-切换复选框状态","link":"#试作插件-切换复选框状态","children":[]},{"level":3,"title":"后处理器","slug":"后处理器","link":"#后处理器","children":[]}]},{"level":2,"title":"其他","slug":"其他","link":"#其他","children":[]},{"level":2,"title":"Vault","slug":"vault","link":"#vault","children":[]},{"level":2,"title":"view / editor","slug":"view-editor","link":"#view-editor","children":[]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":44.39,"words":13317},"filePathRelative":"MdNote_Public/01. DesignAndDevelop/Develop/04. Project/Type/Doc/MarkdwonAbout/01. Soft And Frame/Obsidian/《Obsidian 插件开发文档》/README.md","excerpt":"\\n<p>主参考：</p>\\n<ul>\\n<li>API文档\\n（刚开始找来找去找不到，官网好像没文档。后来在论坛找到了，但应该不是官方弄的）\\n<ul>\\n<li>开发者文档：https://marcus.se.net/obsidian-plugin-docs/</li>\\n<li><mark>中文社区网友的翻译</mark>：https://luhaifeng666.github.io/obsidian-plugin-docs-zh/zh2.0/（文档）\\nhttps://forum-zh.obsidian.md/t/topic/9352/2（论坛）\\n翻译自 <a href=\\"https://marcus.se.net/obsidian-plugin-docs/user-interface/context-menus\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">这篇文章</a> / https://marcus.se.net/obsidian-plugin-docs/vault\\n（只翻译了一部分，看原文很有必要。像Vault这种东西翻译版就没有）</li>\\n</ul>\\n</li>\\n</ul>","autoDesc":true}');export{Hn as comp,Yn as data};
