import{_ as n}from"./plugin-vue_export-helper-DlAUqK2U.js";import{o as s,c as a,e as t}from"./app-yixEWCFr.js";const e={},p=t(`<h1 id="函数式编程" tabindex="-1"><a class="header-anchor" href="#函数式编程"><span>函数式编程</span></a></h1><p>原理：与其他语言相似，每个函数调用时会在栈中创建栈帧，并有自己的资源，结束时销毁</p><p><strong>与其他语言不同</strong>：</p><ul><li>不支持函数重载</li><li>基本类似和数组都是值传递，其他的数组多是引用传递</li></ul><h2 id="声明定义、使用" tabindex="-1"><a class="header-anchor" href="#声明定义、使用"><span>声明定义、使用</span></a></h2><h3 id="声明定义、使用-1" tabindex="-1"><a class="header-anchor" href="#声明定义、使用-1"><span>声明定义、使用</span></a></h3><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token comment">// 两数相加</span>
<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// 如果返回值类型就一个，那么()可以省略不写。如果无返回值，那么返回值类型可以不写</span>
    <span class="token keyword">var</span> sum <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>
    sum <span class="token operator">+=</span> num1
    sum <span class="token operator">+=</span> num2
    <span class="token keyword">return</span> sum
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sum1 <span class="token operator">:=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    sum2 <span class="token operator">:=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">)</span>
    sum3 <span class="token operator">:=</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="函数变量" tabindex="-1"><a class="header-anchor" href="#函数变量"><span>函数变量</span></a></h3><p>函数也是一种数据类型，类似于 js 的 <code>let a = function</code>、C 的普通函数地址指针。 注意：C++的类成员指针和Lambda函数，则是使用auto、泛型、std::function 等工具来定义函数指针</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> test <span class="token punctuation">(</span>num <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> test									<span class="token comment">// 等价于 a func(int) := test</span>
    fmt<span class="token punctuation">.</span><span class="token function">Print</span><span class="token punctuation">(</span><span class="token string">&quot;a类型 %T, test类型 %T&quot;</span><span class="token punctuation">,</span> a<span class="token punctuation">,</span> test<span class="token punctuation">)</span>	  <span class="token comment">// func(int)    func(int)</span>
    <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>										<span class="token comment">// 等价于 test(10)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="函数作为形参" tabindex="-1"><a class="header-anchor" href="#函数作为形参"><span>函数作为形参</span></a></h3><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> test <span class="token punctuation">(</span>num <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> test2 <span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> testFunc <span class="token keyword">func</span><span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;--- test02&quot;</span><span class="token punctuation">)</span>
    <span class="token function">testFunc</span><span class="token punctuation">(</span>num1<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    a <span class="token operator">:=</span> test
    <span class="token function">a</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>				<span class="token comment">// 输出：12</span>
    <span class="token function">test2</span><span class="token punctuation">(</span><span class="token number">23</span><span class="token punctuation">,</span> test<span class="token punctuation">)</span>		<span class="token comment">// 也可写：test2(23, a)，等价的</span>
    					<span class="token comment">// 输出：--- test02\\n 23</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="详见语言区别-定义顺序、与向前声明问题" tabindex="-1"><a class="header-anchor" href="#详见语言区别-定义顺序、与向前声明问题"><span>(详见语言区别) 定义顺序、与向前声明问题</span></a></h3><p><strong>与其他语言不同</strong>：</p><ul><li>Go <ul><li>不可分离声明和定义</li><li>不考虑顺序，编译时会先解析所有包和函数，原理类似于全部默认向前声明</li></ul></li></ul><h2 id="返回值" tabindex="-1"><a class="header-anchor" href="#返回值"><span>返回值</span></a></h2><h3 id="多返回值" tabindex="-1"><a class="header-anchor" href="#多返回值"><span>多返回值</span></a></h3><p>扩展</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token comment">// 若需返回多个</span>
<span class="token keyword">func</span> <span class="token function">fn</span><span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1<span class="token punctuation">,</span> num2
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="忽略某个返回值" tabindex="-1"><a class="header-anchor" href="#忽略某个返回值"><span>忽略某个返回值</span></a></h3><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token comment">// 可忽略某个返回值</span>
sum1<span class="token punctuation">,</span> <span class="token boolean">_</span> <span class="token operator">:=</span> <span class="token function">fn</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="返回值名" tabindex="-1"><a class="header-anchor" href="#返回值名"><span>返回值名</span></a></h3><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">add_and_sub</span><span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span><span class="token punctuation">(</span>sum <span class="token builtin">int</span><span class="token punctuation">,</span> sub <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sub <span class="token operator">:=</span> num1 <span class="token operator">-</span> num2	<span class="token comment">// 注意：Go的1.20版本后，这里将 \`:=\` 要修改成 \`=\`，应该是默认已定义过sum和sub了</span>
    sum <span class="token operator">:=</span> sum1 <span class="token operator">+</span> sum2
    <span class="token keyword">return</span>				<span class="token comment">// 自动按顺序对应好并返回，和 \`return sum, sub\` 没有区别</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="参数" tabindex="-1"><a class="header-anchor" href="#参数"><span>参数</span></a></h2><h3 id="可变数量参数" tabindex="-1"><a class="header-anchor" href="#可变数量参数"><span>可变数量参数</span></a></h3><p>一般说可变参数特指可变数量</p><p>和python或typeScript的写法比较像</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> test <span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>			<span class="token comment">// 这里的args本质是切片</span>
    <span class="token keyword">for</span> i<span class="token operator">:=</span><span class="token number">0</span><span class="token punctuation">;</span> i<span class="token operator">&lt;</span><span class="token function">len</span><span class="token punctuation">(</span>args<span class="token punctuation">)</span><span class="token punctuation">;</span> i<span class="token operator">++</span> <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">,</span> <span class="token number">9</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="提供可变实参" tabindex="-1"><a class="header-anchor" href="#提供可变实参"><span>提供可变实参</span></a></h3><p>除了传递不同数量的参数外，还可以传递一个切片的展开</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code>slice3 <span class="token operator">:=</span> <span class="token function">append</span><span class="token punctuation">(</span>slice<span class="token punctuation">,</span> slice2<span class="token operator">...</span><span class="token punctuation">)</span>	<span class="token comment">// ^ 这里三个点类似TypeScript的用法，必须写</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h3 id="可变类型参数-重载或泛型" tabindex="-1"><a class="header-anchor" href="#可变类型参数-重载或泛型"><span>可变类型参数 (重载或泛型)</span></a></h3><p>Go不支持函数重载，但支持泛型</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> <span class="token function">myFunction</span><span class="token punctuation">(</span>args <span class="token operator">...</span><span class="token keyword">interface</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">for</span> <span class="token boolean">_</span><span class="token punctuation">,</span> arg <span class="token operator">:=</span> <span class="token keyword">range</span> args <span class="token punctuation">{</span>
        fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>arg<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 调用函数，传入不同数量和类型的参数</span>
    <span class="token function">myFunction</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&quot;a&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;b&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;c&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="地址传参" tabindex="-1"><a class="header-anchor" href="#地址传参"><span>地址传参</span></a></h3><p>地址传参，不是类似 Java 那种引用传参</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> test <span class="token punctuation">(</span>num <span class="token operator">*</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
	<span class="token operator">*</span>num <span class="token operator">=</span> <span class="token number">30</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> num <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">10</span>
	<span class="token function">test</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>num<span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>num<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="特殊函数" tabindex="-1"><a class="header-anchor" href="#特殊函数"><span>特殊函数</span></a></h2><h3 id="main函数" tabindex="-1"><a class="header-anchor" href="#main函数"><span>main函数</span></a></h3><p>略，main包里的main函数，作为可执行程序的入口函数</p><h3 id="init函数" tabindex="-1"><a class="header-anchor" href="#init函数"><span>init函数</span></a></h3><p>每个源文件都可以包含一个init函数，该函数会在main函数执行前被Go框架调用</p><p><strong>与其他函数不同</strong>：其他语言没有这种函数，若其他函数想达到类似的效果：</p><ul><li>这点<strong>类似全局变量定义</strong>，<code>g_object = fun1()</code> (Go语言也行，但init函数比全局变量更慢) 特别地，C++的全局静态对象在main函数前调用构造函数的原理，和这个是一样的</li><li>或类似于js的各种 加载钩子执行函数</li></ul><p><strong>执行顺序：全局变量 -&gt; init函数 -&gt; main函数</strong></p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>
<span class="token keyword">import</span> <span class="token string">&quot;testUtils&quot;</span>	<span class="token comment">// 一般init函数和包的导入搭配使用	</span>

<span class="token keyword">var</span> num init <span class="token operator">=</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">func</span> <span class="token function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;test函数&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token number">10</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;init函数&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main函数&quot;</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 最终打印顺序：</span>
<span class="token comment">// test.test函数</span>
<span class="token comment">// test.init函数</span>
<span class="token comment">//      test函数</span>
<span class="token comment">//      init函数</span>
<span class="token comment">//      main函数</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="高级函数" tabindex="-1"><a class="header-anchor" href="#高级函数"><span>高级函数</span></a></h2><h3 id="匿名函数" tabindex="-1"><a class="header-anchor" href="#匿名函数"><span>匿名函数</span></a></h3><p>类似于 js 的匿名函数，我很喜欢用这种用法，能做到类似空<code>{}</code>以及goto的效果而又不用goto</p><p>使用场景1：如果某个函数只希望使用一次时使用。定义时直接调用</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    result <span class="token operator">:=</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
    <span class="token punctuation">}</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span>
    
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>使用场景2：使用函数变量存储</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code>sub <span class="token operator">:=</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>

<span class="token comment">// 似乎等价于下面的语句，但：可以在局部定义，可以传递 (?不太确定原来的地方方法是不是类似C语言那样，函数名本身也是指针)，特殊的生命周期 (除非赋值给全局变量)</span>
<span class="token comment">// 如果赋值给全局变量，那么应该是没什么区别的 (?也不太确定不用匿名函数能不能局部定义)</span>
<span class="token keyword">func</span> <span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> num1 <span class="token operator">+</span> num2
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="闭包-closure" tabindex="-1"><a class="header-anchor" href="#闭包-closure"><span>闭包 (Closure)</span></a></h3><p><mark><strong>更多概念推荐去看笔记 “语言区别” 里的 “函数式变成/闭包”，那里的很详细</strong></mark></p><ul><li>FAQ <ul><li>什么是闭包：必报就是一个函数和其相关的引用环境组成的一个整体</li><li>闭包的本质：本质依然是一个匿名函数，只是这个函数引入外界的变量/参数。匿名函数+引用的变量/参数 = 闭包</li><li>具名函数可以闭包吗：</li></ul></li><li>特点 <ul><li>返回的是一个匿名函数，但该匿名函数…………………………</li><li>闭包中使用的变量/参数会<strong>一直保存在内存中</strong>，并一直使用。这意味着闭包不可滥用，容易内存泄露</li></ul></li></ul><p>例如：</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">func</span> getSum fun <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token keyword">var</span> sum <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">0</span>			<span class="token comment">// 这里的sum变量会一直保存在内存中</span>
    <span class="token keyword">return</span> <span class="token keyword">func</span> <span class="token punctuation">(</span>num <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
        sum <span class="token operator">=</span> sum <span class="token operator">+</span> num		<span class="token comment">// 会发现，这里的sum后面</span>
        <span class="token keyword">return</span> sum
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    f <span class="token operator">:=</span> <span class="token function">getSum</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span>		<span class="token comment">// 1 = 0 + 1</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span>		<span class="token comment">// 3 = 1 + 2</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>		<span class="token comment">// 6 = 3 + 3</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token function">f</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span>		<span class="token comment">// 10= 6 + 4</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="资源释放-——-defer关键字" tabindex="-1"><a class="header-anchor" href="#资源释放-——-defer关键字"><span>资源释放 —— defer关键字</span></a></h3><p><strong>与其他语言不同</strong>：Go使用defer关键字用于处理函数的资源释放，以及异常处理等（关于defer的更多信息，详见Go语言的 “异常” 部分。结合 “异常” 部分看这个语法还好一些，否则从其他语言转过来是真的不适应）</p><p>直接作用：遇到defer会将后面的代码压入栈中，也会将相关值拷贝入栈</p><div class="language-go line-numbers-mode" data-ext="go" data-title="go"><pre class="language-go"><code><span class="token keyword">package</span> main
<span class="token keyword">import</span> <span class="token string">&quot;fmt&quot;</span>

<span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;main get &quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">func</span> <span class="token function">add</span><span class="token punctuation">(</span>num1 <span class="token builtin">int</span><span class="token punctuation">,</span> num2 <span class="token builtin">int</span><span class="token punctuation">)</span> <span class="token builtin">int</span> <span class="token punctuation">{</span>
    <span class="token comment">// Go中，程序遇到defer关键字，不会立即执行defer后的语句，而是将defer后的语句压入栈，先执行函数后的值然后出栈。需要注意栈的先进后出</span>
    <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;num1 = &quot;</span><span class="token punctuation">,</span> num1<span class="token punctuation">)</span>
    <span class="token keyword">defer</span> fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;num2 = &quot;</span><span class="token punctuation">,</span> num2<span class="token punctuation">)</span>
    num1 <span class="token operator">+=</span> <span class="token number">10</span>
    num2 <span class="token operator">+=</span> <span class="token number">10</span>
    
    <span class="token keyword">var</span> sum <span class="token builtin">int</span> <span class="token operator">=</span> num1 <span class="token operator">+</span> num2
    fmt<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">&quot;sum = &quot;</span><span class="token punctuation">,</span> sum<span class="token punctuation">)</span>
    <span class="token keyword">return</span> sum
<span class="token punctuation">}</span>

<span class="token comment">// 打印顺序：</span>
sum <span class="token operator">=</span> <span class="token number">110</span>
num2 <span class="token operator">=</span> <span class="token number">30</span>	<span class="token comment">// 先进先出，先出num2</span>
num1 <span class="token operator">=</span> <span class="token number">30</span>	<span class="token comment">// 并且defer会将变量会值传递到新栈帧中，所以值不受后续改变的影响</span>
main get <span class="token number">110</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>应用场景：</p><ul><li>在函数执行完毕后，及时释放函数中创建的资源。</li><li>QA：有GC语言为什么还要手动释放？例如打开文件函数并想函数结束时释放掉</li><li>QA：在函数末尾释放资源不行吗？<strong>不用这个的话，提前返回或抛出异常就很麻烦</strong>。要重复写一堆资源释放语句，并且每个return处所需要释放的资源还可能不同</li></ul>`,64),i=[p];function o(c,l){return s(),a("div",null,i)}const d=n(e,[["render",o],["__file","01_函数式编程.html.vue"]]),k=JSON.parse('{"path":"/MdNote_Public/01.%20%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7/Develop/01.%20Language/Go/05_%E5%B0%81%E8%A3%85/01_%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html","title":"函数式编程","lang":"zh-CN","frontmatter":{"description":"函数式编程 原理：与其他语言相似，每个函数调用时会在栈中创建栈帧，并有自己的资源，结束时销毁 与其他语言不同： 不支持函数重载 基本类似和数组都是值传递，其他的数组多是引用传递 声明定义、使用 声明定义、使用 函数变量 函数也是一种数据类型，类似于 js 的 let a = function、C 的普通函数地址指针。 注意：C++的类成员指针和Lamb...","head":[["meta",{"property":"og:url","content":"http://192.168.0.101:8080/MdNote_Public/01.%20%E8%AE%BE%E8%AE%A1%E5%BC%80%E5%8F%91%E4%B8%8E%E6%95%B0%E6%8D%AE%E7%94%9F%E4%BA%A7/Develop/01.%20Language/Go/05_%E5%B0%81%E8%A3%85/01_%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B.html"}],["meta",{"property":"og:site_name","content":"Linc 的小站"}],["meta",{"property":"og:title","content":"函数式编程"}],["meta",{"property":"og:description","content":"函数式编程 原理：与其他语言相似，每个函数调用时会在栈中创建栈帧，并有自己的资源，结束时销毁 与其他语言不同： 不支持函数重载 基本类似和数组都是值传递，其他的数组多是引用传递 声明定义、使用 声明定义、使用 函数变量 函数也是一种数据类型，类似于 js 的 let a = function、C 的普通函数地址指针。 注意：C++的类成员指针和Lamb..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"LincZero"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"函数式编程\\",\\"image\\":[\\"\\"],\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"LincZero\\",\\"url\\":\\"https://github.com/LincZero/\\"}]}"]]},"headers":[{"level":1,"title":"函数式编程","slug":"函数式编程","link":"#函数式编程","children":[{"level":2,"title":"声明定义、使用","slug":"声明定义、使用","link":"#声明定义、使用","children":[{"level":3,"title":"声明定义、使用","slug":"声明定义、使用-1","link":"#声明定义、使用-1","children":[]},{"level":3,"title":"函数变量","slug":"函数变量","link":"#函数变量","children":[]},{"level":3,"title":"函数作为形参","slug":"函数作为形参","link":"#函数作为形参","children":[]},{"level":3,"title":"(详见语言区别) 定义顺序、与向前声明问题","slug":"详见语言区别-定义顺序、与向前声明问题","link":"#详见语言区别-定义顺序、与向前声明问题","children":[]}]},{"level":2,"title":"返回值","slug":"返回值","link":"#返回值","children":[{"level":3,"title":"多返回值","slug":"多返回值","link":"#多返回值","children":[]},{"level":3,"title":"忽略某个返回值","slug":"忽略某个返回值","link":"#忽略某个返回值","children":[]},{"level":3,"title":"返回值名","slug":"返回值名","link":"#返回值名","children":[]}]},{"level":2,"title":"参数","slug":"参数","link":"#参数","children":[{"level":3,"title":"可变数量参数","slug":"可变数量参数","link":"#可变数量参数","children":[]},{"level":3,"title":"提供可变实参","slug":"提供可变实参","link":"#提供可变实参","children":[]},{"level":3,"title":"可变类型参数 (重载或泛型)","slug":"可变类型参数-重载或泛型","link":"#可变类型参数-重载或泛型","children":[]},{"level":3,"title":"地址传参","slug":"地址传参","link":"#地址传参","children":[]}]},{"level":2,"title":"特殊函数","slug":"特殊函数","link":"#特殊函数","children":[{"level":3,"title":"main函数","slug":"main函数","link":"#main函数","children":[]},{"level":3,"title":"init函数","slug":"init函数","link":"#init函数","children":[]}]},{"level":2,"title":"高级函数","slug":"高级函数","link":"#高级函数","children":[{"level":3,"title":"匿名函数","slug":"匿名函数","link":"#匿名函数","children":[]},{"level":3,"title":"闭包 (Closure)","slug":"闭包-closure","link":"#闭包-closure","children":[]},{"level":3,"title":"资源释放 —— defer关键字","slug":"资源释放-——-defer关键字","link":"#资源释放-——-defer关键字","children":[]}]}]}],"git":{"createdTime":null,"updatedTime":null,"contributors":[]},"readingTime":{"minutes":6.18,"words":1855},"filePathRelative":"MdNote_Public/01. 设计开发与数据生产/Develop/01. Language/Go/05_封装/01_函数式编程.md","autoDesc":true}');export{d as comp,k as data};
